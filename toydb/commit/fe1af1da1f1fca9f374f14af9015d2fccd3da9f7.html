<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Added initial schema support. - toydb - An SQL engine written in Rust
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="../logo.png" alt="" width="32" height="32" /></a></td><td><h1>toydb</h1><span class="desc">An SQL engine written in Rust
</span></td></tr><tr class="url"><td></td><td>git clone <a href="https://github.com/erikgrinaker/toydb">https://github.com/erikgrinaker/toydb</a></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.md.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/fe1af1da1f1fca9f374f14af9015d2fccd3da9f7.html">fe1af1da1f1fca9f374f14af9015d2fccd3da9f7</a>
<b>parent</b> <a href="../commit/b13b42d1535226d4e5d8f8e5e5a52f2fe08b78bd.html">b13b42d1535226d4e5d8f8e5e5a52f2fe08b78bd</a>
<b>Author:</b> Erik Grinaker &lt;<a href="mailto:erik@grinaker.org">erik@grinaker.org</a>&gt;
<b>Date:</b>   Thu, 29 Aug 2019 17:54:13 +0200

Added initial schema support.

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">README.md</a></td><td> | </td><td class="num">6</td><td><span class="i">++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">src/kv/mod.rs</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">src/server/mod.rs</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">src/server/toydb.rs</a></td><td> | </td><td class="num">7</td><td><span class="i">+++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">src/sql/mod.rs</a></td><td> | </td><td class="num">5</td><td><span class="i">++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h5">src/sql/parser/ast.rs</a></td><td> | </td><td class="num">15</td><td><span class="i">+++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">src/sql/parser/lexer.rs</a></td><td> | </td><td class="num">27</td><td><span class="i">+++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">src/sql/parser/mod.rs</a></td><td> | </td><td class="num">117</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">---------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">src/sql/plan/mod.rs</a></td><td> | </td><td class="num">10</td><td><span class="i">+</span><span class="d">---------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h9">src/sql/plan/node.rs</a></td><td> | </td><td class="num">23</td><td><span class="i">+++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h10">src/sql/plan/planner.rs</a></td><td> | </td><td class="num">56</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="A">A</td><td><a href="#h11">src/sql/schema.rs</a></td><td> | </td><td class="num">18</td><td><span class="i">++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h12">src/sql/storage.rs</a></td><td> | </td><td class="num">66</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h13">src/sql/testdata/create_table/ast</a></td><td> | </td><td class="num">46</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h14">src/sql/testdata/create_table/plan</a></td><td> | </td><td class="num">45</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h15">src/sql/testdata/create_table/query.sql</a></td><td> | </td><td class="num">10</td><td><span class="i">++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h16">src/sql/testdata/create_table/tokens</a></td><td> | </td><td class="num">70</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h17">src/sql/testdata/create_table_error_bare/ast</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h18">src/sql/testdata/create_table_error_bare/plan</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h19">src/sql/testdata/create_table_error_bare/query.sql</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h20">src/sql/testdata/create_table_error_bare/tokens</a></td><td> | </td><td class="num">9</td><td><span class="i">+++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h21">src/sql/testdata/create_table_error_empty_columns/ast</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h22">src/sql/testdata/create_table_error_empty_columns/plan</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h23">src/sql/testdata/create_table_error_empty_columns/query.sql</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h24">src/sql/testdata/create_table_error_empty_columns/tokens</a></td><td> | </td><td class="num">14</td><td><span class="i">++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h25">src/sql/testdata/create_table_error_multiple_primary_key/ast</a></td><td> | </td><td class="num">18</td><td><span class="i">++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h26">src/sql/testdata/create_table_error_multiple_primary_key/plan</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h27">src/sql/testdata/create_table_error_multiple_primary_key/query.sql</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h28">src/sql/testdata/create_table_error_multiple_primary_key/tokens</a></td><td> | </td><td class="num">39</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h29">src/sql/testdata/create_table_error_no_columns/ast</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h30">src/sql/testdata/create_table_error_no_columns/plan</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h31">src/sql/testdata/create_table_error_no_columns/query.sql</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h32">src/sql/testdata/create_table_error_no_columns/tokens</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h33">src/sql/testdata/create_table_error_no_datatype/ast</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h34">src/sql/testdata/create_table_error_no_datatype/plan</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h35">src/sql/testdata/create_table_error_no_datatype/query.sql</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h36">src/sql/testdata/create_table_error_no_datatype/tokens</a></td><td> | </td><td class="num">17</td><td><span class="i">+++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h37">src/sql/testdata/create_table_error_no_name/ast</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h38">src/sql/testdata/create_table_error_no_name/plan</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h39">src/sql/testdata/create_table_error_no_name/query.sql</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h40">src/sql/testdata/create_table_error_no_name/tokens</a></td><td> | </td><td class="num">17</td><td><span class="i">+++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h41">src/sql/testdata/create_table_error_no_primary_key/ast</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h42">src/sql/testdata/create_table_error_no_primary_key/plan</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h43">src/sql/testdata/create_table_error_no_primary_key/query.sql</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h44">src/sql/testdata/create_table_error_no_primary_key/tokens</a></td><td> | </td><td class="num">20</td><td><span class="i">++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h45">src/sql/testdata/create_table_single_column/ast</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h46">src/sql/testdata/create_table_single_column/plan</a></td><td> | </td><td class="num">20</td><td><span class="i">++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h47">src/sql/testdata/create_table_single_column/query.sql</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h48">src/sql/testdata/create_table_single_column/tokens</a></td><td> | </td><td class="num">26</td><td><span class="i">++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h49">src/sql/testdata/drop_table/ast</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h50">src/sql/testdata/drop_table/plan</a></td><td> | </td><td class="num">10</td><td><span class="i">++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h51">src/sql/testdata/drop_table/query.sql</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h52">src/sql/testdata/drop_table/tokens</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h53">src/sql/testdata/drop_table_error_bare/ast</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h54">src/sql/testdata/drop_table_error_bare/plan</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h55">src/sql/testdata/drop_table_error_bare/query.sql</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h56">src/sql/testdata/drop_table_error_bare/tokens</a></td><td> | </td><td class="num">9</td><td><span class="i">+++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h57">src/sql/testdata/select_error_bare_as/ast</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h58">src/sql/testdata/select_error_bare_as/plan</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h59">src/sql/tests.rs</a></td><td> | </td><td class="num">26</td><td><span class="i">+++++++++++++++++++++++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h60">src/sql/types.rs</a></td><td> | </td><td class="num">11</td><td><span class="i">+++++++++++</span><span class="d"></span></td></tr>
</table></pre><pre>61 files changed, 831 insertions(+), 38 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/README.md.html">README.md</a> b/<a href="../file/README.md.html">README.md</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -71,6 +71,12 @@ Below is an incomplete list of known issues preventing this from being a &quot;real&quot; 
</a> 
 * **Log replication optimization:** currently only the simplest version of the Raft log replication protocol is implemented, without snapshots or rapid log replay (i.e. replication of old log entries is retried one by one until a common base entry is found).
 
<a href="#h0-0-3" id="h0-0-3" class="i">+### Schema
</a><a href="#h0-0-4" id="h0-0-4" class="i">+
</a><a href="#h0-0-5" id="h0-0-5" class="i">+* **Single database:** only a single, unnamed database is supported per ToyDB cluster.
</a><a href="#h0-0-6" id="h0-0-6" class="i">+
</a><a href="#h0-0-7" id="h0-0-7" class="i">+* **Schema changes:** schema changes other than creating or dropping tables and indexes is not supported, i.e. there is no `ALTER TABLE`.
</a><a href="#h0-0-8" id="h0-0-8" class="i">+
</a> ### Query Engine
 
 * **Type checking:** query type checking (e.g. `SELECT a + b` must receive two numbers) is done at query evaluation time, not at query compile time.
 \ No newline at end of file
<b>diff --git a/<a id="h1" href="../file/src/kv/mod.rs.html">src/kv/mod.rs</a> b/<a href="../file/src/kv/mod.rs.html">src/kv/mod.rs</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -1,10 +1,8 @@
</a> mod file;
<a href="#h1-0-1" id="h1-0-1" class="d">-#[cfg(test)]
</a> mod memory;
 
 use crate::Error;
 pub use file::File;
<a href="#h1-0-6" id="h1-0-6" class="d">-#[cfg(test)]
</a> pub use memory::Memory;
 
 /// A key-value store
<b>diff --git a/<a id="h2" href="../file/src/server/mod.rs.html">src/server/mod.rs</a> b/<a href="../file/src/server/mod.rs.html">src/server/mod.rs</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -6,6 +6,7 @@ use crate::error::Error;
</a> use crate::kv;
 use crate::raft::Raft;
 use crate::service;
<a href="#h2-0-3" id="h2-0-3" class="i">+use crate::sql::Storage;
</a> use crate::state;
 
 use std::collections::HashMap;
<a href="#h2-1" id="h2-1" class="h">@@ -52,6 +53,7 @@ impl Server {
</a>         server.add_service(service::ToyDBServer::new_service_def(ToyDB {
             id: self.id.clone(),
             raft: raft.clone(),
<a href="#h2-1-3" id="h2-1-3" class="i">+            storage: Box::new(Storage::new(kv::Memory::new())),
</a>         }));
         let _s = server.build()?;
 
<b>diff --git a/<a id="h3" href="../file/src/server/toydb.rs.html">src/server/toydb.rs</a> b/<a href="../file/src/server/toydb.rs.html">src/server/toydb.rs</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -1,13 +1,14 @@
</a> use crate::raft::Raft;
 use crate::service;
 use crate::sql::types::{Row, Value};
<a href="#h3-0-3" id="h3-0-3" class="d">-use crate::sql::{Parser, Plan};
</a><a href="#h3-0-4" id="h3-0-4" class="i">+use crate::sql::{Parser, Planner, Storage};
</a> use crate::state;
 use crate::Error;
 
 pub struct ToyDB {
     pub id: String,
     pub raft: Raft,
<a href="#h3-0-11" id="h3-0-11" class="i">+    pub storage: Box&lt;Storage&gt;,
</a> }
 
 impl service::ToyDB for ToyDB {
<a href="#h3-1" id="h3-1" class="h">@@ -16,7 +17,9 @@ impl service::ToyDB for ToyDB {
</a>         _: grpc::RequestOptions,
         req: service::QueryRequest,
     ) -&gt; grpc::StreamingResponse&lt;service::Row&gt; {
<a href="#h3-1-3" id="h3-1-3" class="d">-        let plan = Plan::build(Parser::new(&amp;req.query).parse().unwrap()).unwrap();
</a><a href="#h3-1-4" id="h3-1-4" class="i">+        let plan = Planner::new(self.storage.clone())
</a><a href="#h3-1-5" id="h3-1-5" class="i">+            .build(Parser::new(&amp;req.query).parse().unwrap())
</a><a href="#h3-1-6" id="h3-1-6" class="i">+            .unwrap();
</a>         let mut metadata = grpc::Metadata::new();
         metadata.add(
             grpc::MetadataKey::from(&quot;columns&quot;),
<b>diff --git a/<a id="h4" href="../file/src/sql/mod.rs.html">src/sql/mod.rs</a> b/<a href="../file/src/sql/mod.rs.html">src/sql/mod.rs</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -1,8 +1,11 @@
</a> mod parser;
 mod plan;
<a href="#h4-0-2" id="h4-0-2" class="i">+mod schema;
</a><a href="#h4-0-3" id="h4-0-3" class="i">+mod storage;
</a> #[cfg(test)]
 mod tests;
 pub mod types;
 
 pub use parser::{ast, lexer, Parser};
<a href="#h4-0-9" id="h4-0-9" class="d">-pub use plan::Plan;
</a><a href="#h4-0-10" id="h4-0-10" class="i">+pub use plan::{Plan, Planner};
</a><a href="#h4-0-11" id="h4-0-11" class="i">+pub use storage::Storage;
</a><b>diff --git a/<a id="h5" href="../file/src/sql/parser/ast.rs.html">src/sql/parser/ast.rs</a> b/<a href="../file/src/sql/parser/ast.rs.html">src/sql/parser/ast.rs</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -1,6 +1,12 @@
</a><a href="#h5-0-0" id="h5-0-0" class="i">+use super::super::types;
</a><a href="#h5-0-1" id="h5-0-1" class="i">+
</a> /// Statements
 #[derive(Clone, Debug, PartialEq)]
 pub enum Statement {
<a href="#h5-0-5" id="h5-0-5" class="i">+    /// A CREATE TABLE statement
</a><a href="#h5-0-6" id="h5-0-6" class="i">+    CreateTable { name: String, columns: Vec&lt;ColumnSpec&gt; },
</a><a href="#h5-0-7" id="h5-0-7" class="i">+    /// A DROP TABLE statement
</a><a href="#h5-0-8" id="h5-0-8" class="i">+    DropTable(String),
</a>     /// A SELECT statement
     Select {
         /// The select clause
<a href="#h5-1" id="h5-1" class="h">@@ -8,6 +14,15 @@ pub enum Statement {
</a>     },
 }
 
<a href="#h5-1-3" id="h5-1-3" class="i">+/// A column specification
</a><a href="#h5-1-4" id="h5-1-4" class="i">+#[derive(Clone, Debug, PartialEq)]
</a><a href="#h5-1-5" id="h5-1-5" class="i">+pub struct ColumnSpec {
</a><a href="#h5-1-6" id="h5-1-6" class="i">+    pub name: String,
</a><a href="#h5-1-7" id="h5-1-7" class="i">+    pub datatype: types::DataType,
</a><a href="#h5-1-8" id="h5-1-8" class="i">+    pub primary_key: bool,
</a><a href="#h5-1-9" id="h5-1-9" class="i">+    pub nullable: Option&lt;bool&gt;,
</a><a href="#h5-1-10" id="h5-1-10" class="i">+}
</a><a href="#h5-1-11" id="h5-1-11" class="i">+
</a> /// A SELECT clause
 #[derive(Clone, Debug, PartialEq)]
 pub struct SelectClause {
<b>diff --git a/<a id="h6" href="../file/src/sql/parser/lexer.rs.html">src/sql/parser/lexer.rs</a> b/<a href="../file/src/sql/parser/lexer.rs.html">src/sql/parser/lexer.rs</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -71,12 +71,21 @@ impl From&lt;Keyword&gt; for Token {
</a> pub enum Keyword {
     And,
     As,
<a href="#h6-0-3" id="h6-0-3" class="i">+    Boolean,
</a><a href="#h6-0-4" id="h6-0-4" class="i">+    Create,
</a><a href="#h6-0-5" id="h6-0-5" class="i">+    Drop,
</a>     False,
<a href="#h6-0-7" id="h6-0-7" class="i">+    Float,
</a><a href="#h6-0-8" id="h6-0-8" class="i">+    Integer,
</a><a href="#h6-0-9" id="h6-0-9" class="i">+    Key,
</a>     Not,
     Null,
     Or,
<a href="#h6-0-13" id="h6-0-13" class="i">+    Primary,
</a>     Select,
<a href="#h6-0-15" id="h6-0-15" class="i">+    Table,
</a>     True,
<a href="#h6-0-17" id="h6-0-17" class="i">+    Varchar,
</a> }
 
 impl Keyword {
<a href="#h6-1" id="h6-1" class="h">@@ -84,12 +93,21 @@ impl Keyword {
</a>         Some(match ident.to_uppercase().as_ref() {
             &quot;AS&quot; =&gt; Self::As,
             &quot;AND&quot; =&gt; Self::And,
<a href="#h6-1-3" id="h6-1-3" class="i">+            &quot;BOOLEAN&quot; =&gt; Self::Boolean,
</a><a href="#h6-1-4" id="h6-1-4" class="i">+            &quot;CREATE&quot; =&gt; Self::Create,
</a><a href="#h6-1-5" id="h6-1-5" class="i">+            &quot;DROP&quot; =&gt; Self::Drop,
</a>             &quot;FALSE&quot; =&gt; Self::False,
<a href="#h6-1-7" id="h6-1-7" class="i">+            &quot;FLOAT&quot; =&gt; Self::Float,
</a><a href="#h6-1-8" id="h6-1-8" class="i">+            &quot;INTEGER&quot; =&gt; Self::Integer,
</a><a href="#h6-1-9" id="h6-1-9" class="i">+            &quot;KEY&quot; =&gt; Self::Key,
</a>             &quot;NOT&quot; =&gt; Self::Not,
             &quot;NULL&quot; =&gt; Self::Null,
             &quot;OR&quot; =&gt; Self::Or,
<a href="#h6-1-13" id="h6-1-13" class="i">+            &quot;PRIMARY&quot; =&gt; Self::Primary,
</a>             &quot;SELECT&quot; =&gt; Self::Select,
<a href="#h6-1-15" id="h6-1-15" class="i">+            &quot;TABLE&quot; =&gt; Self::Table,
</a>             &quot;TRUE&quot; =&gt; Self::True,
<a href="#h6-1-17" id="h6-1-17" class="i">+            &quot;VARCHAR&quot; =&gt; Self::Varchar,
</a>             _ =&gt; return None,
         })
     }
<a href="#h6-2" id="h6-2" class="h">@@ -98,12 +116,21 @@ impl Keyword {
</a>         match self {
             Self::As =&gt; &quot;AS&quot;,
             Self::And =&gt; &quot;AND&quot;,
<a href="#h6-2-3" id="h6-2-3" class="i">+            Self::Boolean =&gt; &quot;BOOLEAN&quot;,
</a><a href="#h6-2-4" id="h6-2-4" class="i">+            Self::Create =&gt; &quot;CREATE&quot;,
</a><a href="#h6-2-5" id="h6-2-5" class="i">+            Self::Drop =&gt; &quot;DROP&quot;,
</a>             Self::False =&gt; &quot;FALSE&quot;,
<a href="#h6-2-7" id="h6-2-7" class="i">+            Self::Float =&gt; &quot;FLOAT&quot;,
</a><a href="#h6-2-8" id="h6-2-8" class="i">+            Self::Integer =&gt; &quot;INTEGER&quot;,
</a><a href="#h6-2-9" id="h6-2-9" class="i">+            Self::Key =&gt; &quot;KEY&quot;,
</a>             Self::Not =&gt; &quot;NOT&quot;,
             Self::Null =&gt; &quot;NULL&quot;,
             Self::Or =&gt; &quot;OR&quot;,
<a href="#h6-2-13" id="h6-2-13" class="i">+            Self::Primary =&gt; &quot;PRIMARY&quot;,
</a>             Self::Select =&gt; &quot;SELECT&quot;,
<a href="#h6-2-15" id="h6-2-15" class="i">+            Self::Table =&gt; &quot;TABLE&quot;,
</a>             Self::True =&gt; &quot;TRUE&quot;,
<a href="#h6-2-17" id="h6-2-17" class="i">+            Self::Varchar =&gt; &quot;VARCHAR&quot;,
</a>         }
     }
 }
<b>diff --git a/<a id="h7" href="../file/src/sql/parser/mod.rs.html">src/sql/parser/mod.rs</a> b/<a href="../file/src/sql/parser/mod.rs.html">src/sql/parser/mod.rs</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -1,6 +1,7 @@
</a> pub mod ast;
 pub mod lexer;
 
<a href="#h7-0-3" id="h7-0-3" class="i">+use super::types::DataType;
</a> use crate::Error;
 use lexer::{Keyword, Lexer, Token};
 
<a href="#h7-1" id="h7-1" class="h">@@ -44,6 +45,14 @@ impl&lt;&#39;a&gt; Parser&lt;&#39;a&gt; {
</a>         }
     }
 
<a href="#h7-1-3" id="h7-1-3" class="i">+    /// Grabs the next identifier, or errors if not found
</a><a href="#h7-1-4" id="h7-1-4" class="i">+    fn next_ident(&amp;mut self) -&gt; Result&lt;String, Error&gt; {
</a><a href="#h7-1-5" id="h7-1-5" class="i">+        match self.next()? {
</a><a href="#h7-1-6" id="h7-1-6" class="i">+            Token::Ident(ident) =&gt; Ok(ident),
</a><a href="#h7-1-7" id="h7-1-7" class="i">+            token =&gt; Err(Error::Parse(format!(&quot;Expected identifier, got {}&quot;, token))),
</a><a href="#h7-1-8" id="h7-1-8" class="i">+        }
</a><a href="#h7-1-9" id="h7-1-9" class="i">+    }
</a><a href="#h7-1-10" id="h7-1-10" class="i">+
</a>     /// Grabs the next lexer token if it satisfies the predicate function
     fn next_if&lt;F: Fn(&amp;Token) -&gt; bool&gt;(&amp;mut self, predicate: F) -&gt; Option&lt;Token&gt; {
         self.peek().unwrap_or(None).filter(|t| predicate(&amp;t))?;
<a href="#h7-2" id="h7-2" class="h">@@ -61,6 +70,14 @@ impl&lt;&#39;a&gt; Parser&lt;&#39;a&gt; {
</a>         Some(operator)
     }
 
<a href="#h7-2-3" id="h7-2-3" class="i">+    /// Grabs the next lexer token if it is a keyword
</a><a href="#h7-2-4" id="h7-2-4" class="i">+    fn next_if_keyword(&amp;mut self) -&gt; Option&lt;Token&gt; {
</a><a href="#h7-2-5" id="h7-2-5" class="i">+        self.next_if(|t| match t {
</a><a href="#h7-2-6" id="h7-2-6" class="i">+            Token::Keyword(_) =&gt; true,
</a><a href="#h7-2-7" id="h7-2-7" class="i">+            _ =&gt; false,
</a><a href="#h7-2-8" id="h7-2-8" class="i">+        })
</a><a href="#h7-2-9" id="h7-2-9" class="i">+    }
</a><a href="#h7-2-10" id="h7-2-10" class="i">+
</a>     /// Grabs the next lexer token if it is a given token
     fn next_if_token(&amp;mut self, token: Token) -&gt; Option&lt;Token&gt; {
         self.next_if(|t| t == &amp;token)
<a href="#h7-3" id="h7-3" class="h">@@ -76,12 +93,97 @@ impl&lt;&#39;a&gt; Parser&lt;&#39;a&gt; {
</a>     /// Parses an SQL statement
     fn parse_statement(&amp;mut self) -&gt; Result&lt;ast::Statement, Error&gt; {
         match self.peek()? {
<a href="#h7-3-3" id="h7-3-3" class="i">+            Some(Token::Keyword(Keyword::Create)) =&gt; self.parse_ddl(),
</a><a href="#h7-3-4" id="h7-3-4" class="i">+            Some(Token::Keyword(Keyword::Drop)) =&gt; self.parse_ddl(),
</a>             Some(Token::Keyword(Keyword::Select)) =&gt; self.parse_statement_select(),
             Some(token) =&gt; Err(Error::Parse(format!(&quot;Unexpected token {}&quot;, token))),
             None =&gt; Err(Error::Parse(&quot;Unexpected end of input&quot;.into())),
         }
     }
 
<a href="#h7-3-11" id="h7-3-11" class="i">+    /// Parses a DDL statement
</a><a href="#h7-3-12" id="h7-3-12" class="i">+    fn parse_ddl(&amp;mut self) -&gt; Result&lt;ast::Statement, Error&gt; {
</a><a href="#h7-3-13" id="h7-3-13" class="i">+        match self.next()? {
</a><a href="#h7-3-14" id="h7-3-14" class="i">+            Token::Keyword(Keyword::Create) =&gt; match self.next()? {
</a><a href="#h7-3-15" id="h7-3-15" class="i">+                Token::Keyword(Keyword::Table) =&gt; self.parse_ddl_create_table(),
</a><a href="#h7-3-16" id="h7-3-16" class="i">+                token =&gt; Err(Error::Parse(format!(&quot;Unexpected token {}&quot;, token))),
</a><a href="#h7-3-17" id="h7-3-17" class="i">+            },
</a><a href="#h7-3-18" id="h7-3-18" class="i">+            Token::Keyword(Keyword::Drop) =&gt; match self.next()? {
</a><a href="#h7-3-19" id="h7-3-19" class="i">+                Token::Keyword(Keyword::Table) =&gt; self.parse_ddl_drop_table(),
</a><a href="#h7-3-20" id="h7-3-20" class="i">+                token =&gt; Err(Error::Parse(format!(&quot;Unexpected token {}&quot;, token))),
</a><a href="#h7-3-21" id="h7-3-21" class="i">+            },
</a><a href="#h7-3-22" id="h7-3-22" class="i">+            token =&gt; Err(Error::Parse(format!(&quot;Unexpected token {}&quot;, token))),
</a><a href="#h7-3-23" id="h7-3-23" class="i">+        }
</a><a href="#h7-3-24" id="h7-3-24" class="i">+    }
</a><a href="#h7-3-25" id="h7-3-25" class="i">+
</a><a href="#h7-3-26" id="h7-3-26" class="i">+    /// Parses a CREATE TABLE DDL statement. The CREATE TABLE prefix has
</a><a href="#h7-3-27" id="h7-3-27" class="i">+    /// already been consumed.
</a><a href="#h7-3-28" id="h7-3-28" class="i">+    fn parse_ddl_create_table(&amp;mut self) -&gt; Result&lt;ast::Statement, Error&gt; {
</a><a href="#h7-3-29" id="h7-3-29" class="i">+        let name = self.next_ident()?;
</a><a href="#h7-3-30" id="h7-3-30" class="i">+        self.next_expect(Some(Token::OpenParen))?;
</a><a href="#h7-3-31" id="h7-3-31" class="i">+
</a><a href="#h7-3-32" id="h7-3-32" class="i">+        let mut columns = Vec::new();
</a><a href="#h7-3-33" id="h7-3-33" class="i">+        loop {
</a><a href="#h7-3-34" id="h7-3-34" class="i">+            columns.push(self.parse_ddl_columnspec()?);
</a><a href="#h7-3-35" id="h7-3-35" class="i">+            if self.next_if_token(Token::Comma).is_none() {
</a><a href="#h7-3-36" id="h7-3-36" class="i">+                break;
</a><a href="#h7-3-37" id="h7-3-37" class="i">+            }
</a><a href="#h7-3-38" id="h7-3-38" class="i">+        }
</a><a href="#h7-3-39" id="h7-3-39" class="i">+        self.next_expect(Some(Token::CloseParen))?;
</a><a href="#h7-3-40" id="h7-3-40" class="i">+        Ok(ast::Statement::CreateTable { name, columns })
</a><a href="#h7-3-41" id="h7-3-41" class="i">+    }
</a><a href="#h7-3-42" id="h7-3-42" class="i">+
</a><a href="#h7-3-43" id="h7-3-43" class="i">+    /// Parses a DROP TABLE DDL statement. The DROP TABLE prefix has
</a><a href="#h7-3-44" id="h7-3-44" class="i">+    /// already been consumed.
</a><a href="#h7-3-45" id="h7-3-45" class="i">+    fn parse_ddl_drop_table(&amp;mut self) -&gt; Result&lt;ast::Statement, Error&gt; {
</a><a href="#h7-3-46" id="h7-3-46" class="i">+        Ok(ast::Statement::DropTable(self.next_ident()?))
</a><a href="#h7-3-47" id="h7-3-47" class="i">+    }
</a><a href="#h7-3-48" id="h7-3-48" class="i">+
</a><a href="#h7-3-49" id="h7-3-49" class="i">+    /// Parses a column specification
</a><a href="#h7-3-50" id="h7-3-50" class="i">+    fn parse_ddl_columnspec(&amp;mut self) -&gt; Result&lt;ast::ColumnSpec, Error&gt; {
</a><a href="#h7-3-51" id="h7-3-51" class="i">+        let mut column = ast::ColumnSpec {
</a><a href="#h7-3-52" id="h7-3-52" class="i">+            name: self.next_ident()?,
</a><a href="#h7-3-53" id="h7-3-53" class="i">+            datatype: match self.next()? {
</a><a href="#h7-3-54" id="h7-3-54" class="i">+                Token::Keyword(Keyword::Boolean) =&gt; DataType::Boolean,
</a><a href="#h7-3-55" id="h7-3-55" class="i">+                Token::Keyword(Keyword::Integer) =&gt; DataType::Integer,
</a><a href="#h7-3-56" id="h7-3-56" class="i">+                Token::Keyword(Keyword::Float) =&gt; DataType::Float,
</a><a href="#h7-3-57" id="h7-3-57" class="i">+                Token::Keyword(Keyword::Varchar) =&gt; DataType::String,
</a><a href="#h7-3-58" id="h7-3-58" class="i">+                token =&gt; return Err(Error::Parse(format!(&quot;Unexpected token {}&quot;, token))),
</a><a href="#h7-3-59" id="h7-3-59" class="i">+            },
</a><a href="#h7-3-60" id="h7-3-60" class="i">+            primary_key: false,
</a><a href="#h7-3-61" id="h7-3-61" class="i">+            nullable: None,
</a><a href="#h7-3-62" id="h7-3-62" class="i">+        };
</a><a href="#h7-3-63" id="h7-3-63" class="i">+        while let Some(Token::Keyword(keyword)) = self.next_if_keyword() {
</a><a href="#h7-3-64" id="h7-3-64" class="i">+            match keyword {
</a><a href="#h7-3-65" id="h7-3-65" class="i">+                Keyword::Primary =&gt; {
</a><a href="#h7-3-66" id="h7-3-66" class="i">+                    self.next_expect(Some(Keyword::Key.into()))?;
</a><a href="#h7-3-67" id="h7-3-67" class="i">+                    column.primary_key = true;
</a><a href="#h7-3-68" id="h7-3-68" class="i">+                }
</a><a href="#h7-3-69" id="h7-3-69" class="i">+                Keyword::Null =&gt; {
</a><a href="#h7-3-70" id="h7-3-70" class="i">+                    if let Some(false) = column.nullable {
</a><a href="#h7-3-71" id="h7-3-71" class="i">+                        return Err(Error::Value(format!(
</a><a href="#h7-3-72" id="h7-3-72" class="i">+                            &quot;Column {} can&#39;t be both not nullable and nullable&quot;,
</a><a href="#h7-3-73" id="h7-3-73" class="i">+                            column.name
</a><a href="#h7-3-74" id="h7-3-74" class="i">+                        )));
</a><a href="#h7-3-75" id="h7-3-75" class="i">+                    }
</a><a href="#h7-3-76" id="h7-3-76" class="i">+                    column.nullable = Some(true)
</a><a href="#h7-3-77" id="h7-3-77" class="i">+                }
</a><a href="#h7-3-78" id="h7-3-78" class="i">+                Keyword::Not =&gt; {
</a><a href="#h7-3-79" id="h7-3-79" class="i">+                    self.next_expect(Some(Keyword::Null.into()))?;
</a><a href="#h7-3-80" id="h7-3-80" class="i">+                    if let Some(true) = column.nullable {
</a><a href="#h7-3-81" id="h7-3-81" class="i">+                        return Err(Error::Value(format!(
</a><a href="#h7-3-82" id="h7-3-82" class="i">+                            &quot;Column {} can&#39;t be both not nullable and nullable&quot;,
</a><a href="#h7-3-83" id="h7-3-83" class="i">+                            column.name
</a><a href="#h7-3-84" id="h7-3-84" class="i">+                        )));
</a><a href="#h7-3-85" id="h7-3-85" class="i">+                    }
</a><a href="#h7-3-86" id="h7-3-86" class="i">+                    column.nullable = Some(false)
</a><a href="#h7-3-87" id="h7-3-87" class="i">+                }
</a><a href="#h7-3-88" id="h7-3-88" class="i">+                keyword =&gt; return Err(Error::Parse(format!(&quot;Unexpected keyword {}&quot;, keyword))),
</a><a href="#h7-3-89" id="h7-3-89" class="i">+            }
</a><a href="#h7-3-90" id="h7-3-90" class="i">+        }
</a><a href="#h7-3-91" id="h7-3-91" class="i">+        Ok(column)
</a><a href="#h7-3-92" id="h7-3-92" class="i">+    }
</a><a href="#h7-3-93" id="h7-3-93" class="i">+
</a>     /// Parses a select statement
     fn parse_statement_select(&amp;mut self) -&gt; Result&lt;ast::Statement, Error&gt; {
         Ok(ast::Statement::Select { select: self.parse_clause_select()?.unwrap() })
<a href="#h7-4" id="h7-4" class="h">@@ -98,20 +200,9 @@ impl&lt;&#39;a&gt; Parser&lt;&#39;a&gt; {
</a>             clause.labels.push(match self.peek()? {
                 Some(Token::Keyword(Keyword::As)) =&gt; {
                     self.next()?;
<a href="#h7-4-3" id="h7-4-3" class="d">-                    match self.next()? {
</a><a href="#h7-4-4" id="h7-4-4" class="d">-                        Token::Ident(ident) =&gt; Some(ident),
</a><a href="#h7-4-5" id="h7-4-5" class="d">-                        token =&gt; {
</a><a href="#h7-4-6" id="h7-4-6" class="d">-                            return Err(Error::Parse(format!(
</a><a href="#h7-4-7" id="h7-4-7" class="d">-                                &quot;Expected identifier, found {}&quot;,
</a><a href="#h7-4-8" id="h7-4-8" class="d">-                                token
</a><a href="#h7-4-9" id="h7-4-9" class="d">-                            )))
</a><a href="#h7-4-10" id="h7-4-10" class="d">-                        }
</a><a href="#h7-4-11" id="h7-4-11" class="d">-                    }
</a><a href="#h7-4-12" id="h7-4-12" class="d">-                }
</a><a href="#h7-4-13" id="h7-4-13" class="d">-                Some(Token::Ident(ident)) =&gt; {
</a><a href="#h7-4-14" id="h7-4-14" class="d">-                    self.next()?;
</a><a href="#h7-4-15" id="h7-4-15" class="d">-                    Some(ident)
</a><a href="#h7-4-16" id="h7-4-16" class="i">+                    Some(self.next_ident()?)
</a>                 }
<a href="#h7-4-18" id="h7-4-18" class="i">+                Some(Token::Ident(_)) =&gt; Some(self.next_ident()?),
</a>                 _ =&gt; None,
             });
             if self.next_if_token(Token::Comma).is_none() {
<b>diff --git a/<a id="h8" href="../file/src/sql/plan/mod.rs.html">src/sql/plan/mod.rs</a> b/<a href="../file/src/sql/plan/mod.rs.html">src/sql/plan/mod.rs</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -4,10 +4,9 @@ mod planner;
</a> 
 pub use node::Node;
 
<a href="#h8-0-3" id="h8-0-3" class="d">-use super::parser::ast;
</a> use super::types::Row;
 use crate::Error;
<a href="#h8-0-6" id="h8-0-6" class="d">-use planner::Planner;
</a><a href="#h8-0-7" id="h8-0-7" class="i">+pub use planner::Planner;
</a> 
 /// A plan
 #[derive(Debug)]
<a href="#h8-1" id="h8-1" class="h">@@ -26,10 +25,3 @@ impl Iterator for Plan {
</a>         self.root.next()
     }
 }
<a href="#h8-1-3" id="h8-1-3" class="d">-
</a><a href="#h8-1-4" id="h8-1-4" class="d">-impl Plan {
</a><a href="#h8-1-5" id="h8-1-5" class="d">-    /// Builds a plan from a statement AST
</a><a href="#h8-1-6" id="h8-1-6" class="d">-    pub fn build(statement: ast::Statement) -&gt; Result&lt;Self, Error&gt; {
</a><a href="#h8-1-7" id="h8-1-7" class="d">-        Planner::new().build(statement)
</a><a href="#h8-1-8" id="h8-1-8" class="d">-    }
</a><a href="#h8-1-9" id="h8-1-9" class="d">-}
</a><b>diff --git a/<a id="h9" href="../file/src/sql/plan/node.rs.html">src/sql/plan/node.rs</a> b/<a href="../file/src/sql/plan/node.rs.html">src/sql/plan/node.rs</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -1,3 +1,5 @@
</a><a href="#h9-0-0" id="h9-0-0" class="i">+use super::super::schema;
</a><a href="#h9-0-1" id="h9-0-1" class="i">+use super::super::storage::Storage;
</a> use super::super::types::Row;
 use super::expression::Expression;
 use crate::Error;
<a href="#h9-1" id="h9-1" class="h">@@ -5,6 +7,7 @@ use crate::Error;
</a> /// A plan node
 #[derive(Debug)]
 pub enum Node {
<a href="#h9-1-3" id="h9-1-3" class="i">+    DDL { storage: Box&lt;Storage&gt;, ddl: DDL },
</a>     Projection { labels: Vec&lt;String&gt;, source: Box&lt;Node&gt;, expressions: Vec&lt;Expression&gt; },
     Nothing { done: bool },
 }
<a href="#h9-2" id="h9-2" class="h">@@ -14,6 +17,10 @@ impl Iterator for Node {
</a> 
     fn next(&amp;mut self) -&gt; Option&lt;Result&lt;Row, Error&gt;&gt; {
         match self {
<a href="#h9-2-3" id="h9-2-3" class="i">+            Node::DDL { storage, ddl } =&gt; {
</a><a href="#h9-2-4" id="h9-2-4" class="i">+                ddl.execute(*storage.clone()).unwrap();
</a><a href="#h9-2-5" id="h9-2-5" class="i">+                None
</a><a href="#h9-2-6" id="h9-2-6" class="i">+            }
</a>             Node::Projection { source, expressions, .. } =&gt; {
                 if let Err(err) = source.next()? {
                     Some(Err(err))
<a href="#h9-3" id="h9-3" class="h">@@ -32,3 +39,19 @@ impl Iterator for Node {
</a>         }
     }
 }
<a href="#h9-3-3" id="h9-3-3" class="i">+
</a><a href="#h9-3-4" id="h9-3-4" class="i">+/// A DDL operation
</a><a href="#h9-3-5" id="h9-3-5" class="i">+#[derive(Debug)]
</a><a href="#h9-3-6" id="h9-3-6" class="i">+pub enum DDL {
</a><a href="#h9-3-7" id="h9-3-7" class="i">+    CreateTable(schema::Table),
</a><a href="#h9-3-8" id="h9-3-8" class="i">+    DropTable(String),
</a><a href="#h9-3-9" id="h9-3-9" class="i">+}
</a><a href="#h9-3-10" id="h9-3-10" class="i">+
</a><a href="#h9-3-11" id="h9-3-11" class="i">+impl DDL {
</a><a href="#h9-3-12" id="h9-3-12" class="i">+    fn execute(&amp;self, mut storage: Storage) -&gt; Result&lt;(), Error&gt; {
</a><a href="#h9-3-13" id="h9-3-13" class="i">+        match self {
</a><a href="#h9-3-14" id="h9-3-14" class="i">+            Self::CreateTable(schema) =&gt; storage.create_table(schema.clone()),
</a><a href="#h9-3-15" id="h9-3-15" class="i">+            Self::DropTable(name) =&gt; storage.drop_table(name),
</a><a href="#h9-3-16" id="h9-3-16" class="i">+        }
</a><a href="#h9-3-17" id="h9-3-17" class="i">+    }
</a><a href="#h9-3-18" id="h9-3-18" class="i">+}
</a><b>diff --git a/<a id="h10" href="../file/src/sql/plan/planner.rs.html">src/sql/plan/planner.rs</a> b/<a href="../file/src/sql/plan/planner.rs.html">src/sql/plan/planner.rs</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -1,16 +1,20 @@
</a> use super::super::parser::ast;
<a href="#h10-0-1" id="h10-0-1" class="i">+use super::super::schema;
</a><a href="#h10-0-2" id="h10-0-2" class="i">+use super::super::storage::Storage;
</a> use super::super::types::Value;
 use super::expression::Expression;
<a href="#h10-0-5" id="h10-0-5" class="d">-use super::node::Node;
</a><a href="#h10-0-6" id="h10-0-6" class="i">+use super::node::{Node, DDL};
</a> use super::Plan;
 use crate::Error;
 
<a href="#h10-0-10" id="h10-0-10" class="d">-pub struct Planner {}
</a><a href="#h10-0-11" id="h10-0-11" class="i">+pub struct Planner {
</a><a href="#h10-0-12" id="h10-0-12" class="i">+    storage: Box&lt;Storage&gt;,
</a><a href="#h10-0-13" id="h10-0-13" class="i">+}
</a> 
 impl Planner {
     /// Creates a new planner
<a href="#h10-0-17" id="h10-0-17" class="d">-    pub fn new() -&gt; Self {
</a><a href="#h10-0-18" id="h10-0-18" class="d">-        Self {}
</a><a href="#h10-0-19" id="h10-0-19" class="i">+    pub fn new(storage: Box&lt;Storage&gt;) -&gt; Self {
</a><a href="#h10-0-20" id="h10-0-20" class="i">+        Self { storage }
</a>     }
 
     /// Builds a plan tree for an AST statement
<a href="#h10-1" id="h10-1" class="h">@@ -19,6 +23,7 @@ impl Planner {
</a>         Ok(Plan {
             columns: match &amp;root {
                 Node::Projection { labels, .. } =&gt; labels.clone(),
<a href="#h10-1-3" id="h10-1-3" class="i">+                Node::DDL { .. } =&gt; vec![],
</a>                 _ =&gt; panic!(&quot;Not implemented&quot;),
             },
             root,
<a href="#h10-2" id="h10-2" class="h">@@ -28,6 +33,13 @@ impl Planner {
</a>     /// Builds a plan node for a statement
     fn build_statement(&amp;self, statement: ast::Statement) -&gt; Result&lt;Node, Error&gt; {
         Ok(match statement {
<a href="#h10-2-3" id="h10-2-3" class="i">+            ast::Statement::CreateTable { name, columns } =&gt; Node::DDL {
</a><a href="#h10-2-4" id="h10-2-4" class="i">+                storage: self.storage.clone(),
</a><a href="#h10-2-5" id="h10-2-5" class="i">+                ddl: DDL::CreateTable(self.build_schema_table(name, columns)?),
</a><a href="#h10-2-6" id="h10-2-6" class="i">+            },
</a><a href="#h10-2-7" id="h10-2-7" class="i">+            ast::Statement::DropTable(name) =&gt; {
</a><a href="#h10-2-8" id="h10-2-8" class="i">+                Node::DDL { storage: self.storage.clone(), ddl: DDL::DropTable(name) }
</a><a href="#h10-2-9" id="h10-2-9" class="i">+            }
</a>             ast::Statement::Select { select } =&gt; Node::Projection {
                 labels: select
                     .labels
<a href="#h10-3" id="h10-3" class="h">@@ -49,6 +61,42 @@ impl Planner {
</a>     fn build_expressions(&amp;self, exprs: Vec&lt;ast::Expression&gt;) -&gt; Result&lt;Vec&lt;Expression&gt;, Error&gt; {
         exprs.into_iter().map(|e| self.build_expression(e)).collect()
     }
<a href="#h10-3-3" id="h10-3-3" class="i">+
</a><a href="#h10-3-4" id="h10-3-4" class="i">+    /// Builds a table schema from an AST CreateTable node
</a><a href="#h10-3-5" id="h10-3-5" class="i">+    fn build_schema_table(
</a><a href="#h10-3-6" id="h10-3-6" class="i">+        &amp;self,
</a><a href="#h10-3-7" id="h10-3-7" class="i">+        name: String,
</a><a href="#h10-3-8" id="h10-3-8" class="i">+        columnspecs: Vec&lt;ast::ColumnSpec&gt;,
</a><a href="#h10-3-9" id="h10-3-9" class="i">+    ) -&gt; Result&lt;schema::Table, Error&gt; {
</a><a href="#h10-3-10" id="h10-3-10" class="i">+        let primary_keys: Vec&lt;&amp;ast::ColumnSpec&gt; =
</a><a href="#h10-3-11" id="h10-3-11" class="i">+            columnspecs.iter().filter(|c| c.primary_key).collect();
</a><a href="#h10-3-12" id="h10-3-12" class="i">+        if primary_keys.is_empty() {
</a><a href="#h10-3-13" id="h10-3-13" class="i">+            return Err(Error::Value(format!(&quot;No primary key defined for table {}&quot;, name)));
</a><a href="#h10-3-14" id="h10-3-14" class="i">+        } else if primary_keys.len() &gt; 1 {
</a><a href="#h10-3-15" id="h10-3-15" class="i">+            return Err(Error::Value(format!(
</a><a href="#h10-3-16" id="h10-3-16" class="i">+                &quot;{} primary keys defined for table {}, must set exactly 1&quot;,
</a><a href="#h10-3-17" id="h10-3-17" class="i">+                primary_keys.len(),
</a><a href="#h10-3-18" id="h10-3-18" class="i">+                name
</a><a href="#h10-3-19" id="h10-3-19" class="i">+            )));
</a><a href="#h10-3-20" id="h10-3-20" class="i">+        }
</a><a href="#h10-3-21" id="h10-3-21" class="i">+        let primary_key = primary_keys[0];
</a><a href="#h10-3-22" id="h10-3-22" class="i">+        if let Some(true) = primary_key.nullable {
</a><a href="#h10-3-23" id="h10-3-23" class="i">+            return Err(Error::Value(&quot;Primary key cannot be nullable&quot;.into()));
</a><a href="#h10-3-24" id="h10-3-24" class="i">+        }
</a><a href="#h10-3-25" id="h10-3-25" class="i">+
</a><a href="#h10-3-26" id="h10-3-26" class="i">+        Ok(schema::Table {
</a><a href="#h10-3-27" id="h10-3-27" class="i">+            name,
</a><a href="#h10-3-28" id="h10-3-28" class="i">+            primary_key: primary_key.name.clone(),
</a><a href="#h10-3-29" id="h10-3-29" class="i">+            columns: columnspecs
</a><a href="#h10-3-30" id="h10-3-30" class="i">+                .into_iter()
</a><a href="#h10-3-31" id="h10-3-31" class="i">+                .map(|spec| schema::Column {
</a><a href="#h10-3-32" id="h10-3-32" class="i">+                    name: spec.name,
</a><a href="#h10-3-33" id="h10-3-33" class="i">+                    datatype: spec.datatype,
</a><a href="#h10-3-34" id="h10-3-34" class="i">+                    nullable: spec.nullable.unwrap_or(!spec.primary_key),
</a><a href="#h10-3-35" id="h10-3-35" class="i">+                })
</a><a href="#h10-3-36" id="h10-3-36" class="i">+                .collect(),
</a><a href="#h10-3-37" id="h10-3-37" class="i">+        })
</a><a href="#h10-3-38" id="h10-3-38" class="i">+    }
</a> }
 
 /// Helpers to convert AST expressions into plan expressions
<b>diff --git a/<a id="h11" href="../file/src/sql/schema.rs.html">src/sql/schema.rs</a> b/<a href="../file/src/sql/schema.rs.html">src/sql/schema.rs</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -0,0 +1,18 @@
</a><a href="#h11-0-0" id="h11-0-0" class="i">+use super::types::DataType;
</a><a href="#h11-0-1" id="h11-0-1" class="i">+use serde_derive::{Deserialize, Serialize};
</a><a href="#h11-0-2" id="h11-0-2" class="i">+
</a><a href="#h11-0-3" id="h11-0-3" class="i">+/// A table
</a><a href="#h11-0-4" id="h11-0-4" class="i">+#[derive(Clone, Debug, Deserialize, Serialize)]
</a><a href="#h11-0-5" id="h11-0-5" class="i">+pub struct Table {
</a><a href="#h11-0-6" id="h11-0-6" class="i">+    pub name: String,
</a><a href="#h11-0-7" id="h11-0-7" class="i">+    pub columns: Vec&lt;Column&gt;,
</a><a href="#h11-0-8" id="h11-0-8" class="i">+    pub primary_key: String,
</a><a href="#h11-0-9" id="h11-0-9" class="i">+}
</a><a href="#h11-0-10" id="h11-0-10" class="i">+
</a><a href="#h11-0-11" id="h11-0-11" class="i">+/// A table column
</a><a href="#h11-0-12" id="h11-0-12" class="i">+#[derive(Clone, Debug, Deserialize, Serialize)]
</a><a href="#h11-0-13" id="h11-0-13" class="i">+pub struct Column {
</a><a href="#h11-0-14" id="h11-0-14" class="i">+    pub name: String,
</a><a href="#h11-0-15" id="h11-0-15" class="i">+    pub datatype: DataType,
</a><a href="#h11-0-16" id="h11-0-16" class="i">+    pub nullable: bool,
</a><a href="#h11-0-17" id="h11-0-17" class="i">+}
</a><b>diff --git a/<a id="h12" href="../file/src/sql/storage.rs.html">src/sql/storage.rs</a> b/<a href="../file/src/sql/storage.rs.html">src/sql/storage.rs</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -0,0 +1,66 @@
</a><a href="#h12-0-0" id="h12-0-0" class="i">+use super::schema;
</a><a href="#h12-0-1" id="h12-0-1" class="i">+use crate::kv;
</a><a href="#h12-0-2" id="h12-0-2" class="i">+use crate::Error;
</a><a href="#h12-0-3" id="h12-0-3" class="i">+use std::sync::{Arc, RwLock};
</a><a href="#h12-0-4" id="h12-0-4" class="i">+
</a><a href="#h12-0-5" id="h12-0-5" class="i">+#[derive(Clone)]
</a><a href="#h12-0-6" id="h12-0-6" class="i">+pub struct Storage {
</a><a href="#h12-0-7" id="h12-0-7" class="i">+    kv: Arc&lt;RwLock&lt;Box&lt;dyn kv::Store&gt;&gt;&gt;,
</a><a href="#h12-0-8" id="h12-0-8" class="i">+}
</a><a href="#h12-0-9" id="h12-0-9" class="i">+
</a><a href="#h12-0-10" id="h12-0-10" class="i">+impl std::fmt::Debug for Storage {
</a><a href="#h12-0-11" id="h12-0-11" class="i">+    fn fmt(&amp;self, f: &amp;mut std::fmt::Formatter&lt;&#39;_&gt;) -&gt; std::fmt::Result {
</a><a href="#h12-0-12" id="h12-0-12" class="i">+        write!(f, &quot;Storage&quot;)
</a><a href="#h12-0-13" id="h12-0-13" class="i">+    }
</a><a href="#h12-0-14" id="h12-0-14" class="i">+}
</a><a href="#h12-0-15" id="h12-0-15" class="i">+
</a><a href="#h12-0-16" id="h12-0-16" class="i">+impl Storage {
</a><a href="#h12-0-17" id="h12-0-17" class="i">+    /// Creates a new Storage
</a><a href="#h12-0-18" id="h12-0-18" class="i">+    pub fn new&lt;S: kv::Store&gt;(store: S) -&gt; Self {
</a><a href="#h12-0-19" id="h12-0-19" class="i">+        Storage { kv: Arc::new(RwLock::new(Box::new(store))) }
</a><a href="#h12-0-20" id="h12-0-20" class="i">+    }
</a><a href="#h12-0-21" id="h12-0-21" class="i">+
</a><a href="#h12-0-22" id="h12-0-22" class="i">+    /// Creates a table
</a><a href="#h12-0-23" id="h12-0-23" class="i">+    pub fn create_table(&amp;mut self, table: schema::Table) -&gt; Result&lt;(), Error&gt; {
</a><a href="#h12-0-24" id="h12-0-24" class="i">+        if self.table_exists(&amp;table.name)? {
</a><a href="#h12-0-25" id="h12-0-25" class="i">+            Err(Error::Value(format!(&quot;Table {} already exists&quot;, table.name)))
</a><a href="#h12-0-26" id="h12-0-26" class="i">+        } else {
</a><a href="#h12-0-27" id="h12-0-27" class="i">+            self.kv.write()?.set(&amp;Self::key_table(&amp;table.name), Self::serialize(table)?)?;
</a><a href="#h12-0-28" id="h12-0-28" class="i">+            Ok(())
</a><a href="#h12-0-29" id="h12-0-29" class="i">+        }
</a><a href="#h12-0-30" id="h12-0-30" class="i">+    }
</a><a href="#h12-0-31" id="h12-0-31" class="i">+
</a><a href="#h12-0-32" id="h12-0-32" class="i">+    /// Deletes a table
</a><a href="#h12-0-33" id="h12-0-33" class="i">+    pub fn drop_table(&amp;mut self, table: &amp;str) -&gt; Result&lt;(), Error&gt; {
</a><a href="#h12-0-34" id="h12-0-34" class="i">+        self.get_table(table)?;
</a><a href="#h12-0-35" id="h12-0-35" class="i">+        self.kv.write()?.delete(&amp;Self::key_table(table))?;
</a><a href="#h12-0-36" id="h12-0-36" class="i">+        Ok(())
</a><a href="#h12-0-37" id="h12-0-37" class="i">+    }
</a><a href="#h12-0-38" id="h12-0-38" class="i">+
</a><a href="#h12-0-39" id="h12-0-39" class="i">+    /// Fetches a table schema
</a><a href="#h12-0-40" id="h12-0-40" class="i">+    pub fn get_table(&amp;self, table: &amp;str) -&gt; Result&lt;schema::Table, Error&gt; {
</a><a href="#h12-0-41" id="h12-0-41" class="i">+        Self::deserialize(self.kv.read()?.get(&amp;Self::key_table(table))?.ok_or_else(|| Error::Value(format!(&quot;Table {} does not exist&quot;, table)))?)
</a><a href="#h12-0-42" id="h12-0-42" class="i">+    }
</a><a href="#h12-0-43" id="h12-0-43" class="i">+
</a><a href="#h12-0-44" id="h12-0-44" class="i">+    /// Checks if a table exists
</a><a href="#h12-0-45" id="h12-0-45" class="i">+    pub fn table_exists(&amp;self, table: &amp;str) -&gt; Result&lt;bool, Error&gt; {
</a><a href="#h12-0-46" id="h12-0-46" class="i">+        Ok(self.kv.read()?.get(&amp;Self::key_table(table))?.is_some())
</a><a href="#h12-0-47" id="h12-0-47" class="i">+    }
</a><a href="#h12-0-48" id="h12-0-48" class="i">+
</a><a href="#h12-0-49" id="h12-0-49" class="i">+    /// Generates a key for a table
</a><a href="#h12-0-50" id="h12-0-50" class="i">+    fn key_table(table: &amp;str) -&gt; String {
</a><a href="#h12-0-51" id="h12-0-51" class="i">+        format!(&quot;schema.table.{}&quot;, table)
</a><a href="#h12-0-52" id="h12-0-52" class="i">+    }
</a><a href="#h12-0-53" id="h12-0-53" class="i">+
</a><a href="#h12-0-54" id="h12-0-54" class="i">+    /// Deserializes a value from a byte buffer
</a><a href="#h12-0-55" id="h12-0-55" class="i">+    fn deserialize&lt;&#39;de, V: serde::Deserialize&lt;&#39;de&gt;&gt;(bytes: Vec&lt;u8&gt;) -&gt; Result&lt;V, Error&gt; {
</a><a href="#h12-0-56" id="h12-0-56" class="i">+        Ok(serde::Deserialize::deserialize(&amp;mut rmps::Deserializer::new(&amp;bytes[..]))?)
</a><a href="#h12-0-57" id="h12-0-57" class="i">+    }
</a><a href="#h12-0-58" id="h12-0-58" class="i">+
</a><a href="#h12-0-59" id="h12-0-59" class="i">+    /// Serializes a value into a byte buffer
</a><a href="#h12-0-60" id="h12-0-60" class="i">+    fn serialize&lt;V: serde::Serialize&gt;(value: V) -&gt; Result&lt;Vec&lt;u8&gt;, Error&gt; {
</a><a href="#h12-0-61" id="h12-0-61" class="i">+        let mut bytes = Vec::new();
</a><a href="#h12-0-62" id="h12-0-62" class="i">+        value.serialize(&amp;mut rmps::Serializer::new(&amp;mut bytes))?;
</a><a href="#h12-0-63" id="h12-0-63" class="i">+        Ok(bytes)
</a><a href="#h12-0-64" id="h12-0-64" class="i">+    }
</a><a href="#h12-0-65" id="h12-0-65" class="i">+}
</a><b>diff --git a/<a id="h13" href="../file/src/sql/testdata/create_table/ast.html">src/sql/testdata/create_table/ast</a> b/<a href="../file/src/sql/testdata/create_table/ast.html">src/sql/testdata/create_table/ast</a></b>
<a href="#h13-0" id="h13-0" class="h">@@ -0,0 +1,45 @@
</a><a href="#h13-0-0" id="h13-0-0" class="i">+CreateTable {
</a><a href="#h13-0-1" id="h13-0-1" class="i">+    name: &quot;name&quot;,
</a><a href="#h13-0-2" id="h13-0-2" class="i">+    columns: [
</a><a href="#h13-0-3" id="h13-0-3" class="i">+        ColumnSpec {
</a><a href="#h13-0-4" id="h13-0-4" class="i">+            name: &quot;id&quot;,
</a><a href="#h13-0-5" id="h13-0-5" class="i">+            datatype: Integer,
</a><a href="#h13-0-6" id="h13-0-6" class="i">+            primary_key: true,
</a><a href="#h13-0-7" id="h13-0-7" class="i">+            nullable: None,
</a><a href="#h13-0-8" id="h13-0-8" class="i">+        },
</a><a href="#h13-0-9" id="h13-0-9" class="i">+        ColumnSpec {
</a><a href="#h13-0-10" id="h13-0-10" class="i">+            name: &quot;string&quot;,
</a><a href="#h13-0-11" id="h13-0-11" class="i">+            datatype: String,
</a><a href="#h13-0-12" id="h13-0-12" class="i">+            primary_key: false,
</a><a href="#h13-0-13" id="h13-0-13" class="i">+            nullable: Some(
</a><a href="#h13-0-14" id="h13-0-14" class="i">+                false,
</a><a href="#h13-0-15" id="h13-0-15" class="i">+            ),
</a><a href="#h13-0-16" id="h13-0-16" class="i">+        },
</a><a href="#h13-0-17" id="h13-0-17" class="i">+        ColumnSpec {
</a><a href="#h13-0-18" id="h13-0-18" class="i">+            name: &quot;text&quot;,
</a><a href="#h13-0-19" id="h13-0-19" class="i">+            datatype: String,
</a><a href="#h13-0-20" id="h13-0-20" class="i">+            primary_key: false,
</a><a href="#h13-0-21" id="h13-0-21" class="i">+            nullable: None,
</a><a href="#h13-0-22" id="h13-0-22" class="i">+        },
</a><a href="#h13-0-23" id="h13-0-23" class="i">+        ColumnSpec {
</a><a href="#h13-0-24" id="h13-0-24" class="i">+            name: &quot;number&quot;,
</a><a href="#h13-0-25" id="h13-0-25" class="i">+            datatype: Integer,
</a><a href="#h13-0-26" id="h13-0-26" class="i">+            primary_key: false,
</a><a href="#h13-0-27" id="h13-0-27" class="i">+            nullable: None,
</a><a href="#h13-0-28" id="h13-0-28" class="i">+        },
</a><a href="#h13-0-29" id="h13-0-29" class="i">+        ColumnSpec {
</a><a href="#h13-0-30" id="h13-0-30" class="i">+            name: &quot;decimal&quot;,
</a><a href="#h13-0-31" id="h13-0-31" class="i">+            datatype: Float,
</a><a href="#h13-0-32" id="h13-0-32" class="i">+            primary_key: false,
</a><a href="#h13-0-33" id="h13-0-33" class="i">+            nullable: None,
</a><a href="#h13-0-34" id="h13-0-34" class="i">+        },
</a><a href="#h13-0-35" id="h13-0-35" class="i">+        ColumnSpec {
</a><a href="#h13-0-36" id="h13-0-36" class="i">+            name: &quot;bool&quot;,
</a><a href="#h13-0-37" id="h13-0-37" class="i">+            datatype: Boolean,
</a><a href="#h13-0-38" id="h13-0-38" class="i">+            primary_key: false,
</a><a href="#h13-0-39" id="h13-0-39" class="i">+            nullable: Some(
</a><a href="#h13-0-40" id="h13-0-40" class="i">+                true,
</a><a href="#h13-0-41" id="h13-0-41" class="i">+            ),
</a><a href="#h13-0-42" id="h13-0-42" class="i">+        },
</a><a href="#h13-0-43" id="h13-0-43" class="i">+    ],
</a><a href="#h13-0-44" id="h13-0-44" class="i">+}
</a><a href="#h13-0-45" id="h13-0-45" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h14" href="../file/src/sql/testdata/create_table/plan.html">src/sql/testdata/create_table/plan</a> b/<a href="../file/src/sql/testdata/create_table/plan.html">src/sql/testdata/create_table/plan</a></b>
<a href="#h14-0" id="h14-0" class="h">@@ -0,0 +1,44 @@
</a><a href="#h14-0-0" id="h14-0-0" class="i">+Plan {
</a><a href="#h14-0-1" id="h14-0-1" class="i">+    columns: [],
</a><a href="#h14-0-2" id="h14-0-2" class="i">+    root: DDL {
</a><a href="#h14-0-3" id="h14-0-3" class="i">+        storage: Storage,
</a><a href="#h14-0-4" id="h14-0-4" class="i">+        ddl: CreateTable(
</a><a href="#h14-0-5" id="h14-0-5" class="i">+            Table {
</a><a href="#h14-0-6" id="h14-0-6" class="i">+                name: &quot;name&quot;,
</a><a href="#h14-0-7" id="h14-0-7" class="i">+                columns: [
</a><a href="#h14-0-8" id="h14-0-8" class="i">+                    Column {
</a><a href="#h14-0-9" id="h14-0-9" class="i">+                        name: &quot;id&quot;,
</a><a href="#h14-0-10" id="h14-0-10" class="i">+                        datatype: Integer,
</a><a href="#h14-0-11" id="h14-0-11" class="i">+                        nullable: false,
</a><a href="#h14-0-12" id="h14-0-12" class="i">+                    },
</a><a href="#h14-0-13" id="h14-0-13" class="i">+                    Column {
</a><a href="#h14-0-14" id="h14-0-14" class="i">+                        name: &quot;string&quot;,
</a><a href="#h14-0-15" id="h14-0-15" class="i">+                        datatype: String,
</a><a href="#h14-0-16" id="h14-0-16" class="i">+                        nullable: false,
</a><a href="#h14-0-17" id="h14-0-17" class="i">+                    },
</a><a href="#h14-0-18" id="h14-0-18" class="i">+                    Column {
</a><a href="#h14-0-19" id="h14-0-19" class="i">+                        name: &quot;text&quot;,
</a><a href="#h14-0-20" id="h14-0-20" class="i">+                        datatype: String,
</a><a href="#h14-0-21" id="h14-0-21" class="i">+                        nullable: true,
</a><a href="#h14-0-22" id="h14-0-22" class="i">+                    },
</a><a href="#h14-0-23" id="h14-0-23" class="i">+                    Column {
</a><a href="#h14-0-24" id="h14-0-24" class="i">+                        name: &quot;number&quot;,
</a><a href="#h14-0-25" id="h14-0-25" class="i">+                        datatype: Integer,
</a><a href="#h14-0-26" id="h14-0-26" class="i">+                        nullable: true,
</a><a href="#h14-0-27" id="h14-0-27" class="i">+                    },
</a><a href="#h14-0-28" id="h14-0-28" class="i">+                    Column {
</a><a href="#h14-0-29" id="h14-0-29" class="i">+                        name: &quot;decimal&quot;,
</a><a href="#h14-0-30" id="h14-0-30" class="i">+                        datatype: Float,
</a><a href="#h14-0-31" id="h14-0-31" class="i">+                        nullable: true,
</a><a href="#h14-0-32" id="h14-0-32" class="i">+                    },
</a><a href="#h14-0-33" id="h14-0-33" class="i">+                    Column {
</a><a href="#h14-0-34" id="h14-0-34" class="i">+                        name: &quot;bool&quot;,
</a><a href="#h14-0-35" id="h14-0-35" class="i">+                        datatype: Boolean,
</a><a href="#h14-0-36" id="h14-0-36" class="i">+                        nullable: true,
</a><a href="#h14-0-37" id="h14-0-37" class="i">+                    },
</a><a href="#h14-0-38" id="h14-0-38" class="i">+                ],
</a><a href="#h14-0-39" id="h14-0-39" class="i">+                primary_key: &quot;id&quot;,
</a><a href="#h14-0-40" id="h14-0-40" class="i">+            },
</a><a href="#h14-0-41" id="h14-0-41" class="i">+        ),
</a><a href="#h14-0-42" id="h14-0-42" class="i">+    },
</a><a href="#h14-0-43" id="h14-0-43" class="i">+}
</a><a href="#h14-0-44" id="h14-0-44" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h15" href="../file/src/sql/testdata/create_table/query.sql.html">src/sql/testdata/create_table/query.sql</a> b/<a href="../file/src/sql/testdata/create_table/query.sql.html">src/sql/testdata/create_table/query.sql</a></b>
<a href="#h15-0" id="h15-0" class="h">@@ -0,0 +1,9 @@
</a><a href="#h15-0-0" id="h15-0-0" class="i">+
</a><a href="#h15-0-1" id="h15-0-1" class="i">+        CREATE TABLE name (
</a><a href="#h15-0-2" id="h15-0-2" class="i">+            id INTEGER PRIMARY KEY,
</a><a href="#h15-0-3" id="h15-0-3" class="i">+            string VARCHAR NOT NULL,
</a><a href="#h15-0-4" id="h15-0-4" class="i">+            text VARCHAR,
</a><a href="#h15-0-5" id="h15-0-5" class="i">+            number INTEGER,
</a><a href="#h15-0-6" id="h15-0-6" class="i">+            decimal FLOAT,
</a><a href="#h15-0-7" id="h15-0-7" class="i">+            bool BOOLEAN NULL
</a><a href="#h15-0-8" id="h15-0-8" class="i">+        )
</a><a href="#h15-0-9" id="h15-0-9" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h16" href="../file/src/sql/testdata/create_table/tokens.html">src/sql/testdata/create_table/tokens</a> b/<a href="../file/src/sql/testdata/create_table/tokens.html">src/sql/testdata/create_table/tokens</a></b>
<a href="#h16-0" id="h16-0" class="h">@@ -0,0 +1,69 @@
</a><a href="#h16-0-0" id="h16-0-0" class="i">+[
</a><a href="#h16-0-1" id="h16-0-1" class="i">+    Keyword(
</a><a href="#h16-0-2" id="h16-0-2" class="i">+        Create,
</a><a href="#h16-0-3" id="h16-0-3" class="i">+    ),
</a><a href="#h16-0-4" id="h16-0-4" class="i">+    Keyword(
</a><a href="#h16-0-5" id="h16-0-5" class="i">+        Table,
</a><a href="#h16-0-6" id="h16-0-6" class="i">+    ),
</a><a href="#h16-0-7" id="h16-0-7" class="i">+    Ident(
</a><a href="#h16-0-8" id="h16-0-8" class="i">+        &quot;name&quot;,
</a><a href="#h16-0-9" id="h16-0-9" class="i">+    ),
</a><a href="#h16-0-10" id="h16-0-10" class="i">+    OpenParen,
</a><a href="#h16-0-11" id="h16-0-11" class="i">+    Ident(
</a><a href="#h16-0-12" id="h16-0-12" class="i">+        &quot;id&quot;,
</a><a href="#h16-0-13" id="h16-0-13" class="i">+    ),
</a><a href="#h16-0-14" id="h16-0-14" class="i">+    Keyword(
</a><a href="#h16-0-15" id="h16-0-15" class="i">+        Integer,
</a><a href="#h16-0-16" id="h16-0-16" class="i">+    ),
</a><a href="#h16-0-17" id="h16-0-17" class="i">+    Keyword(
</a><a href="#h16-0-18" id="h16-0-18" class="i">+        Primary,
</a><a href="#h16-0-19" id="h16-0-19" class="i">+    ),
</a><a href="#h16-0-20" id="h16-0-20" class="i">+    Keyword(
</a><a href="#h16-0-21" id="h16-0-21" class="i">+        Key,
</a><a href="#h16-0-22" id="h16-0-22" class="i">+    ),
</a><a href="#h16-0-23" id="h16-0-23" class="i">+    Comma,
</a><a href="#h16-0-24" id="h16-0-24" class="i">+    Ident(
</a><a href="#h16-0-25" id="h16-0-25" class="i">+        &quot;string&quot;,
</a><a href="#h16-0-26" id="h16-0-26" class="i">+    ),
</a><a href="#h16-0-27" id="h16-0-27" class="i">+    Keyword(
</a><a href="#h16-0-28" id="h16-0-28" class="i">+        Varchar,
</a><a href="#h16-0-29" id="h16-0-29" class="i">+    ),
</a><a href="#h16-0-30" id="h16-0-30" class="i">+    Keyword(
</a><a href="#h16-0-31" id="h16-0-31" class="i">+        Not,
</a><a href="#h16-0-32" id="h16-0-32" class="i">+    ),
</a><a href="#h16-0-33" id="h16-0-33" class="i">+    Keyword(
</a><a href="#h16-0-34" id="h16-0-34" class="i">+        Null,
</a><a href="#h16-0-35" id="h16-0-35" class="i">+    ),
</a><a href="#h16-0-36" id="h16-0-36" class="i">+    Comma,
</a><a href="#h16-0-37" id="h16-0-37" class="i">+    Ident(
</a><a href="#h16-0-38" id="h16-0-38" class="i">+        &quot;text&quot;,
</a><a href="#h16-0-39" id="h16-0-39" class="i">+    ),
</a><a href="#h16-0-40" id="h16-0-40" class="i">+    Keyword(
</a><a href="#h16-0-41" id="h16-0-41" class="i">+        Varchar,
</a><a href="#h16-0-42" id="h16-0-42" class="i">+    ),
</a><a href="#h16-0-43" id="h16-0-43" class="i">+    Comma,
</a><a href="#h16-0-44" id="h16-0-44" class="i">+    Ident(
</a><a href="#h16-0-45" id="h16-0-45" class="i">+        &quot;number&quot;,
</a><a href="#h16-0-46" id="h16-0-46" class="i">+    ),
</a><a href="#h16-0-47" id="h16-0-47" class="i">+    Keyword(
</a><a href="#h16-0-48" id="h16-0-48" class="i">+        Integer,
</a><a href="#h16-0-49" id="h16-0-49" class="i">+    ),
</a><a href="#h16-0-50" id="h16-0-50" class="i">+    Comma,
</a><a href="#h16-0-51" id="h16-0-51" class="i">+    Ident(
</a><a href="#h16-0-52" id="h16-0-52" class="i">+        &quot;decimal&quot;,
</a><a href="#h16-0-53" id="h16-0-53" class="i">+    ),
</a><a href="#h16-0-54" id="h16-0-54" class="i">+    Keyword(
</a><a href="#h16-0-55" id="h16-0-55" class="i">+        Float,
</a><a href="#h16-0-56" id="h16-0-56" class="i">+    ),
</a><a href="#h16-0-57" id="h16-0-57" class="i">+    Comma,
</a><a href="#h16-0-58" id="h16-0-58" class="i">+    Ident(
</a><a href="#h16-0-59" id="h16-0-59" class="i">+        &quot;bool&quot;,
</a><a href="#h16-0-60" id="h16-0-60" class="i">+    ),
</a><a href="#h16-0-61" id="h16-0-61" class="i">+    Keyword(
</a><a href="#h16-0-62" id="h16-0-62" class="i">+        Boolean,
</a><a href="#h16-0-63" id="h16-0-63" class="i">+    ),
</a><a href="#h16-0-64" id="h16-0-64" class="i">+    Keyword(
</a><a href="#h16-0-65" id="h16-0-65" class="i">+        Null,
</a><a href="#h16-0-66" id="h16-0-66" class="i">+    ),
</a><a href="#h16-0-67" id="h16-0-67" class="i">+    CloseParen,
</a><a href="#h16-0-68" id="h16-0-68" class="i">+]
</a><a href="#h16-0-69" id="h16-0-69" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h17" href="../file/src/sql/testdata/create_table_error_bare/ast.html">src/sql/testdata/create_table_error_bare/ast</a> b/<a href="../file/src/sql/testdata/create_table_error_bare/ast.html">src/sql/testdata/create_table_error_bare/ast</a></b>
<a href="#h17-0" id="h17-0" class="h">@@ -0,0 +1 @@
</a><a href="#h17-0-0" id="h17-0-0" class="i">+Err(Parse(&quot;Unexpected end of input&quot;))
</a><a href="#h17-0-1" id="h17-0-1" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h18" href="../file/src/sql/testdata/create_table_error_bare/plan.html">src/sql/testdata/create_table_error_bare/plan</a> b/<a href="../file/src/sql/testdata/create_table_error_bare/plan.html">src/sql/testdata/create_table_error_bare/plan</a></b>
<a href="#h18-0" id="h18-0" class="h">@@ -0,0 +1 @@
</a><a href="#h18-0-0" id="h18-0-0" class="i">+Err(Parse(&quot;Unexpected end of input&quot;))
</a><a href="#h18-0-1" id="h18-0-1" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h19" href="../file/src/sql/testdata/create_table_error_bare/query.sql.html">src/sql/testdata/create_table_error_bare/query.sql</a> b/<a href="../file/src/sql/testdata/create_table_error_bare/query.sql.html">src/sql/testdata/create_table_error_bare/query.sql</a></b>
<a href="#h19-0" id="h19-0" class="h">@@ -0,0 +1 @@
</a><a href="#h19-0-0" id="h19-0-0" class="i">+CREATE TABLE
</a><a href="#h19-0-1" id="h19-0-1" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h20" href="../file/src/sql/testdata/create_table_error_bare/tokens.html">src/sql/testdata/create_table_error_bare/tokens</a> b/<a href="../file/src/sql/testdata/create_table_error_bare/tokens.html">src/sql/testdata/create_table_error_bare/tokens</a></b>
<a href="#h20-0" id="h20-0" class="h">@@ -0,0 +1,8 @@
</a><a href="#h20-0-0" id="h20-0-0" class="i">+[
</a><a href="#h20-0-1" id="h20-0-1" class="i">+    Keyword(
</a><a href="#h20-0-2" id="h20-0-2" class="i">+        Create,
</a><a href="#h20-0-3" id="h20-0-3" class="i">+    ),
</a><a href="#h20-0-4" id="h20-0-4" class="i">+    Keyword(
</a><a href="#h20-0-5" id="h20-0-5" class="i">+        Table,
</a><a href="#h20-0-6" id="h20-0-6" class="i">+    ),
</a><a href="#h20-0-7" id="h20-0-7" class="i">+]
</a><a href="#h20-0-8" id="h20-0-8" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h21" href="../file/src/sql/testdata/create_table_error_empty_columns/ast.html">src/sql/testdata/create_table_error_empty_columns/ast</a> b/<a href="../file/src/sql/testdata/create_table_error_empty_columns/ast.html">src/sql/testdata/create_table_error_empty_columns/ast</a></b>
<a href="#h21-0" id="h21-0" class="h">@@ -0,0 +1 @@
</a><a href="#h21-0-0" id="h21-0-0" class="i">+Err(Parse(&quot;Expected identifier, got )&quot;))
</a><a href="#h21-0-1" id="h21-0-1" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h22" href="../file/src/sql/testdata/create_table_error_empty_columns/plan.html">src/sql/testdata/create_table_error_empty_columns/plan</a> b/<a href="../file/src/sql/testdata/create_table_error_empty_columns/plan.html">src/sql/testdata/create_table_error_empty_columns/plan</a></b>
<a href="#h22-0" id="h22-0" class="h">@@ -0,0 +1 @@
</a><a href="#h22-0-0" id="h22-0-0" class="i">+Err(Parse(&quot;Expected identifier, got )&quot;))
</a><a href="#h22-0-1" id="h22-0-1" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h23" href="../file/src/sql/testdata/create_table_error_empty_columns/query.sql.html">src/sql/testdata/create_table_error_empty_columns/query.sql</a> b/<a href="../file/src/sql/testdata/create_table_error_empty_columns/query.sql.html">src/sql/testdata/create_table_error_empty_columns/query.sql</a></b>
<a href="#h23-0" id="h23-0" class="h">@@ -0,0 +1 @@
</a><a href="#h23-0-0" id="h23-0-0" class="i">+CREATE TABLE name ()
</a><a href="#h23-0-1" id="h23-0-1" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h24" href="../file/src/sql/testdata/create_table_error_empty_columns/tokens.html">src/sql/testdata/create_table_error_empty_columns/tokens</a> b/<a href="../file/src/sql/testdata/create_table_error_empty_columns/tokens.html">src/sql/testdata/create_table_error_empty_columns/tokens</a></b>
<a href="#h24-0" id="h24-0" class="h">@@ -0,0 +1,13 @@
</a><a href="#h24-0-0" id="h24-0-0" class="i">+[
</a><a href="#h24-0-1" id="h24-0-1" class="i">+    Keyword(
</a><a href="#h24-0-2" id="h24-0-2" class="i">+        Create,
</a><a href="#h24-0-3" id="h24-0-3" class="i">+    ),
</a><a href="#h24-0-4" id="h24-0-4" class="i">+    Keyword(
</a><a href="#h24-0-5" id="h24-0-5" class="i">+        Table,
</a><a href="#h24-0-6" id="h24-0-6" class="i">+    ),
</a><a href="#h24-0-7" id="h24-0-7" class="i">+    Ident(
</a><a href="#h24-0-8" id="h24-0-8" class="i">+        &quot;name&quot;,
</a><a href="#h24-0-9" id="h24-0-9" class="i">+    ),
</a><a href="#h24-0-10" id="h24-0-10" class="i">+    OpenParen,
</a><a href="#h24-0-11" id="h24-0-11" class="i">+    CloseParen,
</a><a href="#h24-0-12" id="h24-0-12" class="i">+]
</a><a href="#h24-0-13" id="h24-0-13" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h25" href="../file/src/sql/testdata/create_table_error_multiple_primary_key/ast.html">src/sql/testdata/create_table_error_multiple_primary_key/ast</a> b/<a href="../file/src/sql/testdata/create_table_error_multiple_primary_key/ast.html">src/sql/testdata/create_table_error_multiple_primary_key/ast</a></b>
<a href="#h25-0" id="h25-0" class="h">@@ -0,0 +1,17 @@
</a><a href="#h25-0-0" id="h25-0-0" class="i">+CreateTable {
</a><a href="#h25-0-1" id="h25-0-1" class="i">+    name: &quot;name&quot;,
</a><a href="#h25-0-2" id="h25-0-2" class="i">+    columns: [
</a><a href="#h25-0-3" id="h25-0-3" class="i">+        ColumnSpec {
</a><a href="#h25-0-4" id="h25-0-4" class="i">+            name: &quot;id&quot;,
</a><a href="#h25-0-5" id="h25-0-5" class="i">+            datatype: Integer,
</a><a href="#h25-0-6" id="h25-0-6" class="i">+            primary_key: true,
</a><a href="#h25-0-7" id="h25-0-7" class="i">+            nullable: None,
</a><a href="#h25-0-8" id="h25-0-8" class="i">+        },
</a><a href="#h25-0-9" id="h25-0-9" class="i">+        ColumnSpec {
</a><a href="#h25-0-10" id="h25-0-10" class="i">+            name: &quot;name&quot;,
</a><a href="#h25-0-11" id="h25-0-11" class="i">+            datatype: String,
</a><a href="#h25-0-12" id="h25-0-12" class="i">+            primary_key: true,
</a><a href="#h25-0-13" id="h25-0-13" class="i">+            nullable: None,
</a><a href="#h25-0-14" id="h25-0-14" class="i">+        },
</a><a href="#h25-0-15" id="h25-0-15" class="i">+    ],
</a><a href="#h25-0-16" id="h25-0-16" class="i">+}
</a><a href="#h25-0-17" id="h25-0-17" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h26" href="../file/src/sql/testdata/create_table_error_multiple_primary_key/plan.html">src/sql/testdata/create_table_error_multiple_primary_key/plan</a> b/<a href="../file/src/sql/testdata/create_table_error_multiple_primary_key/plan.html">src/sql/testdata/create_table_error_multiple_primary_key/plan</a></b>
<a href="#h26-0" id="h26-0" class="h">@@ -0,0 +1 @@
</a><a href="#h26-0-0" id="h26-0-0" class="i">+Err(Value(&quot;2 primary keys defined for table name, must set exactly 1&quot;))
</a><a href="#h26-0-1" id="h26-0-1" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h27" href="../file/src/sql/testdata/create_table_error_multiple_primary_key/query.sql.html">src/sql/testdata/create_table_error_multiple_primary_key/query.sql</a> b/<a href="../file/src/sql/testdata/create_table_error_multiple_primary_key/query.sql.html">src/sql/testdata/create_table_error_multiple_primary_key/query.sql</a></b>
<a href="#h27-0" id="h27-0" class="h">@@ -0,0 +1 @@
</a><a href="#h27-0-0" id="h27-0-0" class="i">+CREATE TABLE name (id INTEGER PRIMARY KEY, name VARCHAR PRIMARY KEY)
</a><a href="#h27-0-1" id="h27-0-1" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h28" href="../file/src/sql/testdata/create_table_error_multiple_primary_key/tokens.html">src/sql/testdata/create_table_error_multiple_primary_key/tokens</a> b/<a href="../file/src/sql/testdata/create_table_error_multiple_primary_key/tokens.html">src/sql/testdata/create_table_error_multiple_primary_key/tokens</a></b>
<a href="#h28-0" id="h28-0" class="h">@@ -0,0 +1,38 @@
</a><a href="#h28-0-0" id="h28-0-0" class="i">+[
</a><a href="#h28-0-1" id="h28-0-1" class="i">+    Keyword(
</a><a href="#h28-0-2" id="h28-0-2" class="i">+        Create,
</a><a href="#h28-0-3" id="h28-0-3" class="i">+    ),
</a><a href="#h28-0-4" id="h28-0-4" class="i">+    Keyword(
</a><a href="#h28-0-5" id="h28-0-5" class="i">+        Table,
</a><a href="#h28-0-6" id="h28-0-6" class="i">+    ),
</a><a href="#h28-0-7" id="h28-0-7" class="i">+    Ident(
</a><a href="#h28-0-8" id="h28-0-8" class="i">+        &quot;name&quot;,
</a><a href="#h28-0-9" id="h28-0-9" class="i">+    ),
</a><a href="#h28-0-10" id="h28-0-10" class="i">+    OpenParen,
</a><a href="#h28-0-11" id="h28-0-11" class="i">+    Ident(
</a><a href="#h28-0-12" id="h28-0-12" class="i">+        &quot;id&quot;,
</a><a href="#h28-0-13" id="h28-0-13" class="i">+    ),
</a><a href="#h28-0-14" id="h28-0-14" class="i">+    Keyword(
</a><a href="#h28-0-15" id="h28-0-15" class="i">+        Integer,
</a><a href="#h28-0-16" id="h28-0-16" class="i">+    ),
</a><a href="#h28-0-17" id="h28-0-17" class="i">+    Keyword(
</a><a href="#h28-0-18" id="h28-0-18" class="i">+        Primary,
</a><a href="#h28-0-19" id="h28-0-19" class="i">+    ),
</a><a href="#h28-0-20" id="h28-0-20" class="i">+    Keyword(
</a><a href="#h28-0-21" id="h28-0-21" class="i">+        Key,
</a><a href="#h28-0-22" id="h28-0-22" class="i">+    ),
</a><a href="#h28-0-23" id="h28-0-23" class="i">+    Comma,
</a><a href="#h28-0-24" id="h28-0-24" class="i">+    Ident(
</a><a href="#h28-0-25" id="h28-0-25" class="i">+        &quot;name&quot;,
</a><a href="#h28-0-26" id="h28-0-26" class="i">+    ),
</a><a href="#h28-0-27" id="h28-0-27" class="i">+    Keyword(
</a><a href="#h28-0-28" id="h28-0-28" class="i">+        Varchar,
</a><a href="#h28-0-29" id="h28-0-29" class="i">+    ),
</a><a href="#h28-0-30" id="h28-0-30" class="i">+    Keyword(
</a><a href="#h28-0-31" id="h28-0-31" class="i">+        Primary,
</a><a href="#h28-0-32" id="h28-0-32" class="i">+    ),
</a><a href="#h28-0-33" id="h28-0-33" class="i">+    Keyword(
</a><a href="#h28-0-34" id="h28-0-34" class="i">+        Key,
</a><a href="#h28-0-35" id="h28-0-35" class="i">+    ),
</a><a href="#h28-0-36" id="h28-0-36" class="i">+    CloseParen,
</a><a href="#h28-0-37" id="h28-0-37" class="i">+]
</a><a href="#h28-0-38" id="h28-0-38" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h29" href="../file/src/sql/testdata/create_table_error_no_columns/ast.html">src/sql/testdata/create_table_error_no_columns/ast</a> b/<a href="../file/src/sql/testdata/create_table_error_no_columns/ast.html">src/sql/testdata/create_table_error_no_columns/ast</a></b>
<a href="#h29-0" id="h29-0" class="h">@@ -0,0 +1 @@
</a><a href="#h29-0-0" id="h29-0-0" class="i">+Err(Parse(&quot;Unexpected end of input&quot;))
</a><a href="#h29-0-1" id="h29-0-1" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h30" href="../file/src/sql/testdata/create_table_error_no_columns/plan.html">src/sql/testdata/create_table_error_no_columns/plan</a> b/<a href="../file/src/sql/testdata/create_table_error_no_columns/plan.html">src/sql/testdata/create_table_error_no_columns/plan</a></b>
<a href="#h30-0" id="h30-0" class="h">@@ -0,0 +1 @@
</a><a href="#h30-0-0" id="h30-0-0" class="i">+Err(Parse(&quot;Unexpected end of input&quot;))
</a><a href="#h30-0-1" id="h30-0-1" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h31" href="../file/src/sql/testdata/create_table_error_no_columns/query.sql.html">src/sql/testdata/create_table_error_no_columns/query.sql</a> b/<a href="../file/src/sql/testdata/create_table_error_no_columns/query.sql.html">src/sql/testdata/create_table_error_no_columns/query.sql</a></b>
<a href="#h31-0" id="h31-0" class="h">@@ -0,0 +1 @@
</a><a href="#h31-0-0" id="h31-0-0" class="i">+CREATE TABLE name
</a><a href="#h31-0-1" id="h31-0-1" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h32" href="../file/src/sql/testdata/create_table_error_no_columns/tokens.html">src/sql/testdata/create_table_error_no_columns/tokens</a> b/<a href="../file/src/sql/testdata/create_table_error_no_columns/tokens.html">src/sql/testdata/create_table_error_no_columns/tokens</a></b>
<a href="#h32-0" id="h32-0" class="h">@@ -0,0 +1,11 @@
</a><a href="#h32-0-0" id="h32-0-0" class="i">+[
</a><a href="#h32-0-1" id="h32-0-1" class="i">+    Keyword(
</a><a href="#h32-0-2" id="h32-0-2" class="i">+        Create,
</a><a href="#h32-0-3" id="h32-0-3" class="i">+    ),
</a><a href="#h32-0-4" id="h32-0-4" class="i">+    Keyword(
</a><a href="#h32-0-5" id="h32-0-5" class="i">+        Table,
</a><a href="#h32-0-6" id="h32-0-6" class="i">+    ),
</a><a href="#h32-0-7" id="h32-0-7" class="i">+    Ident(
</a><a href="#h32-0-8" id="h32-0-8" class="i">+        &quot;name&quot;,
</a><a href="#h32-0-9" id="h32-0-9" class="i">+    ),
</a><a href="#h32-0-10" id="h32-0-10" class="i">+]
</a><a href="#h32-0-11" id="h32-0-11" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h33" href="../file/src/sql/testdata/create_table_error_no_datatype/ast.html">src/sql/testdata/create_table_error_no_datatype/ast</a> b/<a href="../file/src/sql/testdata/create_table_error_no_datatype/ast.html">src/sql/testdata/create_table_error_no_datatype/ast</a></b>
<a href="#h33-0" id="h33-0" class="h">@@ -0,0 +1 @@
</a><a href="#h33-0-0" id="h33-0-0" class="i">+Err(Parse(&quot;Unexpected token )&quot;))
</a><a href="#h33-0-1" id="h33-0-1" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h34" href="../file/src/sql/testdata/create_table_error_no_datatype/plan.html">src/sql/testdata/create_table_error_no_datatype/plan</a> b/<a href="../file/src/sql/testdata/create_table_error_no_datatype/plan.html">src/sql/testdata/create_table_error_no_datatype/plan</a></b>
<a href="#h34-0" id="h34-0" class="h">@@ -0,0 +1 @@
</a><a href="#h34-0-0" id="h34-0-0" class="i">+Err(Parse(&quot;Unexpected token )&quot;))
</a><a href="#h34-0-1" id="h34-0-1" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h35" href="../file/src/sql/testdata/create_table_error_no_datatype/query.sql.html">src/sql/testdata/create_table_error_no_datatype/query.sql</a> b/<a href="../file/src/sql/testdata/create_table_error_no_datatype/query.sql.html">src/sql/testdata/create_table_error_no_datatype/query.sql</a></b>
<a href="#h35-0" id="h35-0" class="h">@@ -0,0 +1 @@
</a><a href="#h35-0-0" id="h35-0-0" class="i">+CREATE TABLE name (id)
</a><a href="#h35-0-1" id="h35-0-1" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h36" href="../file/src/sql/testdata/create_table_error_no_datatype/tokens.html">src/sql/testdata/create_table_error_no_datatype/tokens</a> b/<a href="../file/src/sql/testdata/create_table_error_no_datatype/tokens.html">src/sql/testdata/create_table_error_no_datatype/tokens</a></b>
<a href="#h36-0" id="h36-0" class="h">@@ -0,0 +1,16 @@
</a><a href="#h36-0-0" id="h36-0-0" class="i">+[
</a><a href="#h36-0-1" id="h36-0-1" class="i">+    Keyword(
</a><a href="#h36-0-2" id="h36-0-2" class="i">+        Create,
</a><a href="#h36-0-3" id="h36-0-3" class="i">+    ),
</a><a href="#h36-0-4" id="h36-0-4" class="i">+    Keyword(
</a><a href="#h36-0-5" id="h36-0-5" class="i">+        Table,
</a><a href="#h36-0-6" id="h36-0-6" class="i">+    ),
</a><a href="#h36-0-7" id="h36-0-7" class="i">+    Ident(
</a><a href="#h36-0-8" id="h36-0-8" class="i">+        &quot;name&quot;,
</a><a href="#h36-0-9" id="h36-0-9" class="i">+    ),
</a><a href="#h36-0-10" id="h36-0-10" class="i">+    OpenParen,
</a><a href="#h36-0-11" id="h36-0-11" class="i">+    Ident(
</a><a href="#h36-0-12" id="h36-0-12" class="i">+        &quot;id&quot;,
</a><a href="#h36-0-13" id="h36-0-13" class="i">+    ),
</a><a href="#h36-0-14" id="h36-0-14" class="i">+    CloseParen,
</a><a href="#h36-0-15" id="h36-0-15" class="i">+]
</a><a href="#h36-0-16" id="h36-0-16" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h37" href="../file/src/sql/testdata/create_table_error_no_name/ast.html">src/sql/testdata/create_table_error_no_name/ast</a> b/<a href="../file/src/sql/testdata/create_table_error_no_name/ast.html">src/sql/testdata/create_table_error_no_name/ast</a></b>
<a href="#h37-0" id="h37-0" class="h">@@ -0,0 +1 @@
</a><a href="#h37-0-0" id="h37-0-0" class="i">+Err(Parse(&quot;Expected identifier, got (&quot;))
</a><a href="#h37-0-1" id="h37-0-1" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h38" href="../file/src/sql/testdata/create_table_error_no_name/plan.html">src/sql/testdata/create_table_error_no_name/plan</a> b/<a href="../file/src/sql/testdata/create_table_error_no_name/plan.html">src/sql/testdata/create_table_error_no_name/plan</a></b>
<a href="#h38-0" id="h38-0" class="h">@@ -0,0 +1 @@
</a><a href="#h38-0-0" id="h38-0-0" class="i">+Err(Parse(&quot;Expected identifier, got (&quot;))
</a><a href="#h38-0-1" id="h38-0-1" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h39" href="../file/src/sql/testdata/create_table_error_no_name/query.sql.html">src/sql/testdata/create_table_error_no_name/query.sql</a> b/<a href="../file/src/sql/testdata/create_table_error_no_name/query.sql.html">src/sql/testdata/create_table_error_no_name/query.sql</a></b>
<a href="#h39-0" id="h39-0" class="h">@@ -0,0 +1 @@
</a><a href="#h39-0-0" id="h39-0-0" class="i">+CREATE TABLE (id INTEGER)
</a><a href="#h39-0-1" id="h39-0-1" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h40" href="../file/src/sql/testdata/create_table_error_no_name/tokens.html">src/sql/testdata/create_table_error_no_name/tokens</a> b/<a href="../file/src/sql/testdata/create_table_error_no_name/tokens.html">src/sql/testdata/create_table_error_no_name/tokens</a></b>
<a href="#h40-0" id="h40-0" class="h">@@ -0,0 +1,16 @@
</a><a href="#h40-0-0" id="h40-0-0" class="i">+[
</a><a href="#h40-0-1" id="h40-0-1" class="i">+    Keyword(
</a><a href="#h40-0-2" id="h40-0-2" class="i">+        Create,
</a><a href="#h40-0-3" id="h40-0-3" class="i">+    ),
</a><a href="#h40-0-4" id="h40-0-4" class="i">+    Keyword(
</a><a href="#h40-0-5" id="h40-0-5" class="i">+        Table,
</a><a href="#h40-0-6" id="h40-0-6" class="i">+    ),
</a><a href="#h40-0-7" id="h40-0-7" class="i">+    OpenParen,
</a><a href="#h40-0-8" id="h40-0-8" class="i">+    Ident(
</a><a href="#h40-0-9" id="h40-0-9" class="i">+        &quot;id&quot;,
</a><a href="#h40-0-10" id="h40-0-10" class="i">+    ),
</a><a href="#h40-0-11" id="h40-0-11" class="i">+    Keyword(
</a><a href="#h40-0-12" id="h40-0-12" class="i">+        Integer,
</a><a href="#h40-0-13" id="h40-0-13" class="i">+    ),
</a><a href="#h40-0-14" id="h40-0-14" class="i">+    CloseParen,
</a><a href="#h40-0-15" id="h40-0-15" class="i">+]
</a><a href="#h40-0-16" id="h40-0-16" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h41" href="../file/src/sql/testdata/create_table_error_no_primary_key/ast.html">src/sql/testdata/create_table_error_no_primary_key/ast</a> b/<a href="../file/src/sql/testdata/create_table_error_no_primary_key/ast.html">src/sql/testdata/create_table_error_no_primary_key/ast</a></b>
<a href="#h41-0" id="h41-0" class="h">@@ -0,0 +1,11 @@
</a><a href="#h41-0-0" id="h41-0-0" class="i">+CreateTable {
</a><a href="#h41-0-1" id="h41-0-1" class="i">+    name: &quot;name&quot;,
</a><a href="#h41-0-2" id="h41-0-2" class="i">+    columns: [
</a><a href="#h41-0-3" id="h41-0-3" class="i">+        ColumnSpec {
</a><a href="#h41-0-4" id="h41-0-4" class="i">+            name: &quot;id&quot;,
</a><a href="#h41-0-5" id="h41-0-5" class="i">+            datatype: Integer,
</a><a href="#h41-0-6" id="h41-0-6" class="i">+            primary_key: false,
</a><a href="#h41-0-7" id="h41-0-7" class="i">+            nullable: None,
</a><a href="#h41-0-8" id="h41-0-8" class="i">+        },
</a><a href="#h41-0-9" id="h41-0-9" class="i">+    ],
</a><a href="#h41-0-10" id="h41-0-10" class="i">+}
</a><a href="#h41-0-11" id="h41-0-11" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h42" href="../file/src/sql/testdata/create_table_error_no_primary_key/plan.html">src/sql/testdata/create_table_error_no_primary_key/plan</a> b/<a href="../file/src/sql/testdata/create_table_error_no_primary_key/plan.html">src/sql/testdata/create_table_error_no_primary_key/plan</a></b>
<a href="#h42-0" id="h42-0" class="h">@@ -0,0 +1 @@
</a><a href="#h42-0-0" id="h42-0-0" class="i">+Err(Value(&quot;No primary key defined for table name&quot;))
</a><a href="#h42-0-1" id="h42-0-1" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h43" href="../file/src/sql/testdata/create_table_error_no_primary_key/query.sql.html">src/sql/testdata/create_table_error_no_primary_key/query.sql</a> b/<a href="../file/src/sql/testdata/create_table_error_no_primary_key/query.sql.html">src/sql/testdata/create_table_error_no_primary_key/query.sql</a></b>
<a href="#h43-0" id="h43-0" class="h">@@ -0,0 +1 @@
</a><a href="#h43-0-0" id="h43-0-0" class="i">+CREATE TABLE name (id INTEGER)
</a><a href="#h43-0-1" id="h43-0-1" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h44" href="../file/src/sql/testdata/create_table_error_no_primary_key/tokens.html">src/sql/testdata/create_table_error_no_primary_key/tokens</a> b/<a href="../file/src/sql/testdata/create_table_error_no_primary_key/tokens.html">src/sql/testdata/create_table_error_no_primary_key/tokens</a></b>
<a href="#h44-0" id="h44-0" class="h">@@ -0,0 +1,19 @@
</a><a href="#h44-0-0" id="h44-0-0" class="i">+[
</a><a href="#h44-0-1" id="h44-0-1" class="i">+    Keyword(
</a><a href="#h44-0-2" id="h44-0-2" class="i">+        Create,
</a><a href="#h44-0-3" id="h44-0-3" class="i">+    ),
</a><a href="#h44-0-4" id="h44-0-4" class="i">+    Keyword(
</a><a href="#h44-0-5" id="h44-0-5" class="i">+        Table,
</a><a href="#h44-0-6" id="h44-0-6" class="i">+    ),
</a><a href="#h44-0-7" id="h44-0-7" class="i">+    Ident(
</a><a href="#h44-0-8" id="h44-0-8" class="i">+        &quot;name&quot;,
</a><a href="#h44-0-9" id="h44-0-9" class="i">+    ),
</a><a href="#h44-0-10" id="h44-0-10" class="i">+    OpenParen,
</a><a href="#h44-0-11" id="h44-0-11" class="i">+    Ident(
</a><a href="#h44-0-12" id="h44-0-12" class="i">+        &quot;id&quot;,
</a><a href="#h44-0-13" id="h44-0-13" class="i">+    ),
</a><a href="#h44-0-14" id="h44-0-14" class="i">+    Keyword(
</a><a href="#h44-0-15" id="h44-0-15" class="i">+        Integer,
</a><a href="#h44-0-16" id="h44-0-16" class="i">+    ),
</a><a href="#h44-0-17" id="h44-0-17" class="i">+    CloseParen,
</a><a href="#h44-0-18" id="h44-0-18" class="i">+]
</a><a href="#h44-0-19" id="h44-0-19" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h45" href="../file/src/sql/testdata/create_table_single_column/ast.html">src/sql/testdata/create_table_single_column/ast</a> b/<a href="../file/src/sql/testdata/create_table_single_column/ast.html">src/sql/testdata/create_table_single_column/ast</a></b>
<a href="#h45-0" id="h45-0" class="h">@@ -0,0 +1,11 @@
</a><a href="#h45-0-0" id="h45-0-0" class="i">+CreateTable {
</a><a href="#h45-0-1" id="h45-0-1" class="i">+    name: &quot;name&quot;,
</a><a href="#h45-0-2" id="h45-0-2" class="i">+    columns: [
</a><a href="#h45-0-3" id="h45-0-3" class="i">+        ColumnSpec {
</a><a href="#h45-0-4" id="h45-0-4" class="i">+            name: &quot;id&quot;,
</a><a href="#h45-0-5" id="h45-0-5" class="i">+            datatype: Integer,
</a><a href="#h45-0-6" id="h45-0-6" class="i">+            primary_key: true,
</a><a href="#h45-0-7" id="h45-0-7" class="i">+            nullable: None,
</a><a href="#h45-0-8" id="h45-0-8" class="i">+        },
</a><a href="#h45-0-9" id="h45-0-9" class="i">+    ],
</a><a href="#h45-0-10" id="h45-0-10" class="i">+}
</a><a href="#h45-0-11" id="h45-0-11" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h46" href="../file/src/sql/testdata/create_table_single_column/plan.html">src/sql/testdata/create_table_single_column/plan</a> b/<a href="../file/src/sql/testdata/create_table_single_column/plan.html">src/sql/testdata/create_table_single_column/plan</a></b>
<a href="#h46-0" id="h46-0" class="h">@@ -0,0 +1,19 @@
</a><a href="#h46-0-0" id="h46-0-0" class="i">+Plan {
</a><a href="#h46-0-1" id="h46-0-1" class="i">+    columns: [],
</a><a href="#h46-0-2" id="h46-0-2" class="i">+    root: DDL {
</a><a href="#h46-0-3" id="h46-0-3" class="i">+        storage: Storage,
</a><a href="#h46-0-4" id="h46-0-4" class="i">+        ddl: CreateTable(
</a><a href="#h46-0-5" id="h46-0-5" class="i">+            Table {
</a><a href="#h46-0-6" id="h46-0-6" class="i">+                name: &quot;name&quot;,
</a><a href="#h46-0-7" id="h46-0-7" class="i">+                columns: [
</a><a href="#h46-0-8" id="h46-0-8" class="i">+                    Column {
</a><a href="#h46-0-9" id="h46-0-9" class="i">+                        name: &quot;id&quot;,
</a><a href="#h46-0-10" id="h46-0-10" class="i">+                        datatype: Integer,
</a><a href="#h46-0-11" id="h46-0-11" class="i">+                        nullable: false,
</a><a href="#h46-0-12" id="h46-0-12" class="i">+                    },
</a><a href="#h46-0-13" id="h46-0-13" class="i">+                ],
</a><a href="#h46-0-14" id="h46-0-14" class="i">+                primary_key: &quot;id&quot;,
</a><a href="#h46-0-15" id="h46-0-15" class="i">+            },
</a><a href="#h46-0-16" id="h46-0-16" class="i">+        ),
</a><a href="#h46-0-17" id="h46-0-17" class="i">+    },
</a><a href="#h46-0-18" id="h46-0-18" class="i">+}
</a><a href="#h46-0-19" id="h46-0-19" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h47" href="../file/src/sql/testdata/create_table_single_column/query.sql.html">src/sql/testdata/create_table_single_column/query.sql</a> b/<a href="../file/src/sql/testdata/create_table_single_column/query.sql.html">src/sql/testdata/create_table_single_column/query.sql</a></b>
<a href="#h47-0" id="h47-0" class="h">@@ -0,0 +1 @@
</a><a href="#h47-0-0" id="h47-0-0" class="i">+CREATE TABLE name (id INTEGER PRIMARY KEY)
</a><a href="#h47-0-1" id="h47-0-1" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h48" href="../file/src/sql/testdata/create_table_single_column/tokens.html">src/sql/testdata/create_table_single_column/tokens</a> b/<a href="../file/src/sql/testdata/create_table_single_column/tokens.html">src/sql/testdata/create_table_single_column/tokens</a></b>
<a href="#h48-0" id="h48-0" class="h">@@ -0,0 +1,25 @@
</a><a href="#h48-0-0" id="h48-0-0" class="i">+[
</a><a href="#h48-0-1" id="h48-0-1" class="i">+    Keyword(
</a><a href="#h48-0-2" id="h48-0-2" class="i">+        Create,
</a><a href="#h48-0-3" id="h48-0-3" class="i">+    ),
</a><a href="#h48-0-4" id="h48-0-4" class="i">+    Keyword(
</a><a href="#h48-0-5" id="h48-0-5" class="i">+        Table,
</a><a href="#h48-0-6" id="h48-0-6" class="i">+    ),
</a><a href="#h48-0-7" id="h48-0-7" class="i">+    Ident(
</a><a href="#h48-0-8" id="h48-0-8" class="i">+        &quot;name&quot;,
</a><a href="#h48-0-9" id="h48-0-9" class="i">+    ),
</a><a href="#h48-0-10" id="h48-0-10" class="i">+    OpenParen,
</a><a href="#h48-0-11" id="h48-0-11" class="i">+    Ident(
</a><a href="#h48-0-12" id="h48-0-12" class="i">+        &quot;id&quot;,
</a><a href="#h48-0-13" id="h48-0-13" class="i">+    ),
</a><a href="#h48-0-14" id="h48-0-14" class="i">+    Keyword(
</a><a href="#h48-0-15" id="h48-0-15" class="i">+        Integer,
</a><a href="#h48-0-16" id="h48-0-16" class="i">+    ),
</a><a href="#h48-0-17" id="h48-0-17" class="i">+    Keyword(
</a><a href="#h48-0-18" id="h48-0-18" class="i">+        Primary,
</a><a href="#h48-0-19" id="h48-0-19" class="i">+    ),
</a><a href="#h48-0-20" id="h48-0-20" class="i">+    Keyword(
</a><a href="#h48-0-21" id="h48-0-21" class="i">+        Key,
</a><a href="#h48-0-22" id="h48-0-22" class="i">+    ),
</a><a href="#h48-0-23" id="h48-0-23" class="i">+    CloseParen,
</a><a href="#h48-0-24" id="h48-0-24" class="i">+]
</a><a href="#h48-0-25" id="h48-0-25" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h49" href="../file/src/sql/testdata/drop_table/ast.html">src/sql/testdata/drop_table/ast</a> b/<a href="../file/src/sql/testdata/drop_table/ast.html">src/sql/testdata/drop_table/ast</a></b>
<a href="#h49-0" id="h49-0" class="h">@@ -0,0 +1,3 @@
</a><a href="#h49-0-0" id="h49-0-0" class="i">+DropTable(
</a><a href="#h49-0-1" id="h49-0-1" class="i">+    &quot;name&quot;,
</a><a href="#h49-0-2" id="h49-0-2" class="i">+)
</a><a href="#h49-0-3" id="h49-0-3" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h50" href="../file/src/sql/testdata/drop_table/plan.html">src/sql/testdata/drop_table/plan</a> b/<a href="../file/src/sql/testdata/drop_table/plan.html">src/sql/testdata/drop_table/plan</a></b>
<a href="#h50-0" id="h50-0" class="h">@@ -0,0 +1,9 @@
</a><a href="#h50-0-0" id="h50-0-0" class="i">+Plan {
</a><a href="#h50-0-1" id="h50-0-1" class="i">+    columns: [],
</a><a href="#h50-0-2" id="h50-0-2" class="i">+    root: DDL {
</a><a href="#h50-0-3" id="h50-0-3" class="i">+        storage: Storage,
</a><a href="#h50-0-4" id="h50-0-4" class="i">+        ddl: DropTable(
</a><a href="#h50-0-5" id="h50-0-5" class="i">+            &quot;name&quot;,
</a><a href="#h50-0-6" id="h50-0-6" class="i">+        ),
</a><a href="#h50-0-7" id="h50-0-7" class="i">+    },
</a><a href="#h50-0-8" id="h50-0-8" class="i">+}
</a><a href="#h50-0-9" id="h50-0-9" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h51" href="../file/src/sql/testdata/drop_table/query.sql.html">src/sql/testdata/drop_table/query.sql</a> b/<a href="../file/src/sql/testdata/drop_table/query.sql.html">src/sql/testdata/drop_table/query.sql</a></b>
<a href="#h51-0" id="h51-0" class="h">@@ -0,0 +1 @@
</a><a href="#h51-0-0" id="h51-0-0" class="i">+DROP TABLE name
</a><a href="#h51-0-1" id="h51-0-1" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h52" href="../file/src/sql/testdata/drop_table/tokens.html">src/sql/testdata/drop_table/tokens</a> b/<a href="../file/src/sql/testdata/drop_table/tokens.html">src/sql/testdata/drop_table/tokens</a></b>
<a href="#h52-0" id="h52-0" class="h">@@ -0,0 +1,11 @@
</a><a href="#h52-0-0" id="h52-0-0" class="i">+[
</a><a href="#h52-0-1" id="h52-0-1" class="i">+    Keyword(
</a><a href="#h52-0-2" id="h52-0-2" class="i">+        Drop,
</a><a href="#h52-0-3" id="h52-0-3" class="i">+    ),
</a><a href="#h52-0-4" id="h52-0-4" class="i">+    Keyword(
</a><a href="#h52-0-5" id="h52-0-5" class="i">+        Table,
</a><a href="#h52-0-6" id="h52-0-6" class="i">+    ),
</a><a href="#h52-0-7" id="h52-0-7" class="i">+    Ident(
</a><a href="#h52-0-8" id="h52-0-8" class="i">+        &quot;name&quot;,
</a><a href="#h52-0-9" id="h52-0-9" class="i">+    ),
</a><a href="#h52-0-10" id="h52-0-10" class="i">+]
</a><a href="#h52-0-11" id="h52-0-11" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h53" href="../file/src/sql/testdata/drop_table_error_bare/ast.html">src/sql/testdata/drop_table_error_bare/ast</a> b/<a href="../file/src/sql/testdata/drop_table_error_bare/ast.html">src/sql/testdata/drop_table_error_bare/ast</a></b>
<a href="#h53-0" id="h53-0" class="h">@@ -0,0 +1 @@
</a><a href="#h53-0-0" id="h53-0-0" class="i">+Err(Parse(&quot;Unexpected end of input&quot;))
</a><a href="#h53-0-1" id="h53-0-1" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h54" href="../file/src/sql/testdata/drop_table_error_bare/plan.html">src/sql/testdata/drop_table_error_bare/plan</a> b/<a href="../file/src/sql/testdata/drop_table_error_bare/plan.html">src/sql/testdata/drop_table_error_bare/plan</a></b>
<a href="#h54-0" id="h54-0" class="h">@@ -0,0 +1 @@
</a><a href="#h54-0-0" id="h54-0-0" class="i">+Err(Parse(&quot;Unexpected end of input&quot;))
</a><a href="#h54-0-1" id="h54-0-1" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h55" href="../file/src/sql/testdata/drop_table_error_bare/query.sql.html">src/sql/testdata/drop_table_error_bare/query.sql</a> b/<a href="../file/src/sql/testdata/drop_table_error_bare/query.sql.html">src/sql/testdata/drop_table_error_bare/query.sql</a></b>
<a href="#h55-0" id="h55-0" class="h">@@ -0,0 +1 @@
</a><a href="#h55-0-0" id="h55-0-0" class="i">+DROP TABLE
</a><a href="#h55-0-1" id="h55-0-1" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h56" href="../file/src/sql/testdata/drop_table_error_bare/tokens.html">src/sql/testdata/drop_table_error_bare/tokens</a> b/<a href="../file/src/sql/testdata/drop_table_error_bare/tokens.html">src/sql/testdata/drop_table_error_bare/tokens</a></b>
<a href="#h56-0" id="h56-0" class="h">@@ -0,0 +1,8 @@
</a><a href="#h56-0-0" id="h56-0-0" class="i">+[
</a><a href="#h56-0-1" id="h56-0-1" class="i">+    Keyword(
</a><a href="#h56-0-2" id="h56-0-2" class="i">+        Drop,
</a><a href="#h56-0-3" id="h56-0-3" class="i">+    ),
</a><a href="#h56-0-4" id="h56-0-4" class="i">+    Keyword(
</a><a href="#h56-0-5" id="h56-0-5" class="i">+        Table,
</a><a href="#h56-0-6" id="h56-0-6" class="i">+    ),
</a><a href="#h56-0-7" id="h56-0-7" class="i">+]
</a><a href="#h56-0-8" id="h56-0-8" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h57" href="../file/src/sql/testdata/select_error_bare_as/ast.html">src/sql/testdata/select_error_bare_as/ast</a> b/<a href="../file/src/sql/testdata/select_error_bare_as/ast.html">src/sql/testdata/select_error_bare_as/ast</a></b>
<a href="#h57-0" id="h57-0" class="h">@@ -1 +1 @@
</a><a href="#h57-0-0" id="h57-0-0" class="d">-Err(Parse(&quot;Expected identifier, found ,&quot;))
</a><a href="#h57-0-1" id="h57-0-1" class="d">-\ No newline at end of file
</a><a href="#h57-0-2" id="h57-0-2" class="i">+Err(Parse(&quot;Expected identifier, got ,&quot;))
</a><a href="#h57-0-3" id="h57-0-3" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h58" href="../file/src/sql/testdata/select_error_bare_as/plan.html">src/sql/testdata/select_error_bare_as/plan</a> b/<a href="../file/src/sql/testdata/select_error_bare_as/plan.html">src/sql/testdata/select_error_bare_as/plan</a></b>
<a href="#h58-0" id="h58-0" class="h">@@ -1 +1 @@
</a><a href="#h58-0-0" id="h58-0-0" class="d">-Err(Parse(&quot;Expected identifier, found ,&quot;))
</a><a href="#h58-0-1" id="h58-0-1" class="d">-\ No newline at end of file
</a><a href="#h58-0-2" id="h58-0-2" class="i">+Err(Parse(&quot;Expected identifier, got ,&quot;))
</a><a href="#h58-0-3" id="h58-0-3" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h59" href="../file/src/sql/tests.rs.html">src/sql/tests.rs</a> b/<a href="../file/src/sql/tests.rs.html">src/sql/tests.rs</a></b>
<a href="#h59-0" id="h59-0" class="h">@@ -1,5 +1,6 @@
</a> use super::lexer::{Lexer, Token};
<a href="#h59-0-1" id="h59-0-1" class="d">-use super::{Parser, Plan};
</a><a href="#h59-0-2" id="h59-0-2" class="i">+use super::{Parser, Planner, Storage};
</a><a href="#h59-0-3" id="h59-0-3" class="i">+use crate::kv;
</a> use crate::Error;
 use goldenfile::Mint;
 use std::io::Write;
<a href="#h59-1" id="h59-1" class="h">@@ -9,10 +10,10 @@ macro_rules! test_sql {
</a>     $(
         #[test]
         fn $name() {
<a href="#h59-1-3" id="h59-1-3" class="i">+            let storage = Storage::new(kv::Memory::new());
</a>             let mut mint = Mint::new(format!(&quot;src/sql/testdata/{}&quot;, stringify!($name)));
             write!(mint.new_goldenfile(&quot;query.sql&quot;).unwrap(), &quot;{}&quot;, $sql).unwrap();
 
<a href="#h59-1-7" id="h59-1-7" class="d">-
</a>             let mut f = mint.new_goldenfile(&quot;tokens&quot;).unwrap();
             match Lexer::new($sql).collect::&lt;Result&lt;Vec&lt;Token&gt;, Error&gt;&gt;() {
                 Ok(tokens) =&gt; write!(f, &quot;{:#?}&quot;, tokens).unwrap(),
<a href="#h59-2" id="h59-2" class="h">@@ -24,7 +25,7 @@ macro_rules! test_sql {
</a>             match Parser::new($sql).parse() {
                 Ok(ast) =&gt; {
                     write!(f_ast, &quot;{:#?}&quot;, ast).unwrap();
<a href="#h59-2-3" id="h59-2-3" class="d">-                    match Plan::build(ast) {
</a><a href="#h59-2-4" id="h59-2-4" class="i">+                    match Planner::new(Box::new(storage)).build(ast) {
</a>                         Ok(plan) =&gt; write!(f_plan, &quot;{:#?}&quot;, plan).unwrap(),
                         err =&gt; write!(f_plan, &quot;{:?}&quot;, err).unwrap(),
                     };
<a href="#h59-3" id="h59-3" class="h">@@ -40,6 +41,25 @@ macro_rules! test_sql {
</a> }
 
 test_sql! {
<a href="#h59-3-3" id="h59-3-3" class="i">+    create_table: r#&quot;
</a><a href="#h59-3-4" id="h59-3-4" class="i">+        CREATE TABLE name (
</a><a href="#h59-3-5" id="h59-3-5" class="i">+            id INTEGER PRIMARY KEY,
</a><a href="#h59-3-6" id="h59-3-6" class="i">+            string VARCHAR NOT NULL,
</a><a href="#h59-3-7" id="h59-3-7" class="i">+            text VARCHAR,
</a><a href="#h59-3-8" id="h59-3-8" class="i">+            number INTEGER,
</a><a href="#h59-3-9" id="h59-3-9" class="i">+            decimal FLOAT,
</a><a href="#h59-3-10" id="h59-3-10" class="i">+            bool BOOLEAN NULL
</a><a href="#h59-3-11" id="h59-3-11" class="i">+        )&quot;#,
</a><a href="#h59-3-12" id="h59-3-12" class="i">+    create_table_single_column: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY)&quot;,
</a><a href="#h59-3-13" id="h59-3-13" class="i">+    create_table_error_bare: &quot;CREATE TABLE&quot;,
</a><a href="#h59-3-14" id="h59-3-14" class="i">+    create_table_error_empty_columns: &quot;CREATE TABLE name ()&quot;,
</a><a href="#h59-3-15" id="h59-3-15" class="i">+    create_table_error_no_columns: &quot;CREATE TABLE name&quot;,
</a><a href="#h59-3-16" id="h59-3-16" class="i">+    create_table_error_no_datatype: &quot;CREATE TABLE name (id)&quot;,
</a><a href="#h59-3-17" id="h59-3-17" class="i">+    create_table_error_no_name: &quot;CREATE TABLE (id INTEGER)&quot;,
</a><a href="#h59-3-18" id="h59-3-18" class="i">+    create_table_error_no_primary_key: &quot;CREATE TABLE name (id INTEGER)&quot;,
</a><a href="#h59-3-19" id="h59-3-19" class="i">+    create_table_error_multiple_primary_key: &quot;CREATE TABLE name (id INTEGER PRIMARY KEY, name VARCHAR PRIMARY KEY)&quot;,
</a><a href="#h59-3-20" id="h59-3-20" class="i">+    drop_table: &quot;DROP TABLE name&quot;,
</a><a href="#h59-3-21" id="h59-3-21" class="i">+    drop_table_error_bare: &quot;DROP TABLE&quot;,
</a>     select_alone_aliases: &quot;SELECT 1, 2 b, 3 AS c&quot;,
     select_alone_datatypes: &quot;SELECT NULL, TRUE, FALSE, 1, 3.14, &#39;Hi! 👋&#39;&quot;,
     select_alone_literal_numbers: &quot;SELECT 0, 1, -2, --3, +-4, 3.14, 293, 3.14e3, 2.718E-2&quot;,
<b>diff --git a/<a id="h60" href="../file/src/sql/types.rs.html">src/sql/types.rs</a> b/<a href="../file/src/sql/types.rs.html">src/sql/types.rs</a></b>
<a href="#h60-0" id="h60-0" class="h">@@ -1,3 +1,14 @@
</a><a href="#h60-0-0" id="h60-0-0" class="i">+use serde_derive::{Deserialize, Serialize};
</a><a href="#h60-0-1" id="h60-0-1" class="i">+
</a><a href="#h60-0-2" id="h60-0-2" class="i">+/// A datatype
</a><a href="#h60-0-3" id="h60-0-3" class="i">+#[derive(Clone, Debug, PartialEq, Serialize, Deserialize)]
</a><a href="#h60-0-4" id="h60-0-4" class="i">+pub enum DataType {
</a><a href="#h60-0-5" id="h60-0-5" class="i">+    Boolean,
</a><a href="#h60-0-6" id="h60-0-6" class="i">+    Integer,
</a><a href="#h60-0-7" id="h60-0-7" class="i">+    Float,
</a><a href="#h60-0-8" id="h60-0-8" class="i">+    String,
</a><a href="#h60-0-9" id="h60-0-9" class="i">+}
</a><a href="#h60-0-10" id="h60-0-10" class="i">+
</a> /// A value
 #[derive(Clone, Debug, PartialEq, PartialOrd)]
 pub enum Value {
</pre>
</div>
</body>
</html>
