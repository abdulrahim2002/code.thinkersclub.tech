<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>sql: use hidden columns for HAVING and ORDER BY if needed - toydb - An SQL engine written in Rust
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="toydb.git Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="../logo.png" alt="" width="32" height="32" /></a></td><td><h1>toydb</h1><span class="desc">An SQL engine written in Rust
</span></td></tr><tr class="url"><td></td><td>git clone <a href="https://github.com/erikgrinaker/toydb">https://github.com/erikgrinaker/toydb</a></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/README.md.html">README</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/9d5ace8231ecb4ca1f3a0f61ba55327aadef0378.html">9d5ace8231ecb4ca1f3a0f61ba55327aadef0378</a>
<b>parent</b> <a href="../commit/60e93047f4d4a126735837b411864e5e421f9fdf.html">60e93047f4d4a126735837b411864e5e421f9fdf</a>
<b>Author:</b> Erik Grinaker &lt;<a href="mailto:erik@grinaker.org">erik@grinaker.org</a>&gt;
<b>Date:</b>   Sun, 31 May 2020 17:34:20 +0200

sql: use hidden columns for HAVING and ORDER BY if needed

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">README.md</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">src/sql/plan/planner.rs</a></td><td> | </td><td class="num">123</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">---------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">tests/sql/query.rs</a></td><td> | </td><td class="num">10</td><td><span class="i">+++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">tests/sql/query/group_expr</a></td><td> | </td><td class="num">14</td><td><span class="i">++</span><span class="d">------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">tests/sql/query/group_expr_aggr</a></td><td> | </td><td class="num">14</td><td><span class="i">++</span><span class="d">------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h5">tests/sql/query/group_expr_aggr_selfref</a></td><td> | </td><td class="num">14</td><td><span class="i">++</span><span class="d">------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">tests/sql/query/group_expr_aliased</a></td><td> | </td><td class="num">14</td><td><span class="i">++</span><span class="d">------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">tests/sql/query/group_expr_both</a></td><td> | </td><td class="num">14</td><td><span class="i">++</span><span class="d">------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">tests/sql/query/group_expr_multigroup</a></td><td> | </td><td class="num">28</td><td><span class="i">++++</span><span class="d">------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h9">tests/sql/query/group_expr_select</a></td><td> | </td><td class="num">14</td><td><span class="i">++</span><span class="d">------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h10">tests/sql/query/group_join</a></td><td> | </td><td class="num">18</td><td><span class="i">++</span><span class="d">----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h11">tests/sql/query/group_noaggregate</a></td><td> | </td><td class="num">14</td><td><span class="i">++</span><span class="d">------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h12">tests/sql/query/group_noselect</a></td><td> | </td><td class="num">14</td><td><span class="i">++</span><span class="d">------------</span></td></tr>
<tr><td class="D">D</td><td><a href="#h13">tests/sql/query/group_order_agg</a></td><td> | </td><td class="num">68</td><td><span class="i"></span><span class="d">--------------------------------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h14">tests/sql/query/group_simple</a></td><td> | </td><td class="num">14</td><td><span class="i">++</span><span class="d">------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h15">tests/sql/query/having</a></td><td> | </td><td class="num">28</td><td><span class="i">++++</span><span class="d">------------------------</span></td></tr>
<tr><td class="A">A</td><td><a href="#h16">tests/sql/query/having_aggr</a></td><td> | </td><td class="num">330</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h17">tests/sql/query/having_aggr_expr</a></td><td> | </td><td class="num">395</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h18">tests/sql/query/having_aggr_nested</a></td><td> | </td><td class="num">86</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h19">tests/sql/query/having_noaggr</a></td><td> | </td><td class="num">340</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h20">tests/sql/query/having_nogroup</a></td><td> | </td><td class="num">224</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------</span></td></tr>
<tr><td class="A">A</td><td><a href="#h21">tests/sql/query/having_noselect</a></td><td> | </td><td class="num">263</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h22">tests/sql/query/order_aggregate</a></td><td> | </td><td class="num">213</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h23">tests/sql/query/order_aggregate_noselect</a></td><td> | </td><td class="num">289</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h24">tests/sql/query/order_expr</a></td><td> | </td><td class="num">36</td><td><span class="i">++++++</span><span class="d">------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h25">tests/sql/query/order_field_aliased</a></td><td> | </td><td class="num">28</td><td><span class="i">++++</span><span class="d">------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h26">tests/sql/query/order_field_qualified</a></td><td> | </td><td class="num">376</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-------------------------------</span></td></tr>
<tr><td class="A">A</td><td><a href="#h27">tests/sql/query/order_group_by_noselect</a></td><td> | </td><td class="num">223</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h28">tests/sql/query/order_noselect</a></td><td> | </td><td class="num">214</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
</table></pre><pre>29 files changed, 2868 insertions(+), 552 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/README.md.html">README.md</a> b/<a href="../file/README.md.html">README.md</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -123,5 +123,3 @@ The primary goal is to build a minimally functional yet correct distributed data
</a> ### Query Engine
 
 * **Type checking:** query type checking (e.g. `SELECT a + b` must receive two numbers) is done at query evaluation time, not at query compile time.
<a href="#h0-0-3" id="h0-0-3" class="d">-
</a><a href="#h0-0-4" id="h0-0-4" class="d">-* **Streamed evaluation:** it&#39;s not possible to operate on fields that were not output by a preceding plan node - e.g. it&#39;s only possible to order on `SELECT` output columns.
</a><b>diff --git a/<a id="h1" href="../file/src/sql/plan/planner.rs.html">src/sql/plan/planner.rs</a> b/<a href="../file/src/sql/plan/planner.rs.html">src/sql/plan/planner.rs</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -152,17 +152,40 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>                 };
 
                 // Build SELECT clause.
<a href="#h1-0-3" id="h1-0-3" class="i">+                let mut order = order;
</a><a href="#h1-0-4" id="h1-0-4" class="i">+                let mut having = having.map(|c| c.0);
</a><a href="#h1-0-5" id="h1-0-5" class="i">+                let mut hidden = 0;
</a>                 if !select.expressions.is_empty() {
<a href="#h1-0-7" id="h1-0-7" class="d">-                    let mut exprs = select.expressions;
</a><a href="#h1-0-8" id="h1-0-8" class="i">+                    let mut expressions = select.expressions;
</a><a href="#h1-0-9" id="h1-0-9" class="i">+
</a><a href="#h1-0-10" id="h1-0-10" class="i">+                    // Inject hidden SELECT columns for fields and aggregates used in ORDER BY and
</a><a href="#h1-0-11" id="h1-0-11" class="i">+                    // HAVING expressions but not present in existing SELECT output. These will be
</a><a href="#h1-0-12" id="h1-0-12" class="i">+                    // removed again by a later projection.
</a><a href="#h1-0-13" id="h1-0-13" class="i">+                    if let Some(ref mut expr) = having {
</a><a href="#h1-0-14" id="h1-0-14" class="i">+                        hidden += self.inject_hidden(expr, &amp;mut expressions)?;
</a><a href="#h1-0-15" id="h1-0-15" class="i">+                    }
</a><a href="#h1-0-16" id="h1-0-16" class="i">+                    for (expr, _) in order.iter_mut() {
</a><a href="#h1-0-17" id="h1-0-17" class="i">+                        hidden += self.inject_hidden(expr, &amp;mut expressions)?;
</a><a href="#h1-0-18" id="h1-0-18" class="i">+                    }
</a> 
                     // Extract any aggregate functions and GROUP BY expressions, replacing them with
                     // Column placeholders. Aggregations are handled by evaluating group expressions
                     // and aggregate function arguments in a pre-projection, passing the results
                     // to an aggregation node, and then evaluating the final SELECT expressions
<a href="#h1-0-24" id="h1-0-24" class="d">-                    // in the post-projection. See build_aggregates() for details.
</a><a href="#h1-0-25" id="h1-0-25" class="d">-                    let aggregates = self.extract_aggregates(&amp;mut exprs)?;
</a><a href="#h1-0-26" id="h1-0-26" class="i">+                    // in the post-projection. See build_aggregation() for details. For example:
</a><a href="#h1-0-27" id="h1-0-27" class="i">+                    //
</a><a href="#h1-0-28" id="h1-0-28" class="i">+                    // SELECT (MAX(rating * 100) - MIN(rating * 100)) / 100
</a><a href="#h1-0-29" id="h1-0-29" class="i">+                    // FROM movies
</a><a href="#h1-0-30" id="h1-0-30" class="i">+                    // GROUP BY released - 2000
</a><a href="#h1-0-31" id="h1-0-31" class="i">+                    //
</a><a href="#h1-0-32" id="h1-0-32" class="i">+                    // Results in the following nodes:
</a><a href="#h1-0-33" id="h1-0-33" class="i">+                    //
</a><a href="#h1-0-34" id="h1-0-34" class="i">+                    // - Projection: rating * 100, rating * 100, released - 2000
</a><a href="#h1-0-35" id="h1-0-35" class="i">+                    // - Aggregation: max(#0), min(#1) group by #2
</a><a href="#h1-0-36" id="h1-0-36" class="i">+                    // - Projection: (#0 - #1) / 100
</a><a href="#h1-0-37" id="h1-0-37" class="i">+                    let aggregates = self.extract_aggregates(&amp;mut expressions)?;
</a>                     let groups = if let Some(ast::GroupByClause(group_by)) = group_by {
<a href="#h1-0-39" id="h1-0-39" class="d">-                        self.extract_groups(&amp;mut exprs, group_by, aggregates.len())?
</a><a href="#h1-0-40" id="h1-0-40" class="i">+                        self.extract_groups(&amp;mut expressions, group_by, aggregates.len())?
</a>                     } else {
                         Vec::new()
                     };
<a href="#h1-1" id="h1-1" class="h">@@ -171,7 +194,7 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>                     }
 
                     // Build the remaining non-aggregate projection.
<a href="#h1-1-3" id="h1-1-3" class="d">-                    let expressions: Vec&lt;(Expression, Option&lt;String&gt;)&gt; = exprs
</a><a href="#h1-1-4" id="h1-1-4" class="i">+                    let expressions: Vec&lt;(Expression, Option&lt;String&gt;)&gt; = expressions
</a>                         .into_iter()
                         .map(|(e, l)| Ok((self.build_expression(scope, e)?, l)))
                         .collect::&lt;Result&lt;_&gt;&gt;()?;
<a href="#h1-2" id="h1-2" class="h">@@ -180,7 +203,7 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>                 };
 
                 // Build HAVING clause.
<a href="#h1-2-3" id="h1-2-3" class="d">-                if let Some(ast::HavingClause(expr)) = having {
</a><a href="#h1-2-4" id="h1-2-4" class="i">+                if let Some(expr) = having {
</a>                     node = Node::Filter {
                         source: Box::new(node),
                         predicate: self.build_expression(scope, expr)?,
<a href="#h1-3" id="h1-3" class="h">@@ -188,19 +211,12 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>                 };
 
                 // Build ORDER clause.
<a href="#h1-3-3" id="h1-3-3" class="d">-                // FIXME Because the projection doesn&#39;t retain original table values, we can&#39;t
</a><a href="#h1-3-4" id="h1-3-4" class="d">-                // order by fields which are not in the result set.
</a>                 if !order.is_empty() {
                     node = Node::Order {
                         source: Box::new(node),
                         orders: order
                             .into_iter()
                             .map(|(e, o)| {
<a href="#h1-3-11" id="h1-3-11" class="d">-                                if self.is_aggregate(&amp;e) {
</a><a href="#h1-3-12" id="h1-3-12" class="d">-                                    return Err(Error::Value(
</a><a href="#h1-3-13" id="h1-3-13" class="d">-                                        &quot;Aggregate function not allowed here&quot;.into(),
</a><a href="#h1-3-14" id="h1-3-14" class="d">-                                    ));
</a><a href="#h1-3-15" id="h1-3-15" class="d">-                                }
</a>                                 Ok((
                                     self.build_expression(scope, e)?,
                                     match o {
<a href="#h1-4" id="h1-4" class="h">@@ -234,6 +250,17 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>                         }?,
                     }
                 }
<a href="#h1-4-3" id="h1-4-3" class="i">+
</a><a href="#h1-4-4" id="h1-4-4" class="i">+                // Remove any hidden columns.
</a><a href="#h1-4-5" id="h1-4-5" class="i">+                if hidden &gt; 0 {
</a><a href="#h1-4-6" id="h1-4-6" class="i">+                    node = Node::Projection {
</a><a href="#h1-4-7" id="h1-4-7" class="i">+                        source: Box::new(node),
</a><a href="#h1-4-8" id="h1-4-8" class="i">+                        expressions: (0..(scope.len() - hidden))
</a><a href="#h1-4-9" id="h1-4-9" class="i">+                            .map(|i| (Expression::Field(i, None), None))
</a><a href="#h1-4-10" id="h1-4-10" class="i">+                            .collect(),
</a><a href="#h1-4-11" id="h1-4-11" class="i">+                    }
</a><a href="#h1-4-12" id="h1-4-12" class="i">+                }
</a><a href="#h1-4-13" id="h1-4-13" class="i">+
</a>                 node
             }
         })
<a href="#h1-5" id="h1-5" class="h">@@ -300,7 +327,9 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>         })
     }
 
<a href="#h1-5-3" id="h1-5-3" class="d">-    /// Builds an aggregation node.
</a><a href="#h1-5-4" id="h1-5-4" class="i">+    /// Builds an aggregation node. All aggregate parameters and GROUP BY expressions are evaluated
</a><a href="#h1-5-5" id="h1-5-5" class="i">+    /// in a pre-projection, whose results are fed into an Aggregate node. This node computes the
</a><a href="#h1-5-6" id="h1-5-6" class="i">+    /// aggregates for the given groups, passing the group values through directly.
</a>     fn build_aggregation(
         &amp;self,
         scope: &amp;mut Scope,
<a href="#h1-6" id="h1-6" class="h">@@ -407,6 +436,67 @@ impl&lt;&#39;a, C: Catalog&gt; Planner&lt;&#39;a, C&gt; {
</a>         Ok(groups)
     }
 
<a href="#h1-6-3" id="h1-6-3" class="i">+    /// Injects hidden expressions into SELECT expressions. This is used for ORDER BY and HAVING, in
</a><a href="#h1-6-4" id="h1-6-4" class="i">+    /// order to apply these to fields or aggregates that are not present in the SELECT output, e.g.
</a><a href="#h1-6-5" id="h1-6-5" class="i">+    /// to order on a column that is not selected. This is done by replacing the relevant parts of
</a><a href="#h1-6-6" id="h1-6-6" class="i">+    /// the given expression with Column references to either existing columns or new, hidden
</a><a href="#h1-6-7" id="h1-6-7" class="i">+    /// columns in the select expressions. Returns the number of hidden columns added.
</a><a href="#h1-6-8" id="h1-6-8" class="i">+    fn inject_hidden(
</a><a href="#h1-6-9" id="h1-6-9" class="i">+        &amp;self,
</a><a href="#h1-6-10" id="h1-6-10" class="i">+        expr: &amp;mut ast::Expression,
</a><a href="#h1-6-11" id="h1-6-11" class="i">+        select: &amp;mut Vec&lt;(ast::Expression, Option&lt;String&gt;)&gt;,
</a><a href="#h1-6-12" id="h1-6-12" class="i">+    ) -&gt; Result&lt;usize&gt; {
</a><a href="#h1-6-13" id="h1-6-13" class="i">+        // Replace any identical expressions or label references with column references.
</a><a href="#h1-6-14" id="h1-6-14" class="i">+        for (i, (sexpr, label)) in select.iter().enumerate() {
</a><a href="#h1-6-15" id="h1-6-15" class="i">+            if expr == sexpr {
</a><a href="#h1-6-16" id="h1-6-16" class="i">+                replace(expr, ast::Expression::Column(i));
</a><a href="#h1-6-17" id="h1-6-17" class="i">+                continue;
</a><a href="#h1-6-18" id="h1-6-18" class="i">+            }
</a><a href="#h1-6-19" id="h1-6-19" class="i">+            if let Some(label) = label {
</a><a href="#h1-6-20" id="h1-6-20" class="i">+                expr.replace_with(|expr| {
</a><a href="#h1-6-21" id="h1-6-21" class="i">+                    expr.transform(
</a><a href="#h1-6-22" id="h1-6-22" class="i">+                        &amp;mut |e| match e {
</a><a href="#h1-6-23" id="h1-6-23" class="i">+                            ast::Expression::Field(None, ref l) if l == label =&gt; {
</a><a href="#h1-6-24" id="h1-6-24" class="i">+                                Ok(ast::Expression::Column(i))
</a><a href="#h1-6-25" id="h1-6-25" class="i">+                            }
</a><a href="#h1-6-26" id="h1-6-26" class="i">+                            e =&gt; Ok(e),
</a><a href="#h1-6-27" id="h1-6-27" class="i">+                        },
</a><a href="#h1-6-28" id="h1-6-28" class="i">+                        &amp;mut |e| Ok(e),
</a><a href="#h1-6-29" id="h1-6-29" class="i">+                    )
</a><a href="#h1-6-30" id="h1-6-30" class="i">+                })?;
</a><a href="#h1-6-31" id="h1-6-31" class="i">+            }
</a><a href="#h1-6-32" id="h1-6-32" class="i">+        }
</a><a href="#h1-6-33" id="h1-6-33" class="i">+        // Any remaining aggregate functions and field references must be extracted as hidden
</a><a href="#h1-6-34" id="h1-6-34" class="i">+        // columns.
</a><a href="#h1-6-35" id="h1-6-35" class="i">+        let mut hidden = 0;
</a><a href="#h1-6-36" id="h1-6-36" class="i">+        expr.replace_with(|expr| {
</a><a href="#h1-6-37" id="h1-6-37" class="i">+            expr.transform(
</a><a href="#h1-6-38" id="h1-6-38" class="i">+                &amp;mut |e| match &amp;e {
</a><a href="#h1-6-39" id="h1-6-39" class="i">+                    ast::Expression::Function(f, a) if self.aggregate_from_name(f).is_some() =&gt; {
</a><a href="#h1-6-40" id="h1-6-40" class="i">+                        if let ast::Expression::Column(c) = a[0] {
</a><a href="#h1-6-41" id="h1-6-41" class="i">+                            if self.is_aggregate(&amp;select[c].0) {
</a><a href="#h1-6-42" id="h1-6-42" class="i">+                                return Err(Error::Value(
</a><a href="#h1-6-43" id="h1-6-43" class="i">+                                    &quot;Aggregate function cannot reference aggregate&quot;.into(),
</a><a href="#h1-6-44" id="h1-6-44" class="i">+                                ));
</a><a href="#h1-6-45" id="h1-6-45" class="i">+                            }
</a><a href="#h1-6-46" id="h1-6-46" class="i">+                        }
</a><a href="#h1-6-47" id="h1-6-47" class="i">+                        select.push((e, None));
</a><a href="#h1-6-48" id="h1-6-48" class="i">+                        hidden += 1;
</a><a href="#h1-6-49" id="h1-6-49" class="i">+                        Ok(ast::Expression::Column(select.len() - 1))
</a><a href="#h1-6-50" id="h1-6-50" class="i">+                    }
</a><a href="#h1-6-51" id="h1-6-51" class="i">+                    ast::Expression::Field(_, _) =&gt; {
</a><a href="#h1-6-52" id="h1-6-52" class="i">+                        select.push((e, None));
</a><a href="#h1-6-53" id="h1-6-53" class="i">+                        hidden += 1;
</a><a href="#h1-6-54" id="h1-6-54" class="i">+                        Ok(ast::Expression::Column(select.len() - 1))
</a><a href="#h1-6-55" id="h1-6-55" class="i">+                    }
</a><a href="#h1-6-56" id="h1-6-56" class="i">+                    _ =&gt; Ok(e),
</a><a href="#h1-6-57" id="h1-6-57" class="i">+                },
</a><a href="#h1-6-58" id="h1-6-58" class="i">+                &amp;mut |e| Ok(e),
</a><a href="#h1-6-59" id="h1-6-59" class="i">+            )
</a><a href="#h1-6-60" id="h1-6-60" class="i">+        })?;
</a><a href="#h1-6-61" id="h1-6-61" class="i">+        Ok(hidden)
</a><a href="#h1-6-62" id="h1-6-62" class="i">+    }
</a><a href="#h1-6-63" id="h1-6-63" class="i">+
</a>     /// Returns the aggregate corresponding to the given aggregate function name.
     fn aggregate_from_name(&amp;self, name: &amp;str) -&gt; Option&lt;Aggregate&gt; {
         match name {
<a href="#h1-7" id="h1-7" class="h">@@ -663,6 +753,11 @@ impl Scope {
</a>         }
     }
 
<a href="#h1-7-3" id="h1-7-3" class="i">+    /// Number of columns in the current scope.
</a><a href="#h1-7-4" id="h1-7-4" class="i">+    fn len(&amp;self) -&gt; usize {
</a><a href="#h1-7-5" id="h1-7-5" class="i">+        self.columns.len()
</a><a href="#h1-7-6" id="h1-7-6" class="i">+    }
</a><a href="#h1-7-7" id="h1-7-7" class="i">+
</a>     /// Projects the scope. This takes a set of expressions and labels in the current scope,
     /// and returns a new scope for the projection.
     fn project(&amp;mut self, projection: &amp;[(Expression, Option&lt;String&gt;)]) -&gt; Result&lt;()&gt; {
<b>diff --git a/<a id="h2" href="../file/tests/sql/query.rs.html">tests/sql/query.rs</a> b/<a href="../file/tests/sql/query.rs.html">tests/sql/query.rs</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -208,12 +208,16 @@ test_query! {
</a>     order_desc_lowercase: &quot;SELECT * FROM movies ORDER BY released desc&quot;,
     order_expr: &quot;SELECT id, title, released, released % 4 AS ord FROM movies ORDER BY released % 4 ASC&quot;,
     order_multi: &quot;SELECT * FROM movies ORDER BY ultrahd ASC, id DESC&quot;,
<a href="#h2-0-3" id="h2-0-3" class="i">+    order_noselect: &quot;SELECT id, title FROM movies ORDER BY released&quot;,
</a>     order_unknown_dir: &quot;SELECT * FROM movies ORDER BY id X&quot;,
     order_field_unknown: &quot;SELECT * FROM movies ORDER BY unknown&quot;,
     order_field_qualified: &quot;SELECT movies.id, title, name FROM movies, genres WHERE movies.genre_id = genres.id ORDER BY genres.name, movies.title&quot;,
     order_field_aliased: &quot;SELECT movies.id, title, genres.name AS genre FROM movies, genres WHERE movies.genre_id = genres.id ORDER BY genre, title&quot;,
     order_field_ambiguous: &quot;SELECT * FROM movies, genres WHERE movies.genre_id = genres.id ORDER BY id&quot;,
     order_trailing_comma: &quot;SELECT * FROM movies ORDER BY id,&quot;,
<a href="#h2-0-10" id="h2-0-10" class="i">+    order_aggregate: &quot;SELECT studio_id, MAX(rating) FROM movies GROUP BY studio_id ORDER BY MAX(rating)&quot;,
</a><a href="#h2-0-11" id="h2-0-11" class="i">+    order_aggregate_noselect: &quot;SELECT studio_id, MAX(rating) FROM movies GROUP BY studio_id ORDER BY MIN(rating)&quot;,
</a><a href="#h2-0-12" id="h2-0-12" class="i">+    order_group_by_noselect: &quot;SELECT MAX(rating) FROM movies GROUP BY studio_id ORDER BY studio_id&quot;,
</a> }
 test_query! { with [
         &quot;CREATE TABLE booleans (id INTEGER PRIMARY KEY, value BOOLEAN)&quot;,
<a href="#h2-1" id="h2-1" class="h">@@ -361,7 +365,6 @@ test_query! {
</a>     group_noaggregate: &quot;SELECT title FROM movies GROUP BY title ORDER BY title ASC&quot;,
     group_unknown: &quot;SELECT COUNT(*) FROM movies GROUP BY unknown&quot;,
     group_join: &quot;SELECT s.name, COUNT(*) FROM movies m JOIN studios s ON m.studio_id = s.id GROUP BY s.name ORDER BY s.name ASC&quot;,
<a href="#h2-1-3" id="h2-1-3" class="d">-    group_order_agg: &quot;SELECT studio_id, MAX(rating) FROM movies GROUP BY studio_id ORDER BY MAX(rating)&quot;,
</a>     group_expr: &quot;SELECT MAX(rating) AS rating FROM movies GROUP BY studio_id * 2 ORDER BY rating&quot;,
     group_expr_aliased: &quot;SELECT studio_id * 2 AS twice, MAX(rating) FROM movies GROUP BY twice ORDER BY twice&quot;,
     group_expr_both: &quot;SELECT studio_id * 2, MAX(rating) AS rating FROM movies GROUP BY studio_id * 2 ORDER BY rating&quot;,
<a href="#h2-2" id="h2-2" class="h">@@ -373,5 +376,10 @@ test_query! {
</a>     group_expr_multigroup: &quot;SELECT studio_id + genre_id AS multi, MAX(rating) AS rating FROM movies GROUP BY studio_id, genre_id ORDER BY rating, multi&quot;,
 
     having: &quot;SELECT studio_id, MAX(rating) AS rating FROM movies GROUP BY studio_id HAVING rating &gt; 8 ORDER BY studio_id&quot;,
<a href="#h2-2-3" id="h2-2-3" class="i">+    having_aggr: &quot;SELECT studio_id, MAX(rating) FROM movies GROUP BY studio_id HAVING MIN(rating) &gt; 7 ORDER BY studio_id&quot;,
</a><a href="#h2-2-4" id="h2-2-4" class="i">+    having_aggr_expr: &quot;SELECT studio_id, MAX(rating) FROM movies GROUP BY studio_id HAVING MAX(rating) - MIN(rating) &lt; 1 ORDER BY studio_id&quot;,
</a><a href="#h2-2-5" id="h2-2-5" class="i">+    having_aggr_nested: &quot;SELECT studio_id, MAX(rating) AS best FROM movies GROUP BY studio_id HAVING MIN(best) &gt; 7 ORDER BY studio_id&quot;,
</a>     having_nogroup: &quot;SELECT id, rating FROM movies HAVING rating &gt; 8 ORDER BY id&quot;,
<a href="#h2-2-7" id="h2-2-7" class="i">+    having_noselect: &quot;SELECT studio_id FROM movies GROUP BY studio_id HAVING MAX(rating) &gt; 8 ORDER BY studio_id&quot;,
</a><a href="#h2-2-8" id="h2-2-8" class="i">+    having_noaggr: &quot;SELECT studio_id, MAX(rating) AS rating FROM movies GROUP BY studio_id HAVING studio_id &gt;= 3 ORDER BY studio_id&quot;,
</a> }
<b>diff --git a/<a id="h3" href="../file/tests/sql/query/group_expr.html">tests/sql/query/group_expr</a> b/<a href="../file/tests/sql/query/group_expr.html">tests/sql/query/group_expr</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -127,12 +127,7 @@ Plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h3-0-3" id="h3-0-3" class="d">-                    Some(
</a><a href="#h3-0-4" id="h3-0-4" class="d">-                        (
</a><a href="#h3-0-5" id="h3-0-5" class="d">-                            None,
</a><a href="#h3-0-6" id="h3-0-6" class="d">-                            &quot;rating&quot;,
</a><a href="#h3-0-7" id="h3-0-7" class="d">-                        ),
</a><a href="#h3-0-8" id="h3-0-8" class="d">-                    ),
</a><a href="#h3-0-9" id="h3-0-9" class="i">+                    None,
</a>                 ),
                 Ascending,
             ),
<a href="#h3-1" id="h3-1" class="h">@@ -204,12 +199,7 @@ Optimized plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h3-1-3" id="h3-1-3" class="d">-                    Some(
</a><a href="#h3-1-4" id="h3-1-4" class="d">-                        (
</a><a href="#h3-1-5" id="h3-1-5" class="d">-                            None,
</a><a href="#h3-1-6" id="h3-1-6" class="d">-                            &quot;rating&quot;,
</a><a href="#h3-1-7" id="h3-1-7" class="d">-                        ),
</a><a href="#h3-1-8" id="h3-1-8" class="d">-                    ),
</a><a href="#h3-1-9" id="h3-1-9" class="i">+                    None,
</a>                 ),
                 Ascending,
             ),
<b>diff --git a/<a id="h4" href="../file/tests/sql/query/group_expr_aggr.html">tests/sql/query/group_expr_aggr</a> b/<a href="../file/tests/sql/query/group_expr_aggr.html">tests/sql/query/group_expr_aggr</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -166,12 +166,7 @@ Plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h4-0-3" id="h4-0-3" class="d">-                    Some(
</a><a href="#h4-0-4" id="h4-0-4" class="d">-                        (
</a><a href="#h4-0-5" id="h4-0-5" class="d">-                            None,
</a><a href="#h4-0-6" id="h4-0-6" class="d">-                            &quot;studio_id&quot;,
</a><a href="#h4-0-7" id="h4-0-7" class="d">-                        ),
</a><a href="#h4-0-8" id="h4-0-8" class="d">-                    ),
</a><a href="#h4-0-9" id="h4-0-9" class="i">+                    None,
</a>                 ),
                 Ascending,
             ),
<a href="#h4-1" id="h4-1" class="h">@@ -263,12 +258,7 @@ Optimized plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h4-1-3" id="h4-1-3" class="d">-                    Some(
</a><a href="#h4-1-4" id="h4-1-4" class="d">-                        (
</a><a href="#h4-1-5" id="h4-1-5" class="d">-                            None,
</a><a href="#h4-1-6" id="h4-1-6" class="d">-                            &quot;studio_id&quot;,
</a><a href="#h4-1-7" id="h4-1-7" class="d">-                        ),
</a><a href="#h4-1-8" id="h4-1-8" class="d">-                    ),
</a><a href="#h4-1-9" id="h4-1-9" class="i">+                    None,
</a>                 ),
                 Ascending,
             ),
<b>diff --git a/<a id="h5" href="../file/tests/sql/query/group_expr_aggr_selfref.html">tests/sql/query/group_expr_aggr_selfref</a> b/<a href="../file/tests/sql/query/group_expr_aggr_selfref.html">tests/sql/query/group_expr_aggr_selfref</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -185,12 +185,7 @@ Plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h5-0-3" id="h5-0-3" class="d">-                    Some(
</a><a href="#h5-0-4" id="h5-0-4" class="d">-                        (
</a><a href="#h5-0-5" id="h5-0-5" class="d">-                            None,
</a><a href="#h5-0-6" id="h5-0-6" class="d">-                            &quot;studio_id&quot;,
</a><a href="#h5-0-7" id="h5-0-7" class="d">-                        ),
</a><a href="#h5-0-8" id="h5-0-8" class="d">-                    ),
</a><a href="#h5-0-9" id="h5-0-9" class="i">+                    None,
</a>                 ),
                 Ascending,
             ),
<a href="#h5-1" id="h5-1" class="h">@@ -293,12 +288,7 @@ Optimized plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h5-1-3" id="h5-1-3" class="d">-                    Some(
</a><a href="#h5-1-4" id="h5-1-4" class="d">-                        (
</a><a href="#h5-1-5" id="h5-1-5" class="d">-                            None,
</a><a href="#h5-1-6" id="h5-1-6" class="d">-                            &quot;studio_id&quot;,
</a><a href="#h5-1-7" id="h5-1-7" class="d">-                        ),
</a><a href="#h5-1-8" id="h5-1-8" class="d">-                    ),
</a><a href="#h5-1-9" id="h5-1-9" class="i">+                    None,
</a>                 ),
                 Ascending,
             ),
<b>diff --git a/<a id="h6" href="../file/tests/sql/query/group_expr_aliased.html">tests/sql/query/group_expr_aliased</a> b/<a href="../file/tests/sql/query/group_expr_aliased.html">tests/sql/query/group_expr_aliased</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -143,12 +143,7 @@ Plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h6-0-3" id="h6-0-3" class="d">-                    Some(
</a><a href="#h6-0-4" id="h6-0-4" class="d">-                        (
</a><a href="#h6-0-5" id="h6-0-5" class="d">-                            None,
</a><a href="#h6-0-6" id="h6-0-6" class="d">-                            &quot;twice&quot;,
</a><a href="#h6-0-7" id="h6-0-7" class="d">-                        ),
</a><a href="#h6-0-8" id="h6-0-8" class="d">-                    ),
</a><a href="#h6-0-9" id="h6-0-9" class="i">+                    None,
</a>                 ),
                 Ascending,
             ),
<a href="#h6-1" id="h6-1" class="h">@@ -229,12 +224,7 @@ Optimized plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h6-1-3" id="h6-1-3" class="d">-                    Some(
</a><a href="#h6-1-4" id="h6-1-4" class="d">-                        (
</a><a href="#h6-1-5" id="h6-1-5" class="d">-                            None,
</a><a href="#h6-1-6" id="h6-1-6" class="d">-                            &quot;twice&quot;,
</a><a href="#h6-1-7" id="h6-1-7" class="d">-                        ),
</a><a href="#h6-1-8" id="h6-1-8" class="d">-                    ),
</a><a href="#h6-1-9" id="h6-1-9" class="i">+                    None,
</a>                 ),
                 Ascending,
             ),
<b>diff --git a/<a id="h7" href="../file/tests/sql/query/group_expr_both.html">tests/sql/query/group_expr_both</a> b/<a href="../file/tests/sql/query/group_expr_both.html">tests/sql/query/group_expr_both</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -150,12 +150,7 @@ Plan: Plan(
</a>             (
                 Field(
                     1,
<a href="#h7-0-3" id="h7-0-3" class="d">-                    Some(
</a><a href="#h7-0-4" id="h7-0-4" class="d">-                        (
</a><a href="#h7-0-5" id="h7-0-5" class="d">-                            None,
</a><a href="#h7-0-6" id="h7-0-6" class="d">-                            &quot;rating&quot;,
</a><a href="#h7-0-7" id="h7-0-7" class="d">-                        ),
</a><a href="#h7-0-8" id="h7-0-8" class="d">-                    ),
</a><a href="#h7-0-9" id="h7-0-9" class="i">+                    None,
</a>                 ),
                 Ascending,
             ),
<a href="#h7-1" id="h7-1" class="h">@@ -234,12 +229,7 @@ Optimized plan: Plan(
</a>             (
                 Field(
                     1,
<a href="#h7-1-3" id="h7-1-3" class="d">-                    Some(
</a><a href="#h7-1-4" id="h7-1-4" class="d">-                        (
</a><a href="#h7-1-5" id="h7-1-5" class="d">-                            None,
</a><a href="#h7-1-6" id="h7-1-6" class="d">-                            &quot;rating&quot;,
</a><a href="#h7-1-7" id="h7-1-7" class="d">-                        ),
</a><a href="#h7-1-8" id="h7-1-8" class="d">-                    ),
</a><a href="#h7-1-9" id="h7-1-9" class="i">+                    None,
</a>                 ),
                 Ascending,
             ),
<b>diff --git a/<a id="h8" href="../file/tests/sql/query/group_expr_multigroup.html">tests/sql/query/group_expr_multigroup</a> b/<a href="../file/tests/sql/query/group_expr_multigroup.html">tests/sql/query/group_expr_multigroup</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -176,24 +176,14 @@ Plan: Plan(
</a>             (
                 Field(
                     1,
<a href="#h8-0-3" id="h8-0-3" class="d">-                    Some(
</a><a href="#h8-0-4" id="h8-0-4" class="d">-                        (
</a><a href="#h8-0-5" id="h8-0-5" class="d">-                            None,
</a><a href="#h8-0-6" id="h8-0-6" class="d">-                            &quot;rating&quot;,
</a><a href="#h8-0-7" id="h8-0-7" class="d">-                        ),
</a><a href="#h8-0-8" id="h8-0-8" class="d">-                    ),
</a><a href="#h8-0-9" id="h8-0-9" class="i">+                    None,
</a>                 ),
                 Ascending,
             ),
             (
                 Field(
                     0,
<a href="#h8-0-16" id="h8-0-16" class="d">-                    Some(
</a><a href="#h8-0-17" id="h8-0-17" class="d">-                        (
</a><a href="#h8-0-18" id="h8-0-18" class="d">-                            None,
</a><a href="#h8-0-19" id="h8-0-19" class="d">-                            &quot;multi&quot;,
</a><a href="#h8-0-20" id="h8-0-20" class="d">-                        ),
</a><a href="#h8-0-21" id="h8-0-21" class="d">-                    ),
</a><a href="#h8-0-22" id="h8-0-22" class="i">+                    None,
</a>                 ),
                 Ascending,
             ),
<a href="#h8-1" id="h8-1" class="h">@@ -295,24 +285,14 @@ Optimized plan: Plan(
</a>             (
                 Field(
                     1,
<a href="#h8-1-3" id="h8-1-3" class="d">-                    Some(
</a><a href="#h8-1-4" id="h8-1-4" class="d">-                        (
</a><a href="#h8-1-5" id="h8-1-5" class="d">-                            None,
</a><a href="#h8-1-6" id="h8-1-6" class="d">-                            &quot;rating&quot;,
</a><a href="#h8-1-7" id="h8-1-7" class="d">-                        ),
</a><a href="#h8-1-8" id="h8-1-8" class="d">-                    ),
</a><a href="#h8-1-9" id="h8-1-9" class="i">+                    None,
</a>                 ),
                 Ascending,
             ),
             (
                 Field(
                     0,
<a href="#h8-1-16" id="h8-1-16" class="d">-                    Some(
</a><a href="#h8-1-17" id="h8-1-17" class="d">-                        (
</a><a href="#h8-1-18" id="h8-1-18" class="d">-                            None,
</a><a href="#h8-1-19" id="h8-1-19" class="d">-                            &quot;multi&quot;,
</a><a href="#h8-1-20" id="h8-1-20" class="d">-                        ),
</a><a href="#h8-1-21" id="h8-1-21" class="d">-                    ),
</a><a href="#h8-1-22" id="h8-1-22" class="i">+                    None,
</a>                 ),
                 Ascending,
             ),
<b>diff --git a/<a id="h9" href="../file/tests/sql/query/group_expr_select.html">tests/sql/query/group_expr_select</a> b/<a href="../file/tests/sql/query/group_expr_select.html">tests/sql/query/group_expr_select</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -146,12 +146,7 @@ Plan: Plan(
</a>             (
                 Field(
                     1,
<a href="#h9-0-3" id="h9-0-3" class="d">-                    Some(
</a><a href="#h9-0-4" id="h9-0-4" class="d">-                        (
</a><a href="#h9-0-5" id="h9-0-5" class="d">-                            None,
</a><a href="#h9-0-6" id="h9-0-6" class="d">-                            &quot;rating&quot;,
</a><a href="#h9-0-7" id="h9-0-7" class="d">-                        ),
</a><a href="#h9-0-8" id="h9-0-8" class="d">-                    ),
</a><a href="#h9-0-9" id="h9-0-9" class="i">+                    None,
</a>                 ),
                 Ascending,
             ),
<a href="#h9-1" id="h9-1" class="h">@@ -235,12 +230,7 @@ Optimized plan: Plan(
</a>             (
                 Field(
                     1,
<a href="#h9-1-3" id="h9-1-3" class="d">-                    Some(
</a><a href="#h9-1-4" id="h9-1-4" class="d">-                        (
</a><a href="#h9-1-5" id="h9-1-5" class="d">-                            None,
</a><a href="#h9-1-6" id="h9-1-6" class="d">-                            &quot;rating&quot;,
</a><a href="#h9-1-7" id="h9-1-7" class="d">-                        ),
</a><a href="#h9-1-8" id="h9-1-8" class="d">-                    ),
</a><a href="#h9-1-9" id="h9-1-9" class="i">+                    None,
</a>                 ),
                 Ascending,
             ),
<b>diff --git a/<a id="h10" href="../file/tests/sql/query/group_join.html">tests/sql/query/group_join</a> b/<a href="../file/tests/sql/query/group_join.html">tests/sql/query/group_join</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -194,14 +194,7 @@ Plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h10-0-3" id="h10-0-3" class="d">-                    Some(
</a><a href="#h10-0-4" id="h10-0-4" class="d">-                        (
</a><a href="#h10-0-5" id="h10-0-5" class="d">-                            Some(
</a><a href="#h10-0-6" id="h10-0-6" class="d">-                                &quot;s&quot;,
</a><a href="#h10-0-7" id="h10-0-7" class="d">-                            ),
</a><a href="#h10-0-8" id="h10-0-8" class="d">-                            &quot;name&quot;,
</a><a href="#h10-0-9" id="h10-0-9" class="d">-                        ),
</a><a href="#h10-0-10" id="h10-0-10" class="d">-                    ),
</a><a href="#h10-0-11" id="h10-0-11" class="i">+                    None,
</a>                 ),
                 Ascending,
             ),
<a href="#h10-1" id="h10-1" class="h">@@ -308,14 +301,7 @@ Optimized plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h10-1-3" id="h10-1-3" class="d">-                    Some(
</a><a href="#h10-1-4" id="h10-1-4" class="d">-                        (
</a><a href="#h10-1-5" id="h10-1-5" class="d">-                            Some(
</a><a href="#h10-1-6" id="h10-1-6" class="d">-                                &quot;s&quot;,
</a><a href="#h10-1-7" id="h10-1-7" class="d">-                            ),
</a><a href="#h10-1-8" id="h10-1-8" class="d">-                            &quot;name&quot;,
</a><a href="#h10-1-9" id="h10-1-9" class="d">-                        ),
</a><a href="#h10-1-10" id="h10-1-10" class="d">-                    ),
</a><a href="#h10-1-11" id="h10-1-11" class="i">+                    None,
</a>                 ),
                 Ascending,
             ),
<b>diff --git a/<a id="h11" href="../file/tests/sql/query/group_noaggregate.html">tests/sql/query/group_noaggregate</a> b/<a href="../file/tests/sql/query/group_noaggregate.html">tests/sql/query/group_noaggregate</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -88,12 +88,7 @@ Plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h11-0-3" id="h11-0-3" class="d">-                    Some(
</a><a href="#h11-0-4" id="h11-0-4" class="d">-                        (
</a><a href="#h11-0-5" id="h11-0-5" class="d">-                            None,
</a><a href="#h11-0-6" id="h11-0-6" class="d">-                            &quot;title&quot;,
</a><a href="#h11-0-7" id="h11-0-7" class="d">-                        ),
</a><a href="#h11-0-8" id="h11-0-8" class="d">-                    ),
</a><a href="#h11-0-9" id="h11-0-9" class="i">+                    None,
</a>                 ),
                 Ascending,
             ),
<a href="#h11-1" id="h11-1" class="h">@@ -142,12 +137,7 @@ Optimized plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h11-1-3" id="h11-1-3" class="d">-                    Some(
</a><a href="#h11-1-4" id="h11-1-4" class="d">-                        (
</a><a href="#h11-1-5" id="h11-1-5" class="d">-                            None,
</a><a href="#h11-1-6" id="h11-1-6" class="d">-                            &quot;title&quot;,
</a><a href="#h11-1-7" id="h11-1-7" class="d">-                        ),
</a><a href="#h11-1-8" id="h11-1-8" class="d">-                    ),
</a><a href="#h11-1-9" id="h11-1-9" class="i">+                    None,
</a>                 ),
                 Ascending,
             ),
<b>diff --git a/<a id="h12" href="../file/tests/sql/query/group_noselect.html">tests/sql/query/group_noselect</a> b/<a href="../file/tests/sql/query/group_noselect.html">tests/sql/query/group_noselect</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -111,12 +111,7 @@ Plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h12-0-3" id="h12-0-3" class="d">-                    Some(
</a><a href="#h12-0-4" id="h12-0-4" class="d">-                        (
</a><a href="#h12-0-5" id="h12-0-5" class="d">-                            None,
</a><a href="#h12-0-6" id="h12-0-6" class="d">-                            &quot;best&quot;,
</a><a href="#h12-0-7" id="h12-0-7" class="d">-                        ),
</a><a href="#h12-0-8" id="h12-0-8" class="d">-                    ),
</a><a href="#h12-0-9" id="h12-0-9" class="i">+                    None,
</a>                 ),
                 Descending,
             ),
<a href="#h12-1" id="h12-1" class="h">@@ -181,12 +176,7 @@ Optimized plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h12-1-3" id="h12-1-3" class="d">-                    Some(
</a><a href="#h12-1-4" id="h12-1-4" class="d">-                        (
</a><a href="#h12-1-5" id="h12-1-5" class="d">-                            None,
</a><a href="#h12-1-6" id="h12-1-6" class="d">-                            &quot;best&quot;,
</a><a href="#h12-1-7" id="h12-1-7" class="d">-                        ),
</a><a href="#h12-1-8" id="h12-1-8" class="d">-                    ),
</a><a href="#h12-1-9" id="h12-1-9" class="i">+                    None,
</a>                 ),
                 Descending,
             ),
<b>diff --git a/<a id="h13" href="../file/tests/sql/query/group_order_agg.html">tests/sql/query/group_order_agg</a> b/<a href="../file/tests/sql/query/group_order_agg.html">tests/sql/query/group_order_agg</a></b>
<a href="#h13-0" id="h13-0" class="h">@@ -1,67 +0,0 @@
</a><a href="#h13-0-0" id="h13-0-0" class="d">-Query: SELECT studio_id, MAX(rating) FROM movies GROUP BY studio_id ORDER BY MAX(rating)
</a><a href="#h13-0-1" id="h13-0-1" class="d">-
</a><a href="#h13-0-2" id="h13-0-2" class="d">-AST: Select {
</a><a href="#h13-0-3" id="h13-0-3" class="d">-    select: SelectClause {
</a><a href="#h13-0-4" id="h13-0-4" class="d">-        expressions: [
</a><a href="#h13-0-5" id="h13-0-5" class="d">-            (
</a><a href="#h13-0-6" id="h13-0-6" class="d">-                Field(
</a><a href="#h13-0-7" id="h13-0-7" class="d">-                    None,
</a><a href="#h13-0-8" id="h13-0-8" class="d">-                    &quot;studio_id&quot;,
</a><a href="#h13-0-9" id="h13-0-9" class="d">-                ),
</a><a href="#h13-0-10" id="h13-0-10" class="d">-                None,
</a><a href="#h13-0-11" id="h13-0-11" class="d">-            ),
</a><a href="#h13-0-12" id="h13-0-12" class="d">-            (
</a><a href="#h13-0-13" id="h13-0-13" class="d">-                Function(
</a><a href="#h13-0-14" id="h13-0-14" class="d">-                    &quot;max&quot;,
</a><a href="#h13-0-15" id="h13-0-15" class="d">-                    [
</a><a href="#h13-0-16" id="h13-0-16" class="d">-                        Field(
</a><a href="#h13-0-17" id="h13-0-17" class="d">-                            None,
</a><a href="#h13-0-18" id="h13-0-18" class="d">-                            &quot;rating&quot;,
</a><a href="#h13-0-19" id="h13-0-19" class="d">-                        ),
</a><a href="#h13-0-20" id="h13-0-20" class="d">-                    ],
</a><a href="#h13-0-21" id="h13-0-21" class="d">-                ),
</a><a href="#h13-0-22" id="h13-0-22" class="d">-                None,
</a><a href="#h13-0-23" id="h13-0-23" class="d">-            ),
</a><a href="#h13-0-24" id="h13-0-24" class="d">-        ],
</a><a href="#h13-0-25" id="h13-0-25" class="d">-    },
</a><a href="#h13-0-26" id="h13-0-26" class="d">-    from: Some(
</a><a href="#h13-0-27" id="h13-0-27" class="d">-        FromClause {
</a><a href="#h13-0-28" id="h13-0-28" class="d">-            items: [
</a><a href="#h13-0-29" id="h13-0-29" class="d">-                Table {
</a><a href="#h13-0-30" id="h13-0-30" class="d">-                    name: &quot;movies&quot;,
</a><a href="#h13-0-31" id="h13-0-31" class="d">-                    alias: None,
</a><a href="#h13-0-32" id="h13-0-32" class="d">-                },
</a><a href="#h13-0-33" id="h13-0-33" class="d">-            ],
</a><a href="#h13-0-34" id="h13-0-34" class="d">-        },
</a><a href="#h13-0-35" id="h13-0-35" class="d">-    ),
</a><a href="#h13-0-36" id="h13-0-36" class="d">-    where: None,
</a><a href="#h13-0-37" id="h13-0-37" class="d">-    group_by: Some(
</a><a href="#h13-0-38" id="h13-0-38" class="d">-        GroupByClause(
</a><a href="#h13-0-39" id="h13-0-39" class="d">-            [
</a><a href="#h13-0-40" id="h13-0-40" class="d">-                Field(
</a><a href="#h13-0-41" id="h13-0-41" class="d">-                    None,
</a><a href="#h13-0-42" id="h13-0-42" class="d">-                    &quot;studio_id&quot;,
</a><a href="#h13-0-43" id="h13-0-43" class="d">-                ),
</a><a href="#h13-0-44" id="h13-0-44" class="d">-            ],
</a><a href="#h13-0-45" id="h13-0-45" class="d">-        ),
</a><a href="#h13-0-46" id="h13-0-46" class="d">-    ),
</a><a href="#h13-0-47" id="h13-0-47" class="d">-    having: None,
</a><a href="#h13-0-48" id="h13-0-48" class="d">-    order: [
</a><a href="#h13-0-49" id="h13-0-49" class="d">-        (
</a><a href="#h13-0-50" id="h13-0-50" class="d">-            Function(
</a><a href="#h13-0-51" id="h13-0-51" class="d">-                &quot;max&quot;,
</a><a href="#h13-0-52" id="h13-0-52" class="d">-                [
</a><a href="#h13-0-53" id="h13-0-53" class="d">-                    Field(
</a><a href="#h13-0-54" id="h13-0-54" class="d">-                        None,
</a><a href="#h13-0-55" id="h13-0-55" class="d">-                        &quot;rating&quot;,
</a><a href="#h13-0-56" id="h13-0-56" class="d">-                    ),
</a><a href="#h13-0-57" id="h13-0-57" class="d">-                ],
</a><a href="#h13-0-58" id="h13-0-58" class="d">-            ),
</a><a href="#h13-0-59" id="h13-0-59" class="d">-            Ascending,
</a><a href="#h13-0-60" id="h13-0-60" class="d">-        ),
</a><a href="#h13-0-61" id="h13-0-61" class="d">-    ],
</a><a href="#h13-0-62" id="h13-0-62" class="d">-    offset: None,
</a><a href="#h13-0-63" id="h13-0-63" class="d">-    limit: None,
</a><a href="#h13-0-64" id="h13-0-64" class="d">-}
</a><a href="#h13-0-65" id="h13-0-65" class="d">-
</a><a href="#h13-0-66" id="h13-0-66" class="d">-Plan: Value(&quot;Aggregate function not allowed here&quot;)
</a><a href="#h13-0-67" id="h13-0-67" class="d">-\ No newline at end of file
</a><b>diff --git a/<a id="h14" href="../file/tests/sql/query/group_simple.html">tests/sql/query/group_simple</a> b/<a href="../file/tests/sql/query/group_simple.html">tests/sql/query/group_simple</a></b>
<a href="#h14-0" id="h14-0" class="h">@@ -121,12 +121,7 @@ Plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h14-0-3" id="h14-0-3" class="d">-                    Some(
</a><a href="#h14-0-4" id="h14-0-4" class="d">-                        (
</a><a href="#h14-0-5" id="h14-0-5" class="d">-                            None,
</a><a href="#h14-0-6" id="h14-0-6" class="d">-                            &quot;studio_id&quot;,
</a><a href="#h14-0-7" id="h14-0-7" class="d">-                        ),
</a><a href="#h14-0-8" id="h14-0-8" class="d">-                    ),
</a><a href="#h14-0-9" id="h14-0-9" class="i">+                    None,
</a>                 ),
                 Ascending,
             ),
<a href="#h14-1" id="h14-1" class="h">@@ -196,12 +191,7 @@ Optimized plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h14-1-3" id="h14-1-3" class="d">-                    Some(
</a><a href="#h14-1-4" id="h14-1-4" class="d">-                        (
</a><a href="#h14-1-5" id="h14-1-5" class="d">-                            None,
</a><a href="#h14-1-6" id="h14-1-6" class="d">-                            &quot;studio_id&quot;,
</a><a href="#h14-1-7" id="h14-1-7" class="d">-                        ),
</a><a href="#h14-1-8" id="h14-1-8" class="d">-                    ),
</a><a href="#h14-1-9" id="h14-1-9" class="i">+                    None,
</a>                 ),
                 Ascending,
             ),
<b>diff --git a/<a id="h15" href="../file/tests/sql/query/having.html">tests/sql/query/having</a> b/<a href="../file/tests/sql/query/having.html">tests/sql/query/having</a></b>
<a href="#h15-0" id="h15-0" class="h">@@ -141,12 +141,7 @@ Plan: Plan(
</a>             predicate: GreaterThan(
                 Field(
                     1,
<a href="#h15-0-3" id="h15-0-3" class="d">-                    Some(
</a><a href="#h15-0-4" id="h15-0-4" class="d">-                        (
</a><a href="#h15-0-5" id="h15-0-5" class="d">-                            None,
</a><a href="#h15-0-6" id="h15-0-6" class="d">-                            &quot;rating&quot;,
</a><a href="#h15-0-7" id="h15-0-7" class="d">-                        ),
</a><a href="#h15-0-8" id="h15-0-8" class="d">-                    ),
</a><a href="#h15-0-9" id="h15-0-9" class="i">+                    None,
</a>                 ),
                 Constant(
                     Integer(
<a href="#h15-1" id="h15-1" class="h">@@ -159,12 +154,7 @@ Plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h15-1-3" id="h15-1-3" class="d">-                    Some(
</a><a href="#h15-1-4" id="h15-1-4" class="d">-                        (
</a><a href="#h15-1-5" id="h15-1-5" class="d">-                            None,
</a><a href="#h15-1-6" id="h15-1-6" class="d">-                            &quot;studio_id&quot;,
</a><a href="#h15-1-7" id="h15-1-7" class="d">-                        ),
</a><a href="#h15-1-8" id="h15-1-8" class="d">-                    ),
</a><a href="#h15-1-9" id="h15-1-9" class="i">+                    None,
</a>                 ),
                 Ascending,
             ),
<a href="#h15-2" id="h15-2" class="h">@@ -236,12 +226,7 @@ Optimized plan: Plan(
</a>             predicate: GreaterThan(
                 Field(
                     1,
<a href="#h15-2-3" id="h15-2-3" class="d">-                    Some(
</a><a href="#h15-2-4" id="h15-2-4" class="d">-                        (
</a><a href="#h15-2-5" id="h15-2-5" class="d">-                            None,
</a><a href="#h15-2-6" id="h15-2-6" class="d">-                            &quot;rating&quot;,
</a><a href="#h15-2-7" id="h15-2-7" class="d">-                        ),
</a><a href="#h15-2-8" id="h15-2-8" class="d">-                    ),
</a><a href="#h15-2-9" id="h15-2-9" class="i">+                    None,
</a>                 ),
                 Constant(
                     Integer(
<a href="#h15-3" id="h15-3" class="h">@@ -254,12 +239,7 @@ Optimized plan: Plan(
</a>             (
                 Field(
                     0,
<a href="#h15-3-3" id="h15-3-3" class="d">-                    Some(
</a><a href="#h15-3-4" id="h15-3-4" class="d">-                        (
</a><a href="#h15-3-5" id="h15-3-5" class="d">-                            None,
</a><a href="#h15-3-6" id="h15-3-6" class="d">-                            &quot;studio_id&quot;,
</a><a href="#h15-3-7" id="h15-3-7" class="d">-                        ),
</a><a href="#h15-3-8" id="h15-3-8" class="d">-                    ),
</a><a href="#h15-3-9" id="h15-3-9" class="i">+                    None,
</a>                 ),
                 Ascending,
             ),
<b>diff --git a/<a id="h16" href="../file/tests/sql/query/having_aggr.html">tests/sql/query/having_aggr</a> b/<a href="../file/tests/sql/query/having_aggr.html">tests/sql/query/having_aggr</a></b>
<a href="#h16-0" id="h16-0" class="h">@@ -0,0 +1,330 @@
</a><a href="#h16-0-0" id="h16-0-0" class="i">+Query: SELECT studio_id, MAX(rating) FROM movies GROUP BY studio_id HAVING MIN(rating) &gt; 7 ORDER BY studio_id
</a><a href="#h16-0-1" id="h16-0-1" class="i">+
</a><a href="#h16-0-2" id="h16-0-2" class="i">+AST: Select {
</a><a href="#h16-0-3" id="h16-0-3" class="i">+    select: SelectClause {
</a><a href="#h16-0-4" id="h16-0-4" class="i">+        expressions: [
</a><a href="#h16-0-5" id="h16-0-5" class="i">+            (
</a><a href="#h16-0-6" id="h16-0-6" class="i">+                Field(
</a><a href="#h16-0-7" id="h16-0-7" class="i">+                    None,
</a><a href="#h16-0-8" id="h16-0-8" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h16-0-9" id="h16-0-9" class="i">+                ),
</a><a href="#h16-0-10" id="h16-0-10" class="i">+                None,
</a><a href="#h16-0-11" id="h16-0-11" class="i">+            ),
</a><a href="#h16-0-12" id="h16-0-12" class="i">+            (
</a><a href="#h16-0-13" id="h16-0-13" class="i">+                Function(
</a><a href="#h16-0-14" id="h16-0-14" class="i">+                    &quot;max&quot;,
</a><a href="#h16-0-15" id="h16-0-15" class="i">+                    [
</a><a href="#h16-0-16" id="h16-0-16" class="i">+                        Field(
</a><a href="#h16-0-17" id="h16-0-17" class="i">+                            None,
</a><a href="#h16-0-18" id="h16-0-18" class="i">+                            &quot;rating&quot;,
</a><a href="#h16-0-19" id="h16-0-19" class="i">+                        ),
</a><a href="#h16-0-20" id="h16-0-20" class="i">+                    ],
</a><a href="#h16-0-21" id="h16-0-21" class="i">+                ),
</a><a href="#h16-0-22" id="h16-0-22" class="i">+                None,
</a><a href="#h16-0-23" id="h16-0-23" class="i">+            ),
</a><a href="#h16-0-24" id="h16-0-24" class="i">+        ],
</a><a href="#h16-0-25" id="h16-0-25" class="i">+    },
</a><a href="#h16-0-26" id="h16-0-26" class="i">+    from: Some(
</a><a href="#h16-0-27" id="h16-0-27" class="i">+        FromClause {
</a><a href="#h16-0-28" id="h16-0-28" class="i">+            items: [
</a><a href="#h16-0-29" id="h16-0-29" class="i">+                Table {
</a><a href="#h16-0-30" id="h16-0-30" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h16-0-31" id="h16-0-31" class="i">+                    alias: None,
</a><a href="#h16-0-32" id="h16-0-32" class="i">+                },
</a><a href="#h16-0-33" id="h16-0-33" class="i">+            ],
</a><a href="#h16-0-34" id="h16-0-34" class="i">+        },
</a><a href="#h16-0-35" id="h16-0-35" class="i">+    ),
</a><a href="#h16-0-36" id="h16-0-36" class="i">+    where: None,
</a><a href="#h16-0-37" id="h16-0-37" class="i">+    group_by: Some(
</a><a href="#h16-0-38" id="h16-0-38" class="i">+        GroupByClause(
</a><a href="#h16-0-39" id="h16-0-39" class="i">+            [
</a><a href="#h16-0-40" id="h16-0-40" class="i">+                Field(
</a><a href="#h16-0-41" id="h16-0-41" class="i">+                    None,
</a><a href="#h16-0-42" id="h16-0-42" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h16-0-43" id="h16-0-43" class="i">+                ),
</a><a href="#h16-0-44" id="h16-0-44" class="i">+            ],
</a><a href="#h16-0-45" id="h16-0-45" class="i">+        ),
</a><a href="#h16-0-46" id="h16-0-46" class="i">+    ),
</a><a href="#h16-0-47" id="h16-0-47" class="i">+    having: Some(
</a><a href="#h16-0-48" id="h16-0-48" class="i">+        HavingClause(
</a><a href="#h16-0-49" id="h16-0-49" class="i">+            Operation(
</a><a href="#h16-0-50" id="h16-0-50" class="i">+                GreaterThan(
</a><a href="#h16-0-51" id="h16-0-51" class="i">+                    Function(
</a><a href="#h16-0-52" id="h16-0-52" class="i">+                        &quot;min&quot;,
</a><a href="#h16-0-53" id="h16-0-53" class="i">+                        [
</a><a href="#h16-0-54" id="h16-0-54" class="i">+                            Field(
</a><a href="#h16-0-55" id="h16-0-55" class="i">+                                None,
</a><a href="#h16-0-56" id="h16-0-56" class="i">+                                &quot;rating&quot;,
</a><a href="#h16-0-57" id="h16-0-57" class="i">+                            ),
</a><a href="#h16-0-58" id="h16-0-58" class="i">+                        ],
</a><a href="#h16-0-59" id="h16-0-59" class="i">+                    ),
</a><a href="#h16-0-60" id="h16-0-60" class="i">+                    Literal(
</a><a href="#h16-0-61" id="h16-0-61" class="i">+                        Integer(
</a><a href="#h16-0-62" id="h16-0-62" class="i">+                            7,
</a><a href="#h16-0-63" id="h16-0-63" class="i">+                        ),
</a><a href="#h16-0-64" id="h16-0-64" class="i">+                    ),
</a><a href="#h16-0-65" id="h16-0-65" class="i">+                ),
</a><a href="#h16-0-66" id="h16-0-66" class="i">+            ),
</a><a href="#h16-0-67" id="h16-0-67" class="i">+        ),
</a><a href="#h16-0-68" id="h16-0-68" class="i">+    ),
</a><a href="#h16-0-69" id="h16-0-69" class="i">+    order: [
</a><a href="#h16-0-70" id="h16-0-70" class="i">+        (
</a><a href="#h16-0-71" id="h16-0-71" class="i">+            Field(
</a><a href="#h16-0-72" id="h16-0-72" class="i">+                None,
</a><a href="#h16-0-73" id="h16-0-73" class="i">+                &quot;studio_id&quot;,
</a><a href="#h16-0-74" id="h16-0-74" class="i">+            ),
</a><a href="#h16-0-75" id="h16-0-75" class="i">+            Ascending,
</a><a href="#h16-0-76" id="h16-0-76" class="i">+        ),
</a><a href="#h16-0-77" id="h16-0-77" class="i">+    ],
</a><a href="#h16-0-78" id="h16-0-78" class="i">+    offset: None,
</a><a href="#h16-0-79" id="h16-0-79" class="i">+    limit: None,
</a><a href="#h16-0-80" id="h16-0-80" class="i">+}
</a><a href="#h16-0-81" id="h16-0-81" class="i">+
</a><a href="#h16-0-82" id="h16-0-82" class="i">+Plan: Plan(
</a><a href="#h16-0-83" id="h16-0-83" class="i">+    Projection {
</a><a href="#h16-0-84" id="h16-0-84" class="i">+        source: Order {
</a><a href="#h16-0-85" id="h16-0-85" class="i">+            source: Filter {
</a><a href="#h16-0-86" id="h16-0-86" class="i">+                source: Projection {
</a><a href="#h16-0-87" id="h16-0-87" class="i">+                    source: Aggregation {
</a><a href="#h16-0-88" id="h16-0-88" class="i">+                        source: Projection {
</a><a href="#h16-0-89" id="h16-0-89" class="i">+                            source: Scan {
</a><a href="#h16-0-90" id="h16-0-90" class="i">+                                table: &quot;movies&quot;,
</a><a href="#h16-0-91" id="h16-0-91" class="i">+                                alias: None,
</a><a href="#h16-0-92" id="h16-0-92" class="i">+                                filter: None,
</a><a href="#h16-0-93" id="h16-0-93" class="i">+                            },
</a><a href="#h16-0-94" id="h16-0-94" class="i">+                            expressions: [
</a><a href="#h16-0-95" id="h16-0-95" class="i">+                                (
</a><a href="#h16-0-96" id="h16-0-96" class="i">+                                    Field(
</a><a href="#h16-0-97" id="h16-0-97" class="i">+                                        5,
</a><a href="#h16-0-98" id="h16-0-98" class="i">+                                        Some(
</a><a href="#h16-0-99" id="h16-0-99" class="i">+                                            (
</a><a href="#h16-0-100" id="h16-0-100" class="i">+                                                None,
</a><a href="#h16-0-101" id="h16-0-101" class="i">+                                                &quot;rating&quot;,
</a><a href="#h16-0-102" id="h16-0-102" class="i">+                                            ),
</a><a href="#h16-0-103" id="h16-0-103" class="i">+                                        ),
</a><a href="#h16-0-104" id="h16-0-104" class="i">+                                    ),
</a><a href="#h16-0-105" id="h16-0-105" class="i">+                                    None,
</a><a href="#h16-0-106" id="h16-0-106" class="i">+                                ),
</a><a href="#h16-0-107" id="h16-0-107" class="i">+                                (
</a><a href="#h16-0-108" id="h16-0-108" class="i">+                                    Field(
</a><a href="#h16-0-109" id="h16-0-109" class="i">+                                        5,
</a><a href="#h16-0-110" id="h16-0-110" class="i">+                                        Some(
</a><a href="#h16-0-111" id="h16-0-111" class="i">+                                            (
</a><a href="#h16-0-112" id="h16-0-112" class="i">+                                                None,
</a><a href="#h16-0-113" id="h16-0-113" class="i">+                                                &quot;rating&quot;,
</a><a href="#h16-0-114" id="h16-0-114" class="i">+                                            ),
</a><a href="#h16-0-115" id="h16-0-115" class="i">+                                        ),
</a><a href="#h16-0-116" id="h16-0-116" class="i">+                                    ),
</a><a href="#h16-0-117" id="h16-0-117" class="i">+                                    None,
</a><a href="#h16-0-118" id="h16-0-118" class="i">+                                ),
</a><a href="#h16-0-119" id="h16-0-119" class="i">+                                (
</a><a href="#h16-0-120" id="h16-0-120" class="i">+                                    Field(
</a><a href="#h16-0-121" id="h16-0-121" class="i">+                                        2,
</a><a href="#h16-0-122" id="h16-0-122" class="i">+                                        Some(
</a><a href="#h16-0-123" id="h16-0-123" class="i">+                                            (
</a><a href="#h16-0-124" id="h16-0-124" class="i">+                                                None,
</a><a href="#h16-0-125" id="h16-0-125" class="i">+                                                &quot;studio_id&quot;,
</a><a href="#h16-0-126" id="h16-0-126" class="i">+                                            ),
</a><a href="#h16-0-127" id="h16-0-127" class="i">+                                        ),
</a><a href="#h16-0-128" id="h16-0-128" class="i">+                                    ),
</a><a href="#h16-0-129" id="h16-0-129" class="i">+                                    None,
</a><a href="#h16-0-130" id="h16-0-130" class="i">+                                ),
</a><a href="#h16-0-131" id="h16-0-131" class="i">+                            ],
</a><a href="#h16-0-132" id="h16-0-132" class="i">+                        },
</a><a href="#h16-0-133" id="h16-0-133" class="i">+                        aggregates: [
</a><a href="#h16-0-134" id="h16-0-134" class="i">+                            Max,
</a><a href="#h16-0-135" id="h16-0-135" class="i">+                            Min,
</a><a href="#h16-0-136" id="h16-0-136" class="i">+                        ],
</a><a href="#h16-0-137" id="h16-0-137" class="i">+                    },
</a><a href="#h16-0-138" id="h16-0-138" class="i">+                    expressions: [
</a><a href="#h16-0-139" id="h16-0-139" class="i">+                        (
</a><a href="#h16-0-140" id="h16-0-140" class="i">+                            Field(
</a><a href="#h16-0-141" id="h16-0-141" class="i">+                                2,
</a><a href="#h16-0-142" id="h16-0-142" class="i">+                                None,
</a><a href="#h16-0-143" id="h16-0-143" class="i">+                            ),
</a><a href="#h16-0-144" id="h16-0-144" class="i">+                            None,
</a><a href="#h16-0-145" id="h16-0-145" class="i">+                        ),
</a><a href="#h16-0-146" id="h16-0-146" class="i">+                        (
</a><a href="#h16-0-147" id="h16-0-147" class="i">+                            Field(
</a><a href="#h16-0-148" id="h16-0-148" class="i">+                                0,
</a><a href="#h16-0-149" id="h16-0-149" class="i">+                                None,
</a><a href="#h16-0-150" id="h16-0-150" class="i">+                            ),
</a><a href="#h16-0-151" id="h16-0-151" class="i">+                            None,
</a><a href="#h16-0-152" id="h16-0-152" class="i">+                        ),
</a><a href="#h16-0-153" id="h16-0-153" class="i">+                        (
</a><a href="#h16-0-154" id="h16-0-154" class="i">+                            Field(
</a><a href="#h16-0-155" id="h16-0-155" class="i">+                                1,
</a><a href="#h16-0-156" id="h16-0-156" class="i">+                                None,
</a><a href="#h16-0-157" id="h16-0-157" class="i">+                            ),
</a><a href="#h16-0-158" id="h16-0-158" class="i">+                            None,
</a><a href="#h16-0-159" id="h16-0-159" class="i">+                        ),
</a><a href="#h16-0-160" id="h16-0-160" class="i">+                    ],
</a><a href="#h16-0-161" id="h16-0-161" class="i">+                },
</a><a href="#h16-0-162" id="h16-0-162" class="i">+                predicate: GreaterThan(
</a><a href="#h16-0-163" id="h16-0-163" class="i">+                    Field(
</a><a href="#h16-0-164" id="h16-0-164" class="i">+                        2,
</a><a href="#h16-0-165" id="h16-0-165" class="i">+                        None,
</a><a href="#h16-0-166" id="h16-0-166" class="i">+                    ),
</a><a href="#h16-0-167" id="h16-0-167" class="i">+                    Constant(
</a><a href="#h16-0-168" id="h16-0-168" class="i">+                        Integer(
</a><a href="#h16-0-169" id="h16-0-169" class="i">+                            7,
</a><a href="#h16-0-170" id="h16-0-170" class="i">+                        ),
</a><a href="#h16-0-171" id="h16-0-171" class="i">+                    ),
</a><a href="#h16-0-172" id="h16-0-172" class="i">+                ),
</a><a href="#h16-0-173" id="h16-0-173" class="i">+            },
</a><a href="#h16-0-174" id="h16-0-174" class="i">+            orders: [
</a><a href="#h16-0-175" id="h16-0-175" class="i">+                (
</a><a href="#h16-0-176" id="h16-0-176" class="i">+                    Field(
</a><a href="#h16-0-177" id="h16-0-177" class="i">+                        0,
</a><a href="#h16-0-178" id="h16-0-178" class="i">+                        None,
</a><a href="#h16-0-179" id="h16-0-179" class="i">+                    ),
</a><a href="#h16-0-180" id="h16-0-180" class="i">+                    Ascending,
</a><a href="#h16-0-181" id="h16-0-181" class="i">+                ),
</a><a href="#h16-0-182" id="h16-0-182" class="i">+            ],
</a><a href="#h16-0-183" id="h16-0-183" class="i">+        },
</a><a href="#h16-0-184" id="h16-0-184" class="i">+        expressions: [
</a><a href="#h16-0-185" id="h16-0-185" class="i">+            (
</a><a href="#h16-0-186" id="h16-0-186" class="i">+                Field(
</a><a href="#h16-0-187" id="h16-0-187" class="i">+                    0,
</a><a href="#h16-0-188" id="h16-0-188" class="i">+                    None,
</a><a href="#h16-0-189" id="h16-0-189" class="i">+                ),
</a><a href="#h16-0-190" id="h16-0-190" class="i">+                None,
</a><a href="#h16-0-191" id="h16-0-191" class="i">+            ),
</a><a href="#h16-0-192" id="h16-0-192" class="i">+            (
</a><a href="#h16-0-193" id="h16-0-193" class="i">+                Field(
</a><a href="#h16-0-194" id="h16-0-194" class="i">+                    1,
</a><a href="#h16-0-195" id="h16-0-195" class="i">+                    None,
</a><a href="#h16-0-196" id="h16-0-196" class="i">+                ),
</a><a href="#h16-0-197" id="h16-0-197" class="i">+                None,
</a><a href="#h16-0-198" id="h16-0-198" class="i">+            ),
</a><a href="#h16-0-199" id="h16-0-199" class="i">+        ],
</a><a href="#h16-0-200" id="h16-0-200" class="i">+    },
</a><a href="#h16-0-201" id="h16-0-201" class="i">+)
</a><a href="#h16-0-202" id="h16-0-202" class="i">+
</a><a href="#h16-0-203" id="h16-0-203" class="i">+Optimized plan: Plan(
</a><a href="#h16-0-204" id="h16-0-204" class="i">+    Projection {
</a><a href="#h16-0-205" id="h16-0-205" class="i">+        source: Order {
</a><a href="#h16-0-206" id="h16-0-206" class="i">+            source: Filter {
</a><a href="#h16-0-207" id="h16-0-207" class="i">+                source: Projection {
</a><a href="#h16-0-208" id="h16-0-208" class="i">+                    source: Aggregation {
</a><a href="#h16-0-209" id="h16-0-209" class="i">+                        source: Projection {
</a><a href="#h16-0-210" id="h16-0-210" class="i">+                            source: Scan {
</a><a href="#h16-0-211" id="h16-0-211" class="i">+                                table: &quot;movies&quot;,
</a><a href="#h16-0-212" id="h16-0-212" class="i">+                                alias: None,
</a><a href="#h16-0-213" id="h16-0-213" class="i">+                                filter: None,
</a><a href="#h16-0-214" id="h16-0-214" class="i">+                            },
</a><a href="#h16-0-215" id="h16-0-215" class="i">+                            expressions: [
</a><a href="#h16-0-216" id="h16-0-216" class="i">+                                (
</a><a href="#h16-0-217" id="h16-0-217" class="i">+                                    Field(
</a><a href="#h16-0-218" id="h16-0-218" class="i">+                                        5,
</a><a href="#h16-0-219" id="h16-0-219" class="i">+                                        Some(
</a><a href="#h16-0-220" id="h16-0-220" class="i">+                                            (
</a><a href="#h16-0-221" id="h16-0-221" class="i">+                                                None,
</a><a href="#h16-0-222" id="h16-0-222" class="i">+                                                &quot;rating&quot;,
</a><a href="#h16-0-223" id="h16-0-223" class="i">+                                            ),
</a><a href="#h16-0-224" id="h16-0-224" class="i">+                                        ),
</a><a href="#h16-0-225" id="h16-0-225" class="i">+                                    ),
</a><a href="#h16-0-226" id="h16-0-226" class="i">+                                    None,
</a><a href="#h16-0-227" id="h16-0-227" class="i">+                                ),
</a><a href="#h16-0-228" id="h16-0-228" class="i">+                                (
</a><a href="#h16-0-229" id="h16-0-229" class="i">+                                    Field(
</a><a href="#h16-0-230" id="h16-0-230" class="i">+                                        5,
</a><a href="#h16-0-231" id="h16-0-231" class="i">+                                        Some(
</a><a href="#h16-0-232" id="h16-0-232" class="i">+                                            (
</a><a href="#h16-0-233" id="h16-0-233" class="i">+                                                None,
</a><a href="#h16-0-234" id="h16-0-234" class="i">+                                                &quot;rating&quot;,
</a><a href="#h16-0-235" id="h16-0-235" class="i">+                                            ),
</a><a href="#h16-0-236" id="h16-0-236" class="i">+                                        ),
</a><a href="#h16-0-237" id="h16-0-237" class="i">+                                    ),
</a><a href="#h16-0-238" id="h16-0-238" class="i">+                                    None,
</a><a href="#h16-0-239" id="h16-0-239" class="i">+                                ),
</a><a href="#h16-0-240" id="h16-0-240" class="i">+                                (
</a><a href="#h16-0-241" id="h16-0-241" class="i">+                                    Field(
</a><a href="#h16-0-242" id="h16-0-242" class="i">+                                        2,
</a><a href="#h16-0-243" id="h16-0-243" class="i">+                                        Some(
</a><a href="#h16-0-244" id="h16-0-244" class="i">+                                            (
</a><a href="#h16-0-245" id="h16-0-245" class="i">+                                                None,
</a><a href="#h16-0-246" id="h16-0-246" class="i">+                                                &quot;studio_id&quot;,
</a><a href="#h16-0-247" id="h16-0-247" class="i">+                                            ),
</a><a href="#h16-0-248" id="h16-0-248" class="i">+                                        ),
</a><a href="#h16-0-249" id="h16-0-249" class="i">+                                    ),
</a><a href="#h16-0-250" id="h16-0-250" class="i">+                                    None,
</a><a href="#h16-0-251" id="h16-0-251" class="i">+                                ),
</a><a href="#h16-0-252" id="h16-0-252" class="i">+                            ],
</a><a href="#h16-0-253" id="h16-0-253" class="i">+                        },
</a><a href="#h16-0-254" id="h16-0-254" class="i">+                        aggregates: [
</a><a href="#h16-0-255" id="h16-0-255" class="i">+                            Max,
</a><a href="#h16-0-256" id="h16-0-256" class="i">+                            Min,
</a><a href="#h16-0-257" id="h16-0-257" class="i">+                        ],
</a><a href="#h16-0-258" id="h16-0-258" class="i">+                    },
</a><a href="#h16-0-259" id="h16-0-259" class="i">+                    expressions: [
</a><a href="#h16-0-260" id="h16-0-260" class="i">+                        (
</a><a href="#h16-0-261" id="h16-0-261" class="i">+                            Field(
</a><a href="#h16-0-262" id="h16-0-262" class="i">+                                2,
</a><a href="#h16-0-263" id="h16-0-263" class="i">+                                None,
</a><a href="#h16-0-264" id="h16-0-264" class="i">+                            ),
</a><a href="#h16-0-265" id="h16-0-265" class="i">+                            None,
</a><a href="#h16-0-266" id="h16-0-266" class="i">+                        ),
</a><a href="#h16-0-267" id="h16-0-267" class="i">+                        (
</a><a href="#h16-0-268" id="h16-0-268" class="i">+                            Field(
</a><a href="#h16-0-269" id="h16-0-269" class="i">+                                0,
</a><a href="#h16-0-270" id="h16-0-270" class="i">+                                None,
</a><a href="#h16-0-271" id="h16-0-271" class="i">+                            ),
</a><a href="#h16-0-272" id="h16-0-272" class="i">+                            None,
</a><a href="#h16-0-273" id="h16-0-273" class="i">+                        ),
</a><a href="#h16-0-274" id="h16-0-274" class="i">+                        (
</a><a href="#h16-0-275" id="h16-0-275" class="i">+                            Field(
</a><a href="#h16-0-276" id="h16-0-276" class="i">+                                1,
</a><a href="#h16-0-277" id="h16-0-277" class="i">+                                None,
</a><a href="#h16-0-278" id="h16-0-278" class="i">+                            ),
</a><a href="#h16-0-279" id="h16-0-279" class="i">+                            None,
</a><a href="#h16-0-280" id="h16-0-280" class="i">+                        ),
</a><a href="#h16-0-281" id="h16-0-281" class="i">+                    ],
</a><a href="#h16-0-282" id="h16-0-282" class="i">+                },
</a><a href="#h16-0-283" id="h16-0-283" class="i">+                predicate: GreaterThan(
</a><a href="#h16-0-284" id="h16-0-284" class="i">+                    Field(
</a><a href="#h16-0-285" id="h16-0-285" class="i">+                        2,
</a><a href="#h16-0-286" id="h16-0-286" class="i">+                        None,
</a><a href="#h16-0-287" id="h16-0-287" class="i">+                    ),
</a><a href="#h16-0-288" id="h16-0-288" class="i">+                    Constant(
</a><a href="#h16-0-289" id="h16-0-289" class="i">+                        Integer(
</a><a href="#h16-0-290" id="h16-0-290" class="i">+                            7,
</a><a href="#h16-0-291" id="h16-0-291" class="i">+                        ),
</a><a href="#h16-0-292" id="h16-0-292" class="i">+                    ),
</a><a href="#h16-0-293" id="h16-0-293" class="i">+                ),
</a><a href="#h16-0-294" id="h16-0-294" class="i">+            },
</a><a href="#h16-0-295" id="h16-0-295" class="i">+            orders: [
</a><a href="#h16-0-296" id="h16-0-296" class="i">+                (
</a><a href="#h16-0-297" id="h16-0-297" class="i">+                    Field(
</a><a href="#h16-0-298" id="h16-0-298" class="i">+                        0,
</a><a href="#h16-0-299" id="h16-0-299" class="i">+                        None,
</a><a href="#h16-0-300" id="h16-0-300" class="i">+                    ),
</a><a href="#h16-0-301" id="h16-0-301" class="i">+                    Ascending,
</a><a href="#h16-0-302" id="h16-0-302" class="i">+                ),
</a><a href="#h16-0-303" id="h16-0-303" class="i">+            ],
</a><a href="#h16-0-304" id="h16-0-304" class="i">+        },
</a><a href="#h16-0-305" id="h16-0-305" class="i">+        expressions: [
</a><a href="#h16-0-306" id="h16-0-306" class="i">+            (
</a><a href="#h16-0-307" id="h16-0-307" class="i">+                Field(
</a><a href="#h16-0-308" id="h16-0-308" class="i">+                    0,
</a><a href="#h16-0-309" id="h16-0-309" class="i">+                    None,
</a><a href="#h16-0-310" id="h16-0-310" class="i">+                ),
</a><a href="#h16-0-311" id="h16-0-311" class="i">+                None,
</a><a href="#h16-0-312" id="h16-0-312" class="i">+            ),
</a><a href="#h16-0-313" id="h16-0-313" class="i">+            (
</a><a href="#h16-0-314" id="h16-0-314" class="i">+                Field(
</a><a href="#h16-0-315" id="h16-0-315" class="i">+                    1,
</a><a href="#h16-0-316" id="h16-0-316" class="i">+                    None,
</a><a href="#h16-0-317" id="h16-0-317" class="i">+                ),
</a><a href="#h16-0-318" id="h16-0-318" class="i">+                None,
</a><a href="#h16-0-319" id="h16-0-319" class="i">+            ),
</a><a href="#h16-0-320" id="h16-0-320" class="i">+        ],
</a><a href="#h16-0-321" id="h16-0-321" class="i">+    },
</a><a href="#h16-0-322" id="h16-0-322" class="i">+)
</a><a href="#h16-0-323" id="h16-0-323" class="i">+
</a><a href="#h16-0-324" id="h16-0-324" class="i">+Query: SELECT studio_id, MAX(rating) FROM movies GROUP BY studio_id HAVING MIN(rating) &gt; 7 ORDER BY studio_id
</a><a href="#h16-0-325" id="h16-0-325" class="i">+
</a><a href="#h16-0-326" id="h16-0-326" class="i">+Result: [&quot;studio_id&quot;, &quot;?&quot;]
</a><a href="#h16-0-327" id="h16-0-327" class="i">+[Integer(1), Float(8.2)]
</a><a href="#h16-0-328" id="h16-0-328" class="i">+[Integer(2), Float(7.6)]
</a><a href="#h16-0-329" id="h16-0-329" class="i">+[Integer(4), Float(8.8)]
</a><b>diff --git a/<a id="h17" href="../file/tests/sql/query/having_aggr_expr.html">tests/sql/query/having_aggr_expr</a> b/<a href="../file/tests/sql/query/having_aggr_expr.html">tests/sql/query/having_aggr_expr</a></b>
<a href="#h17-0" id="h17-0" class="h">@@ -0,0 +1,395 @@
</a><a href="#h17-0-0" id="h17-0-0" class="i">+Query: SELECT studio_id, MAX(rating) FROM movies GROUP BY studio_id HAVING MAX(rating) - MIN(rating) &lt; 1 ORDER BY studio_id
</a><a href="#h17-0-1" id="h17-0-1" class="i">+
</a><a href="#h17-0-2" id="h17-0-2" class="i">+AST: Select {
</a><a href="#h17-0-3" id="h17-0-3" class="i">+    select: SelectClause {
</a><a href="#h17-0-4" id="h17-0-4" class="i">+        expressions: [
</a><a href="#h17-0-5" id="h17-0-5" class="i">+            (
</a><a href="#h17-0-6" id="h17-0-6" class="i">+                Field(
</a><a href="#h17-0-7" id="h17-0-7" class="i">+                    None,
</a><a href="#h17-0-8" id="h17-0-8" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h17-0-9" id="h17-0-9" class="i">+                ),
</a><a href="#h17-0-10" id="h17-0-10" class="i">+                None,
</a><a href="#h17-0-11" id="h17-0-11" class="i">+            ),
</a><a href="#h17-0-12" id="h17-0-12" class="i">+            (
</a><a href="#h17-0-13" id="h17-0-13" class="i">+                Function(
</a><a href="#h17-0-14" id="h17-0-14" class="i">+                    &quot;max&quot;,
</a><a href="#h17-0-15" id="h17-0-15" class="i">+                    [
</a><a href="#h17-0-16" id="h17-0-16" class="i">+                        Field(
</a><a href="#h17-0-17" id="h17-0-17" class="i">+                            None,
</a><a href="#h17-0-18" id="h17-0-18" class="i">+                            &quot;rating&quot;,
</a><a href="#h17-0-19" id="h17-0-19" class="i">+                        ),
</a><a href="#h17-0-20" id="h17-0-20" class="i">+                    ],
</a><a href="#h17-0-21" id="h17-0-21" class="i">+                ),
</a><a href="#h17-0-22" id="h17-0-22" class="i">+                None,
</a><a href="#h17-0-23" id="h17-0-23" class="i">+            ),
</a><a href="#h17-0-24" id="h17-0-24" class="i">+        ],
</a><a href="#h17-0-25" id="h17-0-25" class="i">+    },
</a><a href="#h17-0-26" id="h17-0-26" class="i">+    from: Some(
</a><a href="#h17-0-27" id="h17-0-27" class="i">+        FromClause {
</a><a href="#h17-0-28" id="h17-0-28" class="i">+            items: [
</a><a href="#h17-0-29" id="h17-0-29" class="i">+                Table {
</a><a href="#h17-0-30" id="h17-0-30" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h17-0-31" id="h17-0-31" class="i">+                    alias: None,
</a><a href="#h17-0-32" id="h17-0-32" class="i">+                },
</a><a href="#h17-0-33" id="h17-0-33" class="i">+            ],
</a><a href="#h17-0-34" id="h17-0-34" class="i">+        },
</a><a href="#h17-0-35" id="h17-0-35" class="i">+    ),
</a><a href="#h17-0-36" id="h17-0-36" class="i">+    where: None,
</a><a href="#h17-0-37" id="h17-0-37" class="i">+    group_by: Some(
</a><a href="#h17-0-38" id="h17-0-38" class="i">+        GroupByClause(
</a><a href="#h17-0-39" id="h17-0-39" class="i">+            [
</a><a href="#h17-0-40" id="h17-0-40" class="i">+                Field(
</a><a href="#h17-0-41" id="h17-0-41" class="i">+                    None,
</a><a href="#h17-0-42" id="h17-0-42" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h17-0-43" id="h17-0-43" class="i">+                ),
</a><a href="#h17-0-44" id="h17-0-44" class="i">+            ],
</a><a href="#h17-0-45" id="h17-0-45" class="i">+        ),
</a><a href="#h17-0-46" id="h17-0-46" class="i">+    ),
</a><a href="#h17-0-47" id="h17-0-47" class="i">+    having: Some(
</a><a href="#h17-0-48" id="h17-0-48" class="i">+        HavingClause(
</a><a href="#h17-0-49" id="h17-0-49" class="i">+            Operation(
</a><a href="#h17-0-50" id="h17-0-50" class="i">+                LessThan(
</a><a href="#h17-0-51" id="h17-0-51" class="i">+                    Operation(
</a><a href="#h17-0-52" id="h17-0-52" class="i">+                        Subtract(
</a><a href="#h17-0-53" id="h17-0-53" class="i">+                            Function(
</a><a href="#h17-0-54" id="h17-0-54" class="i">+                                &quot;max&quot;,
</a><a href="#h17-0-55" id="h17-0-55" class="i">+                                [
</a><a href="#h17-0-56" id="h17-0-56" class="i">+                                    Field(
</a><a href="#h17-0-57" id="h17-0-57" class="i">+                                        None,
</a><a href="#h17-0-58" id="h17-0-58" class="i">+                                        &quot;rating&quot;,
</a><a href="#h17-0-59" id="h17-0-59" class="i">+                                    ),
</a><a href="#h17-0-60" id="h17-0-60" class="i">+                                ],
</a><a href="#h17-0-61" id="h17-0-61" class="i">+                            ),
</a><a href="#h17-0-62" id="h17-0-62" class="i">+                            Function(
</a><a href="#h17-0-63" id="h17-0-63" class="i">+                                &quot;min&quot;,
</a><a href="#h17-0-64" id="h17-0-64" class="i">+                                [
</a><a href="#h17-0-65" id="h17-0-65" class="i">+                                    Field(
</a><a href="#h17-0-66" id="h17-0-66" class="i">+                                        None,
</a><a href="#h17-0-67" id="h17-0-67" class="i">+                                        &quot;rating&quot;,
</a><a href="#h17-0-68" id="h17-0-68" class="i">+                                    ),
</a><a href="#h17-0-69" id="h17-0-69" class="i">+                                ],
</a><a href="#h17-0-70" id="h17-0-70" class="i">+                            ),
</a><a href="#h17-0-71" id="h17-0-71" class="i">+                        ),
</a><a href="#h17-0-72" id="h17-0-72" class="i">+                    ),
</a><a href="#h17-0-73" id="h17-0-73" class="i">+                    Literal(
</a><a href="#h17-0-74" id="h17-0-74" class="i">+                        Integer(
</a><a href="#h17-0-75" id="h17-0-75" class="i">+                            1,
</a><a href="#h17-0-76" id="h17-0-76" class="i">+                        ),
</a><a href="#h17-0-77" id="h17-0-77" class="i">+                    ),
</a><a href="#h17-0-78" id="h17-0-78" class="i">+                ),
</a><a href="#h17-0-79" id="h17-0-79" class="i">+            ),
</a><a href="#h17-0-80" id="h17-0-80" class="i">+        ),
</a><a href="#h17-0-81" id="h17-0-81" class="i">+    ),
</a><a href="#h17-0-82" id="h17-0-82" class="i">+    order: [
</a><a href="#h17-0-83" id="h17-0-83" class="i">+        (
</a><a href="#h17-0-84" id="h17-0-84" class="i">+            Field(
</a><a href="#h17-0-85" id="h17-0-85" class="i">+                None,
</a><a href="#h17-0-86" id="h17-0-86" class="i">+                &quot;studio_id&quot;,
</a><a href="#h17-0-87" id="h17-0-87" class="i">+            ),
</a><a href="#h17-0-88" id="h17-0-88" class="i">+            Ascending,
</a><a href="#h17-0-89" id="h17-0-89" class="i">+        ),
</a><a href="#h17-0-90" id="h17-0-90" class="i">+    ],
</a><a href="#h17-0-91" id="h17-0-91" class="i">+    offset: None,
</a><a href="#h17-0-92" id="h17-0-92" class="i">+    limit: None,
</a><a href="#h17-0-93" id="h17-0-93" class="i">+}
</a><a href="#h17-0-94" id="h17-0-94" class="i">+
</a><a href="#h17-0-95" id="h17-0-95" class="i">+Plan: Plan(
</a><a href="#h17-0-96" id="h17-0-96" class="i">+    Projection {
</a><a href="#h17-0-97" id="h17-0-97" class="i">+        source: Order {
</a><a href="#h17-0-98" id="h17-0-98" class="i">+            source: Filter {
</a><a href="#h17-0-99" id="h17-0-99" class="i">+                source: Projection {
</a><a href="#h17-0-100" id="h17-0-100" class="i">+                    source: Aggregation {
</a><a href="#h17-0-101" id="h17-0-101" class="i">+                        source: Projection {
</a><a href="#h17-0-102" id="h17-0-102" class="i">+                            source: Scan {
</a><a href="#h17-0-103" id="h17-0-103" class="i">+                                table: &quot;movies&quot;,
</a><a href="#h17-0-104" id="h17-0-104" class="i">+                                alias: None,
</a><a href="#h17-0-105" id="h17-0-105" class="i">+                                filter: None,
</a><a href="#h17-0-106" id="h17-0-106" class="i">+                            },
</a><a href="#h17-0-107" id="h17-0-107" class="i">+                            expressions: [
</a><a href="#h17-0-108" id="h17-0-108" class="i">+                                (
</a><a href="#h17-0-109" id="h17-0-109" class="i">+                                    Field(
</a><a href="#h17-0-110" id="h17-0-110" class="i">+                                        5,
</a><a href="#h17-0-111" id="h17-0-111" class="i">+                                        Some(
</a><a href="#h17-0-112" id="h17-0-112" class="i">+                                            (
</a><a href="#h17-0-113" id="h17-0-113" class="i">+                                                None,
</a><a href="#h17-0-114" id="h17-0-114" class="i">+                                                &quot;rating&quot;,
</a><a href="#h17-0-115" id="h17-0-115" class="i">+                                            ),
</a><a href="#h17-0-116" id="h17-0-116" class="i">+                                        ),
</a><a href="#h17-0-117" id="h17-0-117" class="i">+                                    ),
</a><a href="#h17-0-118" id="h17-0-118" class="i">+                                    None,
</a><a href="#h17-0-119" id="h17-0-119" class="i">+                                ),
</a><a href="#h17-0-120" id="h17-0-120" class="i">+                                (
</a><a href="#h17-0-121" id="h17-0-121" class="i">+                                    Field(
</a><a href="#h17-0-122" id="h17-0-122" class="i">+                                        5,
</a><a href="#h17-0-123" id="h17-0-123" class="i">+                                        Some(
</a><a href="#h17-0-124" id="h17-0-124" class="i">+                                            (
</a><a href="#h17-0-125" id="h17-0-125" class="i">+                                                None,
</a><a href="#h17-0-126" id="h17-0-126" class="i">+                                                &quot;rating&quot;,
</a><a href="#h17-0-127" id="h17-0-127" class="i">+                                            ),
</a><a href="#h17-0-128" id="h17-0-128" class="i">+                                        ),
</a><a href="#h17-0-129" id="h17-0-129" class="i">+                                    ),
</a><a href="#h17-0-130" id="h17-0-130" class="i">+                                    None,
</a><a href="#h17-0-131" id="h17-0-131" class="i">+                                ),
</a><a href="#h17-0-132" id="h17-0-132" class="i">+                                (
</a><a href="#h17-0-133" id="h17-0-133" class="i">+                                    Field(
</a><a href="#h17-0-134" id="h17-0-134" class="i">+                                        5,
</a><a href="#h17-0-135" id="h17-0-135" class="i">+                                        Some(
</a><a href="#h17-0-136" id="h17-0-136" class="i">+                                            (
</a><a href="#h17-0-137" id="h17-0-137" class="i">+                                                None,
</a><a href="#h17-0-138" id="h17-0-138" class="i">+                                                &quot;rating&quot;,
</a><a href="#h17-0-139" id="h17-0-139" class="i">+                                            ),
</a><a href="#h17-0-140" id="h17-0-140" class="i">+                                        ),
</a><a href="#h17-0-141" id="h17-0-141" class="i">+                                    ),
</a><a href="#h17-0-142" id="h17-0-142" class="i">+                                    None,
</a><a href="#h17-0-143" id="h17-0-143" class="i">+                                ),
</a><a href="#h17-0-144" id="h17-0-144" class="i">+                                (
</a><a href="#h17-0-145" id="h17-0-145" class="i">+                                    Field(
</a><a href="#h17-0-146" id="h17-0-146" class="i">+                                        2,
</a><a href="#h17-0-147" id="h17-0-147" class="i">+                                        Some(
</a><a href="#h17-0-148" id="h17-0-148" class="i">+                                            (
</a><a href="#h17-0-149" id="h17-0-149" class="i">+                                                None,
</a><a href="#h17-0-150" id="h17-0-150" class="i">+                                                &quot;studio_id&quot;,
</a><a href="#h17-0-151" id="h17-0-151" class="i">+                                            ),
</a><a href="#h17-0-152" id="h17-0-152" class="i">+                                        ),
</a><a href="#h17-0-153" id="h17-0-153" class="i">+                                    ),
</a><a href="#h17-0-154" id="h17-0-154" class="i">+                                    None,
</a><a href="#h17-0-155" id="h17-0-155" class="i">+                                ),
</a><a href="#h17-0-156" id="h17-0-156" class="i">+                            ],
</a><a href="#h17-0-157" id="h17-0-157" class="i">+                        },
</a><a href="#h17-0-158" id="h17-0-158" class="i">+                        aggregates: [
</a><a href="#h17-0-159" id="h17-0-159" class="i">+                            Max,
</a><a href="#h17-0-160" id="h17-0-160" class="i">+                            Max,
</a><a href="#h17-0-161" id="h17-0-161" class="i">+                            Min,
</a><a href="#h17-0-162" id="h17-0-162" class="i">+                        ],
</a><a href="#h17-0-163" id="h17-0-163" class="i">+                    },
</a><a href="#h17-0-164" id="h17-0-164" class="i">+                    expressions: [
</a><a href="#h17-0-165" id="h17-0-165" class="i">+                        (
</a><a href="#h17-0-166" id="h17-0-166" class="i">+                            Field(
</a><a href="#h17-0-167" id="h17-0-167" class="i">+                                3,
</a><a href="#h17-0-168" id="h17-0-168" class="i">+                                None,
</a><a href="#h17-0-169" id="h17-0-169" class="i">+                            ),
</a><a href="#h17-0-170" id="h17-0-170" class="i">+                            None,
</a><a href="#h17-0-171" id="h17-0-171" class="i">+                        ),
</a><a href="#h17-0-172" id="h17-0-172" class="i">+                        (
</a><a href="#h17-0-173" id="h17-0-173" class="i">+                            Field(
</a><a href="#h17-0-174" id="h17-0-174" class="i">+                                0,
</a><a href="#h17-0-175" id="h17-0-175" class="i">+                                None,
</a><a href="#h17-0-176" id="h17-0-176" class="i">+                            ),
</a><a href="#h17-0-177" id="h17-0-177" class="i">+                            None,
</a><a href="#h17-0-178" id="h17-0-178" class="i">+                        ),
</a><a href="#h17-0-179" id="h17-0-179" class="i">+                        (
</a><a href="#h17-0-180" id="h17-0-180" class="i">+                            Field(
</a><a href="#h17-0-181" id="h17-0-181" class="i">+                                1,
</a><a href="#h17-0-182" id="h17-0-182" class="i">+                                None,
</a><a href="#h17-0-183" id="h17-0-183" class="i">+                            ),
</a><a href="#h17-0-184" id="h17-0-184" class="i">+                            None,
</a><a href="#h17-0-185" id="h17-0-185" class="i">+                        ),
</a><a href="#h17-0-186" id="h17-0-186" class="i">+                        (
</a><a href="#h17-0-187" id="h17-0-187" class="i">+                            Field(
</a><a href="#h17-0-188" id="h17-0-188" class="i">+                                2,
</a><a href="#h17-0-189" id="h17-0-189" class="i">+                                None,
</a><a href="#h17-0-190" id="h17-0-190" class="i">+                            ),
</a><a href="#h17-0-191" id="h17-0-191" class="i">+                            None,
</a><a href="#h17-0-192" id="h17-0-192" class="i">+                        ),
</a><a href="#h17-0-193" id="h17-0-193" class="i">+                    ],
</a><a href="#h17-0-194" id="h17-0-194" class="i">+                },
</a><a href="#h17-0-195" id="h17-0-195" class="i">+                predicate: LessThan(
</a><a href="#h17-0-196" id="h17-0-196" class="i">+                    Subtract(
</a><a href="#h17-0-197" id="h17-0-197" class="i">+                        Field(
</a><a href="#h17-0-198" id="h17-0-198" class="i">+                            2,
</a><a href="#h17-0-199" id="h17-0-199" class="i">+                            None,
</a><a href="#h17-0-200" id="h17-0-200" class="i">+                        ),
</a><a href="#h17-0-201" id="h17-0-201" class="i">+                        Field(
</a><a href="#h17-0-202" id="h17-0-202" class="i">+                            3,
</a><a href="#h17-0-203" id="h17-0-203" class="i">+                            None,
</a><a href="#h17-0-204" id="h17-0-204" class="i">+                        ),
</a><a href="#h17-0-205" id="h17-0-205" class="i">+                    ),
</a><a href="#h17-0-206" id="h17-0-206" class="i">+                    Constant(
</a><a href="#h17-0-207" id="h17-0-207" class="i">+                        Integer(
</a><a href="#h17-0-208" id="h17-0-208" class="i">+                            1,
</a><a href="#h17-0-209" id="h17-0-209" class="i">+                        ),
</a><a href="#h17-0-210" id="h17-0-210" class="i">+                    ),
</a><a href="#h17-0-211" id="h17-0-211" class="i">+                ),
</a><a href="#h17-0-212" id="h17-0-212" class="i">+            },
</a><a href="#h17-0-213" id="h17-0-213" class="i">+            orders: [
</a><a href="#h17-0-214" id="h17-0-214" class="i">+                (
</a><a href="#h17-0-215" id="h17-0-215" class="i">+                    Field(
</a><a href="#h17-0-216" id="h17-0-216" class="i">+                        0,
</a><a href="#h17-0-217" id="h17-0-217" class="i">+                        None,
</a><a href="#h17-0-218" id="h17-0-218" class="i">+                    ),
</a><a href="#h17-0-219" id="h17-0-219" class="i">+                    Ascending,
</a><a href="#h17-0-220" id="h17-0-220" class="i">+                ),
</a><a href="#h17-0-221" id="h17-0-221" class="i">+            ],
</a><a href="#h17-0-222" id="h17-0-222" class="i">+        },
</a><a href="#h17-0-223" id="h17-0-223" class="i">+        expressions: [
</a><a href="#h17-0-224" id="h17-0-224" class="i">+            (
</a><a href="#h17-0-225" id="h17-0-225" class="i">+                Field(
</a><a href="#h17-0-226" id="h17-0-226" class="i">+                    0,
</a><a href="#h17-0-227" id="h17-0-227" class="i">+                    None,
</a><a href="#h17-0-228" id="h17-0-228" class="i">+                ),
</a><a href="#h17-0-229" id="h17-0-229" class="i">+                None,
</a><a href="#h17-0-230" id="h17-0-230" class="i">+            ),
</a><a href="#h17-0-231" id="h17-0-231" class="i">+            (
</a><a href="#h17-0-232" id="h17-0-232" class="i">+                Field(
</a><a href="#h17-0-233" id="h17-0-233" class="i">+                    1,
</a><a href="#h17-0-234" id="h17-0-234" class="i">+                    None,
</a><a href="#h17-0-235" id="h17-0-235" class="i">+                ),
</a><a href="#h17-0-236" id="h17-0-236" class="i">+                None,
</a><a href="#h17-0-237" id="h17-0-237" class="i">+            ),
</a><a href="#h17-0-238" id="h17-0-238" class="i">+        ],
</a><a href="#h17-0-239" id="h17-0-239" class="i">+    },
</a><a href="#h17-0-240" id="h17-0-240" class="i">+)
</a><a href="#h17-0-241" id="h17-0-241" class="i">+
</a><a href="#h17-0-242" id="h17-0-242" class="i">+Optimized plan: Plan(
</a><a href="#h17-0-243" id="h17-0-243" class="i">+    Projection {
</a><a href="#h17-0-244" id="h17-0-244" class="i">+        source: Order {
</a><a href="#h17-0-245" id="h17-0-245" class="i">+            source: Filter {
</a><a href="#h17-0-246" id="h17-0-246" class="i">+                source: Projection {
</a><a href="#h17-0-247" id="h17-0-247" class="i">+                    source: Aggregation {
</a><a href="#h17-0-248" id="h17-0-248" class="i">+                        source: Projection {
</a><a href="#h17-0-249" id="h17-0-249" class="i">+                            source: Scan {
</a><a href="#h17-0-250" id="h17-0-250" class="i">+                                table: &quot;movies&quot;,
</a><a href="#h17-0-251" id="h17-0-251" class="i">+                                alias: None,
</a><a href="#h17-0-252" id="h17-0-252" class="i">+                                filter: None,
</a><a href="#h17-0-253" id="h17-0-253" class="i">+                            },
</a><a href="#h17-0-254" id="h17-0-254" class="i">+                            expressions: [
</a><a href="#h17-0-255" id="h17-0-255" class="i">+                                (
</a><a href="#h17-0-256" id="h17-0-256" class="i">+                                    Field(
</a><a href="#h17-0-257" id="h17-0-257" class="i">+                                        5,
</a><a href="#h17-0-258" id="h17-0-258" class="i">+                                        Some(
</a><a href="#h17-0-259" id="h17-0-259" class="i">+                                            (
</a><a href="#h17-0-260" id="h17-0-260" class="i">+                                                None,
</a><a href="#h17-0-261" id="h17-0-261" class="i">+                                                &quot;rating&quot;,
</a><a href="#h17-0-262" id="h17-0-262" class="i">+                                            ),
</a><a href="#h17-0-263" id="h17-0-263" class="i">+                                        ),
</a><a href="#h17-0-264" id="h17-0-264" class="i">+                                    ),
</a><a href="#h17-0-265" id="h17-0-265" class="i">+                                    None,
</a><a href="#h17-0-266" id="h17-0-266" class="i">+                                ),
</a><a href="#h17-0-267" id="h17-0-267" class="i">+                                (
</a><a href="#h17-0-268" id="h17-0-268" class="i">+                                    Field(
</a><a href="#h17-0-269" id="h17-0-269" class="i">+                                        5,
</a><a href="#h17-0-270" id="h17-0-270" class="i">+                                        Some(
</a><a href="#h17-0-271" id="h17-0-271" class="i">+                                            (
</a><a href="#h17-0-272" id="h17-0-272" class="i">+                                                None,
</a><a href="#h17-0-273" id="h17-0-273" class="i">+                                                &quot;rating&quot;,
</a><a href="#h17-0-274" id="h17-0-274" class="i">+                                            ),
</a><a href="#h17-0-275" id="h17-0-275" class="i">+                                        ),
</a><a href="#h17-0-276" id="h17-0-276" class="i">+                                    ),
</a><a href="#h17-0-277" id="h17-0-277" class="i">+                                    None,
</a><a href="#h17-0-278" id="h17-0-278" class="i">+                                ),
</a><a href="#h17-0-279" id="h17-0-279" class="i">+                                (
</a><a href="#h17-0-280" id="h17-0-280" class="i">+                                    Field(
</a><a href="#h17-0-281" id="h17-0-281" class="i">+                                        5,
</a><a href="#h17-0-282" id="h17-0-282" class="i">+                                        Some(
</a><a href="#h17-0-283" id="h17-0-283" class="i">+                                            (
</a><a href="#h17-0-284" id="h17-0-284" class="i">+                                                None,
</a><a href="#h17-0-285" id="h17-0-285" class="i">+                                                &quot;rating&quot;,
</a><a href="#h17-0-286" id="h17-0-286" class="i">+                                            ),
</a><a href="#h17-0-287" id="h17-0-287" class="i">+                                        ),
</a><a href="#h17-0-288" id="h17-0-288" class="i">+                                    ),
</a><a href="#h17-0-289" id="h17-0-289" class="i">+                                    None,
</a><a href="#h17-0-290" id="h17-0-290" class="i">+                                ),
</a><a href="#h17-0-291" id="h17-0-291" class="i">+                                (
</a><a href="#h17-0-292" id="h17-0-292" class="i">+                                    Field(
</a><a href="#h17-0-293" id="h17-0-293" class="i">+                                        2,
</a><a href="#h17-0-294" id="h17-0-294" class="i">+                                        Some(
</a><a href="#h17-0-295" id="h17-0-295" class="i">+                                            (
</a><a href="#h17-0-296" id="h17-0-296" class="i">+                                                None,
</a><a href="#h17-0-297" id="h17-0-297" class="i">+                                                &quot;studio_id&quot;,
</a><a href="#h17-0-298" id="h17-0-298" class="i">+                                            ),
</a><a href="#h17-0-299" id="h17-0-299" class="i">+                                        ),
</a><a href="#h17-0-300" id="h17-0-300" class="i">+                                    ),
</a><a href="#h17-0-301" id="h17-0-301" class="i">+                                    None,
</a><a href="#h17-0-302" id="h17-0-302" class="i">+                                ),
</a><a href="#h17-0-303" id="h17-0-303" class="i">+                            ],
</a><a href="#h17-0-304" id="h17-0-304" class="i">+                        },
</a><a href="#h17-0-305" id="h17-0-305" class="i">+                        aggregates: [
</a><a href="#h17-0-306" id="h17-0-306" class="i">+                            Max,
</a><a href="#h17-0-307" id="h17-0-307" class="i">+                            Max,
</a><a href="#h17-0-308" id="h17-0-308" class="i">+                            Min,
</a><a href="#h17-0-309" id="h17-0-309" class="i">+                        ],
</a><a href="#h17-0-310" id="h17-0-310" class="i">+                    },
</a><a href="#h17-0-311" id="h17-0-311" class="i">+                    expressions: [
</a><a href="#h17-0-312" id="h17-0-312" class="i">+                        (
</a><a href="#h17-0-313" id="h17-0-313" class="i">+                            Field(
</a><a href="#h17-0-314" id="h17-0-314" class="i">+                                3,
</a><a href="#h17-0-315" id="h17-0-315" class="i">+                                None,
</a><a href="#h17-0-316" id="h17-0-316" class="i">+                            ),
</a><a href="#h17-0-317" id="h17-0-317" class="i">+                            None,
</a><a href="#h17-0-318" id="h17-0-318" class="i">+                        ),
</a><a href="#h17-0-319" id="h17-0-319" class="i">+                        (
</a><a href="#h17-0-320" id="h17-0-320" class="i">+                            Field(
</a><a href="#h17-0-321" id="h17-0-321" class="i">+                                0,
</a><a href="#h17-0-322" id="h17-0-322" class="i">+                                None,
</a><a href="#h17-0-323" id="h17-0-323" class="i">+                            ),
</a><a href="#h17-0-324" id="h17-0-324" class="i">+                            None,
</a><a href="#h17-0-325" id="h17-0-325" class="i">+                        ),
</a><a href="#h17-0-326" id="h17-0-326" class="i">+                        (
</a><a href="#h17-0-327" id="h17-0-327" class="i">+                            Field(
</a><a href="#h17-0-328" id="h17-0-328" class="i">+                                1,
</a><a href="#h17-0-329" id="h17-0-329" class="i">+                                None,
</a><a href="#h17-0-330" id="h17-0-330" class="i">+                            ),
</a><a href="#h17-0-331" id="h17-0-331" class="i">+                            None,
</a><a href="#h17-0-332" id="h17-0-332" class="i">+                        ),
</a><a href="#h17-0-333" id="h17-0-333" class="i">+                        (
</a><a href="#h17-0-334" id="h17-0-334" class="i">+                            Field(
</a><a href="#h17-0-335" id="h17-0-335" class="i">+                                2,
</a><a href="#h17-0-336" id="h17-0-336" class="i">+                                None,
</a><a href="#h17-0-337" id="h17-0-337" class="i">+                            ),
</a><a href="#h17-0-338" id="h17-0-338" class="i">+                            None,
</a><a href="#h17-0-339" id="h17-0-339" class="i">+                        ),
</a><a href="#h17-0-340" id="h17-0-340" class="i">+                    ],
</a><a href="#h17-0-341" id="h17-0-341" class="i">+                },
</a><a href="#h17-0-342" id="h17-0-342" class="i">+                predicate: LessThan(
</a><a href="#h17-0-343" id="h17-0-343" class="i">+                    Subtract(
</a><a href="#h17-0-344" id="h17-0-344" class="i">+                        Field(
</a><a href="#h17-0-345" id="h17-0-345" class="i">+                            2,
</a><a href="#h17-0-346" id="h17-0-346" class="i">+                            None,
</a><a href="#h17-0-347" id="h17-0-347" class="i">+                        ),
</a><a href="#h17-0-348" id="h17-0-348" class="i">+                        Field(
</a><a href="#h17-0-349" id="h17-0-349" class="i">+                            3,
</a><a href="#h17-0-350" id="h17-0-350" class="i">+                            None,
</a><a href="#h17-0-351" id="h17-0-351" class="i">+                        ),
</a><a href="#h17-0-352" id="h17-0-352" class="i">+                    ),
</a><a href="#h17-0-353" id="h17-0-353" class="i">+                    Constant(
</a><a href="#h17-0-354" id="h17-0-354" class="i">+                        Integer(
</a><a href="#h17-0-355" id="h17-0-355" class="i">+                            1,
</a><a href="#h17-0-356" id="h17-0-356" class="i">+                        ),
</a><a href="#h17-0-357" id="h17-0-357" class="i">+                    ),
</a><a href="#h17-0-358" id="h17-0-358" class="i">+                ),
</a><a href="#h17-0-359" id="h17-0-359" class="i">+            },
</a><a href="#h17-0-360" id="h17-0-360" class="i">+            orders: [
</a><a href="#h17-0-361" id="h17-0-361" class="i">+                (
</a><a href="#h17-0-362" id="h17-0-362" class="i">+                    Field(
</a><a href="#h17-0-363" id="h17-0-363" class="i">+                        0,
</a><a href="#h17-0-364" id="h17-0-364" class="i">+                        None,
</a><a href="#h17-0-365" id="h17-0-365" class="i">+                    ),
</a><a href="#h17-0-366" id="h17-0-366" class="i">+                    Ascending,
</a><a href="#h17-0-367" id="h17-0-367" class="i">+                ),
</a><a href="#h17-0-368" id="h17-0-368" class="i">+            ],
</a><a href="#h17-0-369" id="h17-0-369" class="i">+        },
</a><a href="#h17-0-370" id="h17-0-370" class="i">+        expressions: [
</a><a href="#h17-0-371" id="h17-0-371" class="i">+            (
</a><a href="#h17-0-372" id="h17-0-372" class="i">+                Field(
</a><a href="#h17-0-373" id="h17-0-373" class="i">+                    0,
</a><a href="#h17-0-374" id="h17-0-374" class="i">+                    None,
</a><a href="#h17-0-375" id="h17-0-375" class="i">+                ),
</a><a href="#h17-0-376" id="h17-0-376" class="i">+                None,
</a><a href="#h17-0-377" id="h17-0-377" class="i">+            ),
</a><a href="#h17-0-378" id="h17-0-378" class="i">+            (
</a><a href="#h17-0-379" id="h17-0-379" class="i">+                Field(
</a><a href="#h17-0-380" id="h17-0-380" class="i">+                    1,
</a><a href="#h17-0-381" id="h17-0-381" class="i">+                    None,
</a><a href="#h17-0-382" id="h17-0-382" class="i">+                ),
</a><a href="#h17-0-383" id="h17-0-383" class="i">+                None,
</a><a href="#h17-0-384" id="h17-0-384" class="i">+            ),
</a><a href="#h17-0-385" id="h17-0-385" class="i">+        ],
</a><a href="#h17-0-386" id="h17-0-386" class="i">+    },
</a><a href="#h17-0-387" id="h17-0-387" class="i">+)
</a><a href="#h17-0-388" id="h17-0-388" class="i">+
</a><a href="#h17-0-389" id="h17-0-389" class="i">+Query: SELECT studio_id, MAX(rating) FROM movies GROUP BY studio_id HAVING MAX(rating) - MIN(rating) &lt; 1 ORDER BY studio_id
</a><a href="#h17-0-390" id="h17-0-390" class="i">+
</a><a href="#h17-0-391" id="h17-0-391" class="i">+Result: [&quot;studio_id&quot;, &quot;?&quot;]
</a><a href="#h17-0-392" id="h17-0-392" class="i">+[Integer(1), Float(8.2)]
</a><a href="#h17-0-393" id="h17-0-393" class="i">+[Integer(2), Float(7.6)]
</a><a href="#h17-0-394" id="h17-0-394" class="i">+[Integer(3), Float(6.9)]
</a><b>diff --git a/<a id="h18" href="../file/tests/sql/query/having_aggr_nested.html">tests/sql/query/having_aggr_nested</a> b/<a href="../file/tests/sql/query/having_aggr_nested.html">tests/sql/query/having_aggr_nested</a></b>
<a href="#h18-0" id="h18-0" class="h">@@ -0,0 +1,85 @@
</a><a href="#h18-0-0" id="h18-0-0" class="i">+Query: SELECT studio_id, MAX(rating) AS best FROM movies GROUP BY studio_id HAVING MIN(best) &gt; 7 ORDER BY studio_id
</a><a href="#h18-0-1" id="h18-0-1" class="i">+
</a><a href="#h18-0-2" id="h18-0-2" class="i">+AST: Select {
</a><a href="#h18-0-3" id="h18-0-3" class="i">+    select: SelectClause {
</a><a href="#h18-0-4" id="h18-0-4" class="i">+        expressions: [
</a><a href="#h18-0-5" id="h18-0-5" class="i">+            (
</a><a href="#h18-0-6" id="h18-0-6" class="i">+                Field(
</a><a href="#h18-0-7" id="h18-0-7" class="i">+                    None,
</a><a href="#h18-0-8" id="h18-0-8" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h18-0-9" id="h18-0-9" class="i">+                ),
</a><a href="#h18-0-10" id="h18-0-10" class="i">+                None,
</a><a href="#h18-0-11" id="h18-0-11" class="i">+            ),
</a><a href="#h18-0-12" id="h18-0-12" class="i">+            (
</a><a href="#h18-0-13" id="h18-0-13" class="i">+                Function(
</a><a href="#h18-0-14" id="h18-0-14" class="i">+                    &quot;max&quot;,
</a><a href="#h18-0-15" id="h18-0-15" class="i">+                    [
</a><a href="#h18-0-16" id="h18-0-16" class="i">+                        Field(
</a><a href="#h18-0-17" id="h18-0-17" class="i">+                            None,
</a><a href="#h18-0-18" id="h18-0-18" class="i">+                            &quot;rating&quot;,
</a><a href="#h18-0-19" id="h18-0-19" class="i">+                        ),
</a><a href="#h18-0-20" id="h18-0-20" class="i">+                    ],
</a><a href="#h18-0-21" id="h18-0-21" class="i">+                ),
</a><a href="#h18-0-22" id="h18-0-22" class="i">+                Some(
</a><a href="#h18-0-23" id="h18-0-23" class="i">+                    &quot;best&quot;,
</a><a href="#h18-0-24" id="h18-0-24" class="i">+                ),
</a><a href="#h18-0-25" id="h18-0-25" class="i">+            ),
</a><a href="#h18-0-26" id="h18-0-26" class="i">+        ],
</a><a href="#h18-0-27" id="h18-0-27" class="i">+    },
</a><a href="#h18-0-28" id="h18-0-28" class="i">+    from: Some(
</a><a href="#h18-0-29" id="h18-0-29" class="i">+        FromClause {
</a><a href="#h18-0-30" id="h18-0-30" class="i">+            items: [
</a><a href="#h18-0-31" id="h18-0-31" class="i">+                Table {
</a><a href="#h18-0-32" id="h18-0-32" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h18-0-33" id="h18-0-33" class="i">+                    alias: None,
</a><a href="#h18-0-34" id="h18-0-34" class="i">+                },
</a><a href="#h18-0-35" id="h18-0-35" class="i">+            ],
</a><a href="#h18-0-36" id="h18-0-36" class="i">+        },
</a><a href="#h18-0-37" id="h18-0-37" class="i">+    ),
</a><a href="#h18-0-38" id="h18-0-38" class="i">+    where: None,
</a><a href="#h18-0-39" id="h18-0-39" class="i">+    group_by: Some(
</a><a href="#h18-0-40" id="h18-0-40" class="i">+        GroupByClause(
</a><a href="#h18-0-41" id="h18-0-41" class="i">+            [
</a><a href="#h18-0-42" id="h18-0-42" class="i">+                Field(
</a><a href="#h18-0-43" id="h18-0-43" class="i">+                    None,
</a><a href="#h18-0-44" id="h18-0-44" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h18-0-45" id="h18-0-45" class="i">+                ),
</a><a href="#h18-0-46" id="h18-0-46" class="i">+            ],
</a><a href="#h18-0-47" id="h18-0-47" class="i">+        ),
</a><a href="#h18-0-48" id="h18-0-48" class="i">+    ),
</a><a href="#h18-0-49" id="h18-0-49" class="i">+    having: Some(
</a><a href="#h18-0-50" id="h18-0-50" class="i">+        HavingClause(
</a><a href="#h18-0-51" id="h18-0-51" class="i">+            Operation(
</a><a href="#h18-0-52" id="h18-0-52" class="i">+                GreaterThan(
</a><a href="#h18-0-53" id="h18-0-53" class="i">+                    Function(
</a><a href="#h18-0-54" id="h18-0-54" class="i">+                        &quot;min&quot;,
</a><a href="#h18-0-55" id="h18-0-55" class="i">+                        [
</a><a href="#h18-0-56" id="h18-0-56" class="i">+                            Field(
</a><a href="#h18-0-57" id="h18-0-57" class="i">+                                None,
</a><a href="#h18-0-58" id="h18-0-58" class="i">+                                &quot;best&quot;,
</a><a href="#h18-0-59" id="h18-0-59" class="i">+                            ),
</a><a href="#h18-0-60" id="h18-0-60" class="i">+                        ],
</a><a href="#h18-0-61" id="h18-0-61" class="i">+                    ),
</a><a href="#h18-0-62" id="h18-0-62" class="i">+                    Literal(
</a><a href="#h18-0-63" id="h18-0-63" class="i">+                        Integer(
</a><a href="#h18-0-64" id="h18-0-64" class="i">+                            7,
</a><a href="#h18-0-65" id="h18-0-65" class="i">+                        ),
</a><a href="#h18-0-66" id="h18-0-66" class="i">+                    ),
</a><a href="#h18-0-67" id="h18-0-67" class="i">+                ),
</a><a href="#h18-0-68" id="h18-0-68" class="i">+            ),
</a><a href="#h18-0-69" id="h18-0-69" class="i">+        ),
</a><a href="#h18-0-70" id="h18-0-70" class="i">+    ),
</a><a href="#h18-0-71" id="h18-0-71" class="i">+    order: [
</a><a href="#h18-0-72" id="h18-0-72" class="i">+        (
</a><a href="#h18-0-73" id="h18-0-73" class="i">+            Field(
</a><a href="#h18-0-74" id="h18-0-74" class="i">+                None,
</a><a href="#h18-0-75" id="h18-0-75" class="i">+                &quot;studio_id&quot;,
</a><a href="#h18-0-76" id="h18-0-76" class="i">+            ),
</a><a href="#h18-0-77" id="h18-0-77" class="i">+            Ascending,
</a><a href="#h18-0-78" id="h18-0-78" class="i">+        ),
</a><a href="#h18-0-79" id="h18-0-79" class="i">+    ],
</a><a href="#h18-0-80" id="h18-0-80" class="i">+    offset: None,
</a><a href="#h18-0-81" id="h18-0-81" class="i">+    limit: None,
</a><a href="#h18-0-82" id="h18-0-82" class="i">+}
</a><a href="#h18-0-83" id="h18-0-83" class="i">+
</a><a href="#h18-0-84" id="h18-0-84" class="i">+Plan: Value(&quot;Aggregate function cannot reference aggregate&quot;)
</a><a href="#h18-0-85" id="h18-0-85" class="i">+\ No newline at end of file
</a><b>diff --git a/<a id="h19" href="../file/tests/sql/query/having_noaggr.html">tests/sql/query/having_noaggr</a> b/<a href="../file/tests/sql/query/having_noaggr.html">tests/sql/query/having_noaggr</a></b>
<a href="#h19-0" id="h19-0" class="h">@@ -0,0 +1,340 @@
</a><a href="#h19-0-0" id="h19-0-0" class="i">+Query: SELECT studio_id, MAX(rating) AS rating FROM movies GROUP BY studio_id HAVING studio_id &gt;= 3 ORDER BY studio_id
</a><a href="#h19-0-1" id="h19-0-1" class="i">+
</a><a href="#h19-0-2" id="h19-0-2" class="i">+AST: Select {
</a><a href="#h19-0-3" id="h19-0-3" class="i">+    select: SelectClause {
</a><a href="#h19-0-4" id="h19-0-4" class="i">+        expressions: [
</a><a href="#h19-0-5" id="h19-0-5" class="i">+            (
</a><a href="#h19-0-6" id="h19-0-6" class="i">+                Field(
</a><a href="#h19-0-7" id="h19-0-7" class="i">+                    None,
</a><a href="#h19-0-8" id="h19-0-8" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h19-0-9" id="h19-0-9" class="i">+                ),
</a><a href="#h19-0-10" id="h19-0-10" class="i">+                None,
</a><a href="#h19-0-11" id="h19-0-11" class="i">+            ),
</a><a href="#h19-0-12" id="h19-0-12" class="i">+            (
</a><a href="#h19-0-13" id="h19-0-13" class="i">+                Function(
</a><a href="#h19-0-14" id="h19-0-14" class="i">+                    &quot;max&quot;,
</a><a href="#h19-0-15" id="h19-0-15" class="i">+                    [
</a><a href="#h19-0-16" id="h19-0-16" class="i">+                        Field(
</a><a href="#h19-0-17" id="h19-0-17" class="i">+                            None,
</a><a href="#h19-0-18" id="h19-0-18" class="i">+                            &quot;rating&quot;,
</a><a href="#h19-0-19" id="h19-0-19" class="i">+                        ),
</a><a href="#h19-0-20" id="h19-0-20" class="i">+                    ],
</a><a href="#h19-0-21" id="h19-0-21" class="i">+                ),
</a><a href="#h19-0-22" id="h19-0-22" class="i">+                Some(
</a><a href="#h19-0-23" id="h19-0-23" class="i">+                    &quot;rating&quot;,
</a><a href="#h19-0-24" id="h19-0-24" class="i">+                ),
</a><a href="#h19-0-25" id="h19-0-25" class="i">+            ),
</a><a href="#h19-0-26" id="h19-0-26" class="i">+        ],
</a><a href="#h19-0-27" id="h19-0-27" class="i">+    },
</a><a href="#h19-0-28" id="h19-0-28" class="i">+    from: Some(
</a><a href="#h19-0-29" id="h19-0-29" class="i">+        FromClause {
</a><a href="#h19-0-30" id="h19-0-30" class="i">+            items: [
</a><a href="#h19-0-31" id="h19-0-31" class="i">+                Table {
</a><a href="#h19-0-32" id="h19-0-32" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h19-0-33" id="h19-0-33" class="i">+                    alias: None,
</a><a href="#h19-0-34" id="h19-0-34" class="i">+                },
</a><a href="#h19-0-35" id="h19-0-35" class="i">+            ],
</a><a href="#h19-0-36" id="h19-0-36" class="i">+        },
</a><a href="#h19-0-37" id="h19-0-37" class="i">+    ),
</a><a href="#h19-0-38" id="h19-0-38" class="i">+    where: None,
</a><a href="#h19-0-39" id="h19-0-39" class="i">+    group_by: Some(
</a><a href="#h19-0-40" id="h19-0-40" class="i">+        GroupByClause(
</a><a href="#h19-0-41" id="h19-0-41" class="i">+            [
</a><a href="#h19-0-42" id="h19-0-42" class="i">+                Field(
</a><a href="#h19-0-43" id="h19-0-43" class="i">+                    None,
</a><a href="#h19-0-44" id="h19-0-44" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h19-0-45" id="h19-0-45" class="i">+                ),
</a><a href="#h19-0-46" id="h19-0-46" class="i">+            ],
</a><a href="#h19-0-47" id="h19-0-47" class="i">+        ),
</a><a href="#h19-0-48" id="h19-0-48" class="i">+    ),
</a><a href="#h19-0-49" id="h19-0-49" class="i">+    having: Some(
</a><a href="#h19-0-50" id="h19-0-50" class="i">+        HavingClause(
</a><a href="#h19-0-51" id="h19-0-51" class="i">+            Operation(
</a><a href="#h19-0-52" id="h19-0-52" class="i">+                GreaterThanOrEqual(
</a><a href="#h19-0-53" id="h19-0-53" class="i">+                    Field(
</a><a href="#h19-0-54" id="h19-0-54" class="i">+                        None,
</a><a href="#h19-0-55" id="h19-0-55" class="i">+                        &quot;studio_id&quot;,
</a><a href="#h19-0-56" id="h19-0-56" class="i">+                    ),
</a><a href="#h19-0-57" id="h19-0-57" class="i">+                    Literal(
</a><a href="#h19-0-58" id="h19-0-58" class="i">+                        Integer(
</a><a href="#h19-0-59" id="h19-0-59" class="i">+                            3,
</a><a href="#h19-0-60" id="h19-0-60" class="i">+                        ),
</a><a href="#h19-0-61" id="h19-0-61" class="i">+                    ),
</a><a href="#h19-0-62" id="h19-0-62" class="i">+                ),
</a><a href="#h19-0-63" id="h19-0-63" class="i">+            ),
</a><a href="#h19-0-64" id="h19-0-64" class="i">+        ),
</a><a href="#h19-0-65" id="h19-0-65" class="i">+    ),
</a><a href="#h19-0-66" id="h19-0-66" class="i">+    order: [
</a><a href="#h19-0-67" id="h19-0-67" class="i">+        (
</a><a href="#h19-0-68" id="h19-0-68" class="i">+            Field(
</a><a href="#h19-0-69" id="h19-0-69" class="i">+                None,
</a><a href="#h19-0-70" id="h19-0-70" class="i">+                &quot;studio_id&quot;,
</a><a href="#h19-0-71" id="h19-0-71" class="i">+            ),
</a><a href="#h19-0-72" id="h19-0-72" class="i">+            Ascending,
</a><a href="#h19-0-73" id="h19-0-73" class="i">+        ),
</a><a href="#h19-0-74" id="h19-0-74" class="i">+    ],
</a><a href="#h19-0-75" id="h19-0-75" class="i">+    offset: None,
</a><a href="#h19-0-76" id="h19-0-76" class="i">+    limit: None,
</a><a href="#h19-0-77" id="h19-0-77" class="i">+}
</a><a href="#h19-0-78" id="h19-0-78" class="i">+
</a><a href="#h19-0-79" id="h19-0-79" class="i">+Plan: Plan(
</a><a href="#h19-0-80" id="h19-0-80" class="i">+    Projection {
</a><a href="#h19-0-81" id="h19-0-81" class="i">+        source: Order {
</a><a href="#h19-0-82" id="h19-0-82" class="i">+            source: Filter {
</a><a href="#h19-0-83" id="h19-0-83" class="i">+                source: Projection {
</a><a href="#h19-0-84" id="h19-0-84" class="i">+                    source: Aggregation {
</a><a href="#h19-0-85" id="h19-0-85" class="i">+                        source: Projection {
</a><a href="#h19-0-86" id="h19-0-86" class="i">+                            source: Scan {
</a><a href="#h19-0-87" id="h19-0-87" class="i">+                                table: &quot;movies&quot;,
</a><a href="#h19-0-88" id="h19-0-88" class="i">+                                alias: None,
</a><a href="#h19-0-89" id="h19-0-89" class="i">+                                filter: None,
</a><a href="#h19-0-90" id="h19-0-90" class="i">+                            },
</a><a href="#h19-0-91" id="h19-0-91" class="i">+                            expressions: [
</a><a href="#h19-0-92" id="h19-0-92" class="i">+                                (
</a><a href="#h19-0-93" id="h19-0-93" class="i">+                                    Field(
</a><a href="#h19-0-94" id="h19-0-94" class="i">+                                        5,
</a><a href="#h19-0-95" id="h19-0-95" class="i">+                                        Some(
</a><a href="#h19-0-96" id="h19-0-96" class="i">+                                            (
</a><a href="#h19-0-97" id="h19-0-97" class="i">+                                                None,
</a><a href="#h19-0-98" id="h19-0-98" class="i">+                                                &quot;rating&quot;,
</a><a href="#h19-0-99" id="h19-0-99" class="i">+                                            ),
</a><a href="#h19-0-100" id="h19-0-100" class="i">+                                        ),
</a><a href="#h19-0-101" id="h19-0-101" class="i">+                                    ),
</a><a href="#h19-0-102" id="h19-0-102" class="i">+                                    None,
</a><a href="#h19-0-103" id="h19-0-103" class="i">+                                ),
</a><a href="#h19-0-104" id="h19-0-104" class="i">+                                (
</a><a href="#h19-0-105" id="h19-0-105" class="i">+                                    Field(
</a><a href="#h19-0-106" id="h19-0-106" class="i">+                                        2,
</a><a href="#h19-0-107" id="h19-0-107" class="i">+                                        Some(
</a><a href="#h19-0-108" id="h19-0-108" class="i">+                                            (
</a><a href="#h19-0-109" id="h19-0-109" class="i">+                                                None,
</a><a href="#h19-0-110" id="h19-0-110" class="i">+                                                &quot;studio_id&quot;,
</a><a href="#h19-0-111" id="h19-0-111" class="i">+                                            ),
</a><a href="#h19-0-112" id="h19-0-112" class="i">+                                        ),
</a><a href="#h19-0-113" id="h19-0-113" class="i">+                                    ),
</a><a href="#h19-0-114" id="h19-0-114" class="i">+                                    None,
</a><a href="#h19-0-115" id="h19-0-115" class="i">+                                ),
</a><a href="#h19-0-116" id="h19-0-116" class="i">+                            ],
</a><a href="#h19-0-117" id="h19-0-117" class="i">+                        },
</a><a href="#h19-0-118" id="h19-0-118" class="i">+                        aggregates: [
</a><a href="#h19-0-119" id="h19-0-119" class="i">+                            Max,
</a><a href="#h19-0-120" id="h19-0-120" class="i">+                        ],
</a><a href="#h19-0-121" id="h19-0-121" class="i">+                    },
</a><a href="#h19-0-122" id="h19-0-122" class="i">+                    expressions: [
</a><a href="#h19-0-123" id="h19-0-123" class="i">+                        (
</a><a href="#h19-0-124" id="h19-0-124" class="i">+                            Field(
</a><a href="#h19-0-125" id="h19-0-125" class="i">+                                1,
</a><a href="#h19-0-126" id="h19-0-126" class="i">+                                None,
</a><a href="#h19-0-127" id="h19-0-127" class="i">+                            ),
</a><a href="#h19-0-128" id="h19-0-128" class="i">+                            None,
</a><a href="#h19-0-129" id="h19-0-129" class="i">+                        ),
</a><a href="#h19-0-130" id="h19-0-130" class="i">+                        (
</a><a href="#h19-0-131" id="h19-0-131" class="i">+                            Field(
</a><a href="#h19-0-132" id="h19-0-132" class="i">+                                0,
</a><a href="#h19-0-133" id="h19-0-133" class="i">+                                None,
</a><a href="#h19-0-134" id="h19-0-134" class="i">+                            ),
</a><a href="#h19-0-135" id="h19-0-135" class="i">+                            Some(
</a><a href="#h19-0-136" id="h19-0-136" class="i">+                                &quot;rating&quot;,
</a><a href="#h19-0-137" id="h19-0-137" class="i">+                            ),
</a><a href="#h19-0-138" id="h19-0-138" class="i">+                        ),
</a><a href="#h19-0-139" id="h19-0-139" class="i">+                        (
</a><a href="#h19-0-140" id="h19-0-140" class="i">+                            Field(
</a><a href="#h19-0-141" id="h19-0-141" class="i">+                                1,
</a><a href="#h19-0-142" id="h19-0-142" class="i">+                                Some(
</a><a href="#h19-0-143" id="h19-0-143" class="i">+                                    (
</a><a href="#h19-0-144" id="h19-0-144" class="i">+                                        None,
</a><a href="#h19-0-145" id="h19-0-145" class="i">+                                        &quot;studio_id&quot;,
</a><a href="#h19-0-146" id="h19-0-146" class="i">+                                    ),
</a><a href="#h19-0-147" id="h19-0-147" class="i">+                                ),
</a><a href="#h19-0-148" id="h19-0-148" class="i">+                            ),
</a><a href="#h19-0-149" id="h19-0-149" class="i">+                            None,
</a><a href="#h19-0-150" id="h19-0-150" class="i">+                        ),
</a><a href="#h19-0-151" id="h19-0-151" class="i">+                    ],
</a><a href="#h19-0-152" id="h19-0-152" class="i">+                },
</a><a href="#h19-0-153" id="h19-0-153" class="i">+                predicate: Or(
</a><a href="#h19-0-154" id="h19-0-154" class="i">+                    GreaterThan(
</a><a href="#h19-0-155" id="h19-0-155" class="i">+                        Field(
</a><a href="#h19-0-156" id="h19-0-156" class="i">+                            2,
</a><a href="#h19-0-157" id="h19-0-157" class="i">+                            None,
</a><a href="#h19-0-158" id="h19-0-158" class="i">+                        ),
</a><a href="#h19-0-159" id="h19-0-159" class="i">+                        Constant(
</a><a href="#h19-0-160" id="h19-0-160" class="i">+                            Integer(
</a><a href="#h19-0-161" id="h19-0-161" class="i">+                                3,
</a><a href="#h19-0-162" id="h19-0-162" class="i">+                            ),
</a><a href="#h19-0-163" id="h19-0-163" class="i">+                        ),
</a><a href="#h19-0-164" id="h19-0-164" class="i">+                    ),
</a><a href="#h19-0-165" id="h19-0-165" class="i">+                    Equal(
</a><a href="#h19-0-166" id="h19-0-166" class="i">+                        Field(
</a><a href="#h19-0-167" id="h19-0-167" class="i">+                            2,
</a><a href="#h19-0-168" id="h19-0-168" class="i">+                            None,
</a><a href="#h19-0-169" id="h19-0-169" class="i">+                        ),
</a><a href="#h19-0-170" id="h19-0-170" class="i">+                        Constant(
</a><a href="#h19-0-171" id="h19-0-171" class="i">+                            Integer(
</a><a href="#h19-0-172" id="h19-0-172" class="i">+                                3,
</a><a href="#h19-0-173" id="h19-0-173" class="i">+                            ),
</a><a href="#h19-0-174" id="h19-0-174" class="i">+                        ),
</a><a href="#h19-0-175" id="h19-0-175" class="i">+                    ),
</a><a href="#h19-0-176" id="h19-0-176" class="i">+                ),
</a><a href="#h19-0-177" id="h19-0-177" class="i">+            },
</a><a href="#h19-0-178" id="h19-0-178" class="i">+            orders: [
</a><a href="#h19-0-179" id="h19-0-179" class="i">+                (
</a><a href="#h19-0-180" id="h19-0-180" class="i">+                    Field(
</a><a href="#h19-0-181" id="h19-0-181" class="i">+                        0,
</a><a href="#h19-0-182" id="h19-0-182" class="i">+                        None,
</a><a href="#h19-0-183" id="h19-0-183" class="i">+                    ),
</a><a href="#h19-0-184" id="h19-0-184" class="i">+                    Ascending,
</a><a href="#h19-0-185" id="h19-0-185" class="i">+                ),
</a><a href="#h19-0-186" id="h19-0-186" class="i">+            ],
</a><a href="#h19-0-187" id="h19-0-187" class="i">+        },
</a><a href="#h19-0-188" id="h19-0-188" class="i">+        expressions: [
</a><a href="#h19-0-189" id="h19-0-189" class="i">+            (
</a><a href="#h19-0-190" id="h19-0-190" class="i">+                Field(
</a><a href="#h19-0-191" id="h19-0-191" class="i">+                    0,
</a><a href="#h19-0-192" id="h19-0-192" class="i">+                    None,
</a><a href="#h19-0-193" id="h19-0-193" class="i">+                ),
</a><a href="#h19-0-194" id="h19-0-194" class="i">+                None,
</a><a href="#h19-0-195" id="h19-0-195" class="i">+            ),
</a><a href="#h19-0-196" id="h19-0-196" class="i">+            (
</a><a href="#h19-0-197" id="h19-0-197" class="i">+                Field(
</a><a href="#h19-0-198" id="h19-0-198" class="i">+                    1,
</a><a href="#h19-0-199" id="h19-0-199" class="i">+                    None,
</a><a href="#h19-0-200" id="h19-0-200" class="i">+                ),
</a><a href="#h19-0-201" id="h19-0-201" class="i">+                None,
</a><a href="#h19-0-202" id="h19-0-202" class="i">+            ),
</a><a href="#h19-0-203" id="h19-0-203" class="i">+        ],
</a><a href="#h19-0-204" id="h19-0-204" class="i">+    },
</a><a href="#h19-0-205" id="h19-0-205" class="i">+)
</a><a href="#h19-0-206" id="h19-0-206" class="i">+
</a><a href="#h19-0-207" id="h19-0-207" class="i">+Optimized plan: Plan(
</a><a href="#h19-0-208" id="h19-0-208" class="i">+    Projection {
</a><a href="#h19-0-209" id="h19-0-209" class="i">+        source: Order {
</a><a href="#h19-0-210" id="h19-0-210" class="i">+            source: Filter {
</a><a href="#h19-0-211" id="h19-0-211" class="i">+                source: Projection {
</a><a href="#h19-0-212" id="h19-0-212" class="i">+                    source: Aggregation {
</a><a href="#h19-0-213" id="h19-0-213" class="i">+                        source: Projection {
</a><a href="#h19-0-214" id="h19-0-214" class="i">+                            source: Scan {
</a><a href="#h19-0-215" id="h19-0-215" class="i">+                                table: &quot;movies&quot;,
</a><a href="#h19-0-216" id="h19-0-216" class="i">+                                alias: None,
</a><a href="#h19-0-217" id="h19-0-217" class="i">+                                filter: None,
</a><a href="#h19-0-218" id="h19-0-218" class="i">+                            },
</a><a href="#h19-0-219" id="h19-0-219" class="i">+                            expressions: [
</a><a href="#h19-0-220" id="h19-0-220" class="i">+                                (
</a><a href="#h19-0-221" id="h19-0-221" class="i">+                                    Field(
</a><a href="#h19-0-222" id="h19-0-222" class="i">+                                        5,
</a><a href="#h19-0-223" id="h19-0-223" class="i">+                                        Some(
</a><a href="#h19-0-224" id="h19-0-224" class="i">+                                            (
</a><a href="#h19-0-225" id="h19-0-225" class="i">+                                                None,
</a><a href="#h19-0-226" id="h19-0-226" class="i">+                                                &quot;rating&quot;,
</a><a href="#h19-0-227" id="h19-0-227" class="i">+                                            ),
</a><a href="#h19-0-228" id="h19-0-228" class="i">+                                        ),
</a><a href="#h19-0-229" id="h19-0-229" class="i">+                                    ),
</a><a href="#h19-0-230" id="h19-0-230" class="i">+                                    None,
</a><a href="#h19-0-231" id="h19-0-231" class="i">+                                ),
</a><a href="#h19-0-232" id="h19-0-232" class="i">+                                (
</a><a href="#h19-0-233" id="h19-0-233" class="i">+                                    Field(
</a><a href="#h19-0-234" id="h19-0-234" class="i">+                                        2,
</a><a href="#h19-0-235" id="h19-0-235" class="i">+                                        Some(
</a><a href="#h19-0-236" id="h19-0-236" class="i">+                                            (
</a><a href="#h19-0-237" id="h19-0-237" class="i">+                                                None,
</a><a href="#h19-0-238" id="h19-0-238" class="i">+                                                &quot;studio_id&quot;,
</a><a href="#h19-0-239" id="h19-0-239" class="i">+                                            ),
</a><a href="#h19-0-240" id="h19-0-240" class="i">+                                        ),
</a><a href="#h19-0-241" id="h19-0-241" class="i">+                                    ),
</a><a href="#h19-0-242" id="h19-0-242" class="i">+                                    None,
</a><a href="#h19-0-243" id="h19-0-243" class="i">+                                ),
</a><a href="#h19-0-244" id="h19-0-244" class="i">+                            ],
</a><a href="#h19-0-245" id="h19-0-245" class="i">+                        },
</a><a href="#h19-0-246" id="h19-0-246" class="i">+                        aggregates: [
</a><a href="#h19-0-247" id="h19-0-247" class="i">+                            Max,
</a><a href="#h19-0-248" id="h19-0-248" class="i">+                        ],
</a><a href="#h19-0-249" id="h19-0-249" class="i">+                    },
</a><a href="#h19-0-250" id="h19-0-250" class="i">+                    expressions: [
</a><a href="#h19-0-251" id="h19-0-251" class="i">+                        (
</a><a href="#h19-0-252" id="h19-0-252" class="i">+                            Field(
</a><a href="#h19-0-253" id="h19-0-253" class="i">+                                1,
</a><a href="#h19-0-254" id="h19-0-254" class="i">+                                None,
</a><a href="#h19-0-255" id="h19-0-255" class="i">+                            ),
</a><a href="#h19-0-256" id="h19-0-256" class="i">+                            None,
</a><a href="#h19-0-257" id="h19-0-257" class="i">+                        ),
</a><a href="#h19-0-258" id="h19-0-258" class="i">+                        (
</a><a href="#h19-0-259" id="h19-0-259" class="i">+                            Field(
</a><a href="#h19-0-260" id="h19-0-260" class="i">+                                0,
</a><a href="#h19-0-261" id="h19-0-261" class="i">+                                None,
</a><a href="#h19-0-262" id="h19-0-262" class="i">+                            ),
</a><a href="#h19-0-263" id="h19-0-263" class="i">+                            Some(
</a><a href="#h19-0-264" id="h19-0-264" class="i">+                                &quot;rating&quot;,
</a><a href="#h19-0-265" id="h19-0-265" class="i">+                            ),
</a><a href="#h19-0-266" id="h19-0-266" class="i">+                        ),
</a><a href="#h19-0-267" id="h19-0-267" class="i">+                        (
</a><a href="#h19-0-268" id="h19-0-268" class="i">+                            Field(
</a><a href="#h19-0-269" id="h19-0-269" class="i">+                                1,
</a><a href="#h19-0-270" id="h19-0-270" class="i">+                                Some(
</a><a href="#h19-0-271" id="h19-0-271" class="i">+                                    (
</a><a href="#h19-0-272" id="h19-0-272" class="i">+                                        None,
</a><a href="#h19-0-273" id="h19-0-273" class="i">+                                        &quot;studio_id&quot;,
</a><a href="#h19-0-274" id="h19-0-274" class="i">+                                    ),
</a><a href="#h19-0-275" id="h19-0-275" class="i">+                                ),
</a><a href="#h19-0-276" id="h19-0-276" class="i">+                            ),
</a><a href="#h19-0-277" id="h19-0-277" class="i">+                            None,
</a><a href="#h19-0-278" id="h19-0-278" class="i">+                        ),
</a><a href="#h19-0-279" id="h19-0-279" class="i">+                    ],
</a><a href="#h19-0-280" id="h19-0-280" class="i">+                },
</a><a href="#h19-0-281" id="h19-0-281" class="i">+                predicate: Or(
</a><a href="#h19-0-282" id="h19-0-282" class="i">+                    GreaterThan(
</a><a href="#h19-0-283" id="h19-0-283" class="i">+                        Field(
</a><a href="#h19-0-284" id="h19-0-284" class="i">+                            2,
</a><a href="#h19-0-285" id="h19-0-285" class="i">+                            None,
</a><a href="#h19-0-286" id="h19-0-286" class="i">+                        ),
</a><a href="#h19-0-287" id="h19-0-287" class="i">+                        Constant(
</a><a href="#h19-0-288" id="h19-0-288" class="i">+                            Integer(
</a><a href="#h19-0-289" id="h19-0-289" class="i">+                                3,
</a><a href="#h19-0-290" id="h19-0-290" class="i">+                            ),
</a><a href="#h19-0-291" id="h19-0-291" class="i">+                        ),
</a><a href="#h19-0-292" id="h19-0-292" class="i">+                    ),
</a><a href="#h19-0-293" id="h19-0-293" class="i">+                    Equal(
</a><a href="#h19-0-294" id="h19-0-294" class="i">+                        Field(
</a><a href="#h19-0-295" id="h19-0-295" class="i">+                            2,
</a><a href="#h19-0-296" id="h19-0-296" class="i">+                            None,
</a><a href="#h19-0-297" id="h19-0-297" class="i">+                        ),
</a><a href="#h19-0-298" id="h19-0-298" class="i">+                        Constant(
</a><a href="#h19-0-299" id="h19-0-299" class="i">+                            Integer(
</a><a href="#h19-0-300" id="h19-0-300" class="i">+                                3,
</a><a href="#h19-0-301" id="h19-0-301" class="i">+                            ),
</a><a href="#h19-0-302" id="h19-0-302" class="i">+                        ),
</a><a href="#h19-0-303" id="h19-0-303" class="i">+                    ),
</a><a href="#h19-0-304" id="h19-0-304" class="i">+                ),
</a><a href="#h19-0-305" id="h19-0-305" class="i">+            },
</a><a href="#h19-0-306" id="h19-0-306" class="i">+            orders: [
</a><a href="#h19-0-307" id="h19-0-307" class="i">+                (
</a><a href="#h19-0-308" id="h19-0-308" class="i">+                    Field(
</a><a href="#h19-0-309" id="h19-0-309" class="i">+                        0,
</a><a href="#h19-0-310" id="h19-0-310" class="i">+                        None,
</a><a href="#h19-0-311" id="h19-0-311" class="i">+                    ),
</a><a href="#h19-0-312" id="h19-0-312" class="i">+                    Ascending,
</a><a href="#h19-0-313" id="h19-0-313" class="i">+                ),
</a><a href="#h19-0-314" id="h19-0-314" class="i">+            ],
</a><a href="#h19-0-315" id="h19-0-315" class="i">+        },
</a><a href="#h19-0-316" id="h19-0-316" class="i">+        expressions: [
</a><a href="#h19-0-317" id="h19-0-317" class="i">+            (
</a><a href="#h19-0-318" id="h19-0-318" class="i">+                Field(
</a><a href="#h19-0-319" id="h19-0-319" class="i">+                    0,
</a><a href="#h19-0-320" id="h19-0-320" class="i">+                    None,
</a><a href="#h19-0-321" id="h19-0-321" class="i">+                ),
</a><a href="#h19-0-322" id="h19-0-322" class="i">+                None,
</a><a href="#h19-0-323" id="h19-0-323" class="i">+            ),
</a><a href="#h19-0-324" id="h19-0-324" class="i">+            (
</a><a href="#h19-0-325" id="h19-0-325" class="i">+                Field(
</a><a href="#h19-0-326" id="h19-0-326" class="i">+                    1,
</a><a href="#h19-0-327" id="h19-0-327" class="i">+                    None,
</a><a href="#h19-0-328" id="h19-0-328" class="i">+                ),
</a><a href="#h19-0-329" id="h19-0-329" class="i">+                None,
</a><a href="#h19-0-330" id="h19-0-330" class="i">+            ),
</a><a href="#h19-0-331" id="h19-0-331" class="i">+        ],
</a><a href="#h19-0-332" id="h19-0-332" class="i">+    },
</a><a href="#h19-0-333" id="h19-0-333" class="i">+)
</a><a href="#h19-0-334" id="h19-0-334" class="i">+
</a><a href="#h19-0-335" id="h19-0-335" class="i">+Query: SELECT studio_id, MAX(rating) AS rating FROM movies GROUP BY studio_id HAVING studio_id &gt;= 3 ORDER BY studio_id
</a><a href="#h19-0-336" id="h19-0-336" class="i">+
</a><a href="#h19-0-337" id="h19-0-337" class="i">+Result: [&quot;studio_id&quot;, &quot;rating&quot;]
</a><a href="#h19-0-338" id="h19-0-338" class="i">+[Integer(3), Float(6.9)]
</a><a href="#h19-0-339" id="h19-0-339" class="i">+[Integer(4), Float(8.8)]
</a><b>diff --git a/<a id="h20" href="../file/tests/sql/query/having_nogroup.html">tests/sql/query/having_nogroup</a> b/<a href="../file/tests/sql/query/having_nogroup.html">tests/sql/query/having_nogroup</a></b>
<a href="#h20-0" id="h20-0" class="h">@@ -62,140 +62,180 @@ AST: Select {
</a> }
 
 Plan: Plan(
<a href="#h20-0-3" id="h20-0-3" class="d">-    Order {
</a><a href="#h20-0-4" id="h20-0-4" class="d">-        source: Filter {
</a><a href="#h20-0-5" id="h20-0-5" class="d">-            source: Projection {
</a><a href="#h20-0-6" id="h20-0-6" class="d">-                source: Scan {
</a><a href="#h20-0-7" id="h20-0-7" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h20-0-8" id="h20-0-8" class="d">-                    alias: None,
</a><a href="#h20-0-9" id="h20-0-9" class="d">-                    filter: None,
</a><a href="#h20-0-10" id="h20-0-10" class="d">-                },
</a><a href="#h20-0-11" id="h20-0-11" class="d">-                expressions: [
</a><a href="#h20-0-12" id="h20-0-12" class="d">-                    (
</a><a href="#h20-0-13" id="h20-0-13" class="d">-                        Field(
</a><a href="#h20-0-14" id="h20-0-14" class="d">-                            0,
</a><a href="#h20-0-15" id="h20-0-15" class="d">-                            Some(
</a><a href="#h20-0-16" id="h20-0-16" class="d">-                                (
</a><a href="#h20-0-17" id="h20-0-17" class="d">-                                    None,
</a><a href="#h20-0-18" id="h20-0-18" class="d">-                                    &quot;id&quot;,
</a><a href="#h20-0-19" id="h20-0-19" class="i">+    Projection {
</a><a href="#h20-0-20" id="h20-0-20" class="i">+        source: Order {
</a><a href="#h20-0-21" id="h20-0-21" class="i">+            source: Filter {
</a><a href="#h20-0-22" id="h20-0-22" class="i">+                source: Projection {
</a><a href="#h20-0-23" id="h20-0-23" class="i">+                    source: Scan {
</a><a href="#h20-0-24" id="h20-0-24" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h20-0-25" id="h20-0-25" class="i">+                        alias: None,
</a><a href="#h20-0-26" id="h20-0-26" class="i">+                        filter: None,
</a><a href="#h20-0-27" id="h20-0-27" class="i">+                    },
</a><a href="#h20-0-28" id="h20-0-28" class="i">+                    expressions: [
</a><a href="#h20-0-29" id="h20-0-29" class="i">+                        (
</a><a href="#h20-0-30" id="h20-0-30" class="i">+                            Field(
</a><a href="#h20-0-31" id="h20-0-31" class="i">+                                0,
</a><a href="#h20-0-32" id="h20-0-32" class="i">+                                Some(
</a><a href="#h20-0-33" id="h20-0-33" class="i">+                                    (
</a><a href="#h20-0-34" id="h20-0-34" class="i">+                                        None,
</a><a href="#h20-0-35" id="h20-0-35" class="i">+                                        &quot;id&quot;,
</a><a href="#h20-0-36" id="h20-0-36" class="i">+                                    ),
</a>                                 ),
                             ),
<a href="#h20-0-39" id="h20-0-39" class="i">+                            None,
</a>                         ),
<a href="#h20-0-41" id="h20-0-41" class="d">-                        None,
</a><a href="#h20-0-42" id="h20-0-42" class="d">-                    ),
</a><a href="#h20-0-43" id="h20-0-43" class="d">-                    (
</a><a href="#h20-0-44" id="h20-0-44" class="d">-                        Field(
</a><a href="#h20-0-45" id="h20-0-45" class="d">-                            5,
</a><a href="#h20-0-46" id="h20-0-46" class="d">-                            Some(
</a><a href="#h20-0-47" id="h20-0-47" class="d">-                                (
</a><a href="#h20-0-48" id="h20-0-48" class="d">-                                    None,
</a><a href="#h20-0-49" id="h20-0-49" class="d">-                                    &quot;rating&quot;,
</a><a href="#h20-0-50" id="h20-0-50" class="i">+                        (
</a><a href="#h20-0-51" id="h20-0-51" class="i">+                            Field(
</a><a href="#h20-0-52" id="h20-0-52" class="i">+                                5,
</a><a href="#h20-0-53" id="h20-0-53" class="i">+                                Some(
</a><a href="#h20-0-54" id="h20-0-54" class="i">+                                    (
</a><a href="#h20-0-55" id="h20-0-55" class="i">+                                        None,
</a><a href="#h20-0-56" id="h20-0-56" class="i">+                                        &quot;rating&quot;,
</a><a href="#h20-0-57" id="h20-0-57" class="i">+                                    ),
</a>                                 ),
                             ),
<a href="#h20-0-60" id="h20-0-60" class="i">+                            None,
</a>                         ),
<a href="#h20-0-62" id="h20-0-62" class="d">-                        None,
</a><a href="#h20-0-63" id="h20-0-63" class="d">-                    ),
</a><a href="#h20-0-64" id="h20-0-64" class="d">-                ],
</a><a href="#h20-0-65" id="h20-0-65" class="d">-            },
</a><a href="#h20-0-66" id="h20-0-66" class="d">-            predicate: GreaterThan(
</a><a href="#h20-0-67" id="h20-0-67" class="d">-                Field(
</a><a href="#h20-0-68" id="h20-0-68" class="d">-                    1,
</a><a href="#h20-0-69" id="h20-0-69" class="d">-                    Some(
</a>                         (
<a href="#h20-0-71" id="h20-0-71" class="i">+                            Field(
</a><a href="#h20-0-72" id="h20-0-72" class="i">+                                5,
</a><a href="#h20-0-73" id="h20-0-73" class="i">+                                Some(
</a><a href="#h20-0-74" id="h20-0-74" class="i">+                                    (
</a><a href="#h20-0-75" id="h20-0-75" class="i">+                                        None,
</a><a href="#h20-0-76" id="h20-0-76" class="i">+                                        &quot;rating&quot;,
</a><a href="#h20-0-77" id="h20-0-77" class="i">+                                    ),
</a><a href="#h20-0-78" id="h20-0-78" class="i">+                                ),
</a><a href="#h20-0-79" id="h20-0-79" class="i">+                            ),
</a>                             None,
<a href="#h20-0-81" id="h20-0-81" class="d">-                            &quot;rating&quot;,
</a><a href="#h20-0-82" id="h20-0-82" class="i">+                        ),
</a><a href="#h20-0-83" id="h20-0-83" class="i">+                    ],
</a><a href="#h20-0-84" id="h20-0-84" class="i">+                },
</a><a href="#h20-0-85" id="h20-0-85" class="i">+                predicate: GreaterThan(
</a><a href="#h20-0-86" id="h20-0-86" class="i">+                    Field(
</a><a href="#h20-0-87" id="h20-0-87" class="i">+                        2,
</a><a href="#h20-0-88" id="h20-0-88" class="i">+                        None,
</a><a href="#h20-0-89" id="h20-0-89" class="i">+                    ),
</a><a href="#h20-0-90" id="h20-0-90" class="i">+                    Constant(
</a><a href="#h20-0-91" id="h20-0-91" class="i">+                        Integer(
</a><a href="#h20-0-92" id="h20-0-92" class="i">+                            8,
</a>                         ),
                     ),
                 ),
<a href="#h20-0-96" id="h20-0-96" class="d">-                Constant(
</a><a href="#h20-0-97" id="h20-0-97" class="d">-                    Integer(
</a><a href="#h20-0-98" id="h20-0-98" class="d">-                        8,
</a><a href="#h20-0-99" id="h20-0-99" class="i">+            },
</a><a href="#h20-0-100" id="h20-0-100" class="i">+            orders: [
</a><a href="#h20-0-101" id="h20-0-101" class="i">+                (
</a><a href="#h20-0-102" id="h20-0-102" class="i">+                    Field(
</a><a href="#h20-0-103" id="h20-0-103" class="i">+                        0,
</a><a href="#h20-0-104" id="h20-0-104" class="i">+                        None,
</a>                     ),
<a href="#h20-0-106" id="h20-0-106" class="i">+                    Ascending,
</a>                 ),
<a href="#h20-0-108" id="h20-0-108" class="d">-            ),
</a><a href="#h20-0-109" id="h20-0-109" class="i">+            ],
</a>         },
<a href="#h20-0-111" id="h20-0-111" class="d">-        orders: [
</a><a href="#h20-0-112" id="h20-0-112" class="i">+        expressions: [
</a>             (
                 Field(
                     0,
<a href="#h20-0-116" id="h20-0-116" class="d">-                    Some(
</a><a href="#h20-0-117" id="h20-0-117" class="d">-                        (
</a><a href="#h20-0-118" id="h20-0-118" class="d">-                            None,
</a><a href="#h20-0-119" id="h20-0-119" class="d">-                            &quot;id&quot;,
</a><a href="#h20-0-120" id="h20-0-120" class="d">-                        ),
</a><a href="#h20-0-121" id="h20-0-121" class="d">-                    ),
</a><a href="#h20-0-122" id="h20-0-122" class="i">+                    None,
</a><a href="#h20-0-123" id="h20-0-123" class="i">+                ),
</a><a href="#h20-0-124" id="h20-0-124" class="i">+                None,
</a><a href="#h20-0-125" id="h20-0-125" class="i">+            ),
</a><a href="#h20-0-126" id="h20-0-126" class="i">+            (
</a><a href="#h20-0-127" id="h20-0-127" class="i">+                Field(
</a><a href="#h20-0-128" id="h20-0-128" class="i">+                    1,
</a><a href="#h20-0-129" id="h20-0-129" class="i">+                    None,
</a>                 ),
<a href="#h20-0-131" id="h20-0-131" class="d">-                Ascending,
</a><a href="#h20-0-132" id="h20-0-132" class="i">+                None,
</a>             ),
         ],
     },
 )
 
 Optimized plan: Plan(
<a href="#h20-0-139" id="h20-0-139" class="d">-    Order {
</a><a href="#h20-0-140" id="h20-0-140" class="d">-        source: Filter {
</a><a href="#h20-0-141" id="h20-0-141" class="d">-            source: Projection {
</a><a href="#h20-0-142" id="h20-0-142" class="d">-                source: Scan {
</a><a href="#h20-0-143" id="h20-0-143" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h20-0-144" id="h20-0-144" class="d">-                    alias: None,
</a><a href="#h20-0-145" id="h20-0-145" class="d">-                    filter: None,
</a><a href="#h20-0-146" id="h20-0-146" class="d">-                },
</a><a href="#h20-0-147" id="h20-0-147" class="d">-                expressions: [
</a><a href="#h20-0-148" id="h20-0-148" class="d">-                    (
</a><a href="#h20-0-149" id="h20-0-149" class="d">-                        Field(
</a><a href="#h20-0-150" id="h20-0-150" class="d">-                            0,
</a><a href="#h20-0-151" id="h20-0-151" class="d">-                            Some(
</a><a href="#h20-0-152" id="h20-0-152" class="d">-                                (
</a><a href="#h20-0-153" id="h20-0-153" class="d">-                                    None,
</a><a href="#h20-0-154" id="h20-0-154" class="d">-                                    &quot;id&quot;,
</a><a href="#h20-0-155" id="h20-0-155" class="i">+    Projection {
</a><a href="#h20-0-156" id="h20-0-156" class="i">+        source: Order {
</a><a href="#h20-0-157" id="h20-0-157" class="i">+            source: Filter {
</a><a href="#h20-0-158" id="h20-0-158" class="i">+                source: Projection {
</a><a href="#h20-0-159" id="h20-0-159" class="i">+                    source: Scan {
</a><a href="#h20-0-160" id="h20-0-160" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h20-0-161" id="h20-0-161" class="i">+                        alias: None,
</a><a href="#h20-0-162" id="h20-0-162" class="i">+                        filter: None,
</a><a href="#h20-0-163" id="h20-0-163" class="i">+                    },
</a><a href="#h20-0-164" id="h20-0-164" class="i">+                    expressions: [
</a><a href="#h20-0-165" id="h20-0-165" class="i">+                        (
</a><a href="#h20-0-166" id="h20-0-166" class="i">+                            Field(
</a><a href="#h20-0-167" id="h20-0-167" class="i">+                                0,
</a><a href="#h20-0-168" id="h20-0-168" class="i">+                                Some(
</a><a href="#h20-0-169" id="h20-0-169" class="i">+                                    (
</a><a href="#h20-0-170" id="h20-0-170" class="i">+                                        None,
</a><a href="#h20-0-171" id="h20-0-171" class="i">+                                        &quot;id&quot;,
</a><a href="#h20-0-172" id="h20-0-172" class="i">+                                    ),
</a>                                 ),
                             ),
<a href="#h20-0-175" id="h20-0-175" class="i">+                            None,
</a>                         ),
<a href="#h20-0-177" id="h20-0-177" class="d">-                        None,
</a><a href="#h20-0-178" id="h20-0-178" class="d">-                    ),
</a><a href="#h20-0-179" id="h20-0-179" class="d">-                    (
</a><a href="#h20-0-180" id="h20-0-180" class="d">-                        Field(
</a><a href="#h20-0-181" id="h20-0-181" class="d">-                            5,
</a><a href="#h20-0-182" id="h20-0-182" class="d">-                            Some(
</a><a href="#h20-0-183" id="h20-0-183" class="d">-                                (
</a><a href="#h20-0-184" id="h20-0-184" class="d">-                                    None,
</a><a href="#h20-0-185" id="h20-0-185" class="d">-                                    &quot;rating&quot;,
</a><a href="#h20-0-186" id="h20-0-186" class="i">+                        (
</a><a href="#h20-0-187" id="h20-0-187" class="i">+                            Field(
</a><a href="#h20-0-188" id="h20-0-188" class="i">+                                5,
</a><a href="#h20-0-189" id="h20-0-189" class="i">+                                Some(
</a><a href="#h20-0-190" id="h20-0-190" class="i">+                                    (
</a><a href="#h20-0-191" id="h20-0-191" class="i">+                                        None,
</a><a href="#h20-0-192" id="h20-0-192" class="i">+                                        &quot;rating&quot;,
</a><a href="#h20-0-193" id="h20-0-193" class="i">+                                    ),
</a>                                 ),
                             ),
<a href="#h20-0-196" id="h20-0-196" class="i">+                            None,
</a>                         ),
<a href="#h20-0-198" id="h20-0-198" class="d">-                        None,
</a><a href="#h20-0-199" id="h20-0-199" class="d">-                    ),
</a><a href="#h20-0-200" id="h20-0-200" class="d">-                ],
</a><a href="#h20-0-201" id="h20-0-201" class="d">-            },
</a><a href="#h20-0-202" id="h20-0-202" class="d">-            predicate: GreaterThan(
</a><a href="#h20-0-203" id="h20-0-203" class="d">-                Field(
</a><a href="#h20-0-204" id="h20-0-204" class="d">-                    1,
</a><a href="#h20-0-205" id="h20-0-205" class="d">-                    Some(
</a>                         (
<a href="#h20-0-207" id="h20-0-207" class="i">+                            Field(
</a><a href="#h20-0-208" id="h20-0-208" class="i">+                                5,
</a><a href="#h20-0-209" id="h20-0-209" class="i">+                                Some(
</a><a href="#h20-0-210" id="h20-0-210" class="i">+                                    (
</a><a href="#h20-0-211" id="h20-0-211" class="i">+                                        None,
</a><a href="#h20-0-212" id="h20-0-212" class="i">+                                        &quot;rating&quot;,
</a><a href="#h20-0-213" id="h20-0-213" class="i">+                                    ),
</a><a href="#h20-0-214" id="h20-0-214" class="i">+                                ),
</a><a href="#h20-0-215" id="h20-0-215" class="i">+                            ),
</a>                             None,
<a href="#h20-0-217" id="h20-0-217" class="d">-                            &quot;rating&quot;,
</a><a href="#h20-0-218" id="h20-0-218" class="i">+                        ),
</a><a href="#h20-0-219" id="h20-0-219" class="i">+                    ],
</a><a href="#h20-0-220" id="h20-0-220" class="i">+                },
</a><a href="#h20-0-221" id="h20-0-221" class="i">+                predicate: GreaterThan(
</a><a href="#h20-0-222" id="h20-0-222" class="i">+                    Field(
</a><a href="#h20-0-223" id="h20-0-223" class="i">+                        2,
</a><a href="#h20-0-224" id="h20-0-224" class="i">+                        None,
</a><a href="#h20-0-225" id="h20-0-225" class="i">+                    ),
</a><a href="#h20-0-226" id="h20-0-226" class="i">+                    Constant(
</a><a href="#h20-0-227" id="h20-0-227" class="i">+                        Integer(
</a><a href="#h20-0-228" id="h20-0-228" class="i">+                            8,
</a>                         ),
                     ),
                 ),
<a href="#h20-0-232" id="h20-0-232" class="d">-                Constant(
</a><a href="#h20-0-233" id="h20-0-233" class="d">-                    Integer(
</a><a href="#h20-0-234" id="h20-0-234" class="d">-                        8,
</a><a href="#h20-0-235" id="h20-0-235" class="i">+            },
</a><a href="#h20-0-236" id="h20-0-236" class="i">+            orders: [
</a><a href="#h20-0-237" id="h20-0-237" class="i">+                (
</a><a href="#h20-0-238" id="h20-0-238" class="i">+                    Field(
</a><a href="#h20-0-239" id="h20-0-239" class="i">+                        0,
</a><a href="#h20-0-240" id="h20-0-240" class="i">+                        None,
</a>                     ),
<a href="#h20-0-242" id="h20-0-242" class="i">+                    Ascending,
</a>                 ),
<a href="#h20-0-244" id="h20-0-244" class="d">-            ),
</a><a href="#h20-0-245" id="h20-0-245" class="i">+            ],
</a>         },
<a href="#h20-0-247" id="h20-0-247" class="d">-        orders: [
</a><a href="#h20-0-248" id="h20-0-248" class="i">+        expressions: [
</a>             (
                 Field(
                     0,
<a href="#h20-0-252" id="h20-0-252" class="d">-                    Some(
</a><a href="#h20-0-253" id="h20-0-253" class="d">-                        (
</a><a href="#h20-0-254" id="h20-0-254" class="d">-                            None,
</a><a href="#h20-0-255" id="h20-0-255" class="d">-                            &quot;id&quot;,
</a><a href="#h20-0-256" id="h20-0-256" class="d">-                        ),
</a><a href="#h20-0-257" id="h20-0-257" class="d">-                    ),
</a><a href="#h20-0-258" id="h20-0-258" class="i">+                    None,
</a><a href="#h20-0-259" id="h20-0-259" class="i">+                ),
</a><a href="#h20-0-260" id="h20-0-260" class="i">+                None,
</a><a href="#h20-0-261" id="h20-0-261" class="i">+            ),
</a><a href="#h20-0-262" id="h20-0-262" class="i">+            (
</a><a href="#h20-0-263" id="h20-0-263" class="i">+                Field(
</a><a href="#h20-0-264" id="h20-0-264" class="i">+                    1,
</a><a href="#h20-0-265" id="h20-0-265" class="i">+                    None,
</a>                 ),
<a href="#h20-0-267" id="h20-0-267" class="d">-                Ascending,
</a><a href="#h20-0-268" id="h20-0-268" class="i">+                None,
</a>             ),
         ],
     },
<b>diff --git a/<a id="h21" href="../file/tests/sql/query/having_noselect.html">tests/sql/query/having_noselect</a> b/<a href="../file/tests/sql/query/having_noselect.html">tests/sql/query/having_noselect</a></b>
<a href="#h21-0" id="h21-0" class="h">@@ -0,0 +1,263 @@
</a><a href="#h21-0-0" id="h21-0-0" class="i">+Query: SELECT studio_id FROM movies GROUP BY studio_id HAVING MAX(rating) &gt; 8 ORDER BY studio_id
</a><a href="#h21-0-1" id="h21-0-1" class="i">+
</a><a href="#h21-0-2" id="h21-0-2" class="i">+AST: Select {
</a><a href="#h21-0-3" id="h21-0-3" class="i">+    select: SelectClause {
</a><a href="#h21-0-4" id="h21-0-4" class="i">+        expressions: [
</a><a href="#h21-0-5" id="h21-0-5" class="i">+            (
</a><a href="#h21-0-6" id="h21-0-6" class="i">+                Field(
</a><a href="#h21-0-7" id="h21-0-7" class="i">+                    None,
</a><a href="#h21-0-8" id="h21-0-8" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h21-0-9" id="h21-0-9" class="i">+                ),
</a><a href="#h21-0-10" id="h21-0-10" class="i">+                None,
</a><a href="#h21-0-11" id="h21-0-11" class="i">+            ),
</a><a href="#h21-0-12" id="h21-0-12" class="i">+        ],
</a><a href="#h21-0-13" id="h21-0-13" class="i">+    },
</a><a href="#h21-0-14" id="h21-0-14" class="i">+    from: Some(
</a><a href="#h21-0-15" id="h21-0-15" class="i">+        FromClause {
</a><a href="#h21-0-16" id="h21-0-16" class="i">+            items: [
</a><a href="#h21-0-17" id="h21-0-17" class="i">+                Table {
</a><a href="#h21-0-18" id="h21-0-18" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h21-0-19" id="h21-0-19" class="i">+                    alias: None,
</a><a href="#h21-0-20" id="h21-0-20" class="i">+                },
</a><a href="#h21-0-21" id="h21-0-21" class="i">+            ],
</a><a href="#h21-0-22" id="h21-0-22" class="i">+        },
</a><a href="#h21-0-23" id="h21-0-23" class="i">+    ),
</a><a href="#h21-0-24" id="h21-0-24" class="i">+    where: None,
</a><a href="#h21-0-25" id="h21-0-25" class="i">+    group_by: Some(
</a><a href="#h21-0-26" id="h21-0-26" class="i">+        GroupByClause(
</a><a href="#h21-0-27" id="h21-0-27" class="i">+            [
</a><a href="#h21-0-28" id="h21-0-28" class="i">+                Field(
</a><a href="#h21-0-29" id="h21-0-29" class="i">+                    None,
</a><a href="#h21-0-30" id="h21-0-30" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h21-0-31" id="h21-0-31" class="i">+                ),
</a><a href="#h21-0-32" id="h21-0-32" class="i">+            ],
</a><a href="#h21-0-33" id="h21-0-33" class="i">+        ),
</a><a href="#h21-0-34" id="h21-0-34" class="i">+    ),
</a><a href="#h21-0-35" id="h21-0-35" class="i">+    having: Some(
</a><a href="#h21-0-36" id="h21-0-36" class="i">+        HavingClause(
</a><a href="#h21-0-37" id="h21-0-37" class="i">+            Operation(
</a><a href="#h21-0-38" id="h21-0-38" class="i">+                GreaterThan(
</a><a href="#h21-0-39" id="h21-0-39" class="i">+                    Function(
</a><a href="#h21-0-40" id="h21-0-40" class="i">+                        &quot;max&quot;,
</a><a href="#h21-0-41" id="h21-0-41" class="i">+                        [
</a><a href="#h21-0-42" id="h21-0-42" class="i">+                            Field(
</a><a href="#h21-0-43" id="h21-0-43" class="i">+                                None,
</a><a href="#h21-0-44" id="h21-0-44" class="i">+                                &quot;rating&quot;,
</a><a href="#h21-0-45" id="h21-0-45" class="i">+                            ),
</a><a href="#h21-0-46" id="h21-0-46" class="i">+                        ],
</a><a href="#h21-0-47" id="h21-0-47" class="i">+                    ),
</a><a href="#h21-0-48" id="h21-0-48" class="i">+                    Literal(
</a><a href="#h21-0-49" id="h21-0-49" class="i">+                        Integer(
</a><a href="#h21-0-50" id="h21-0-50" class="i">+                            8,
</a><a href="#h21-0-51" id="h21-0-51" class="i">+                        ),
</a><a href="#h21-0-52" id="h21-0-52" class="i">+                    ),
</a><a href="#h21-0-53" id="h21-0-53" class="i">+                ),
</a><a href="#h21-0-54" id="h21-0-54" class="i">+            ),
</a><a href="#h21-0-55" id="h21-0-55" class="i">+        ),
</a><a href="#h21-0-56" id="h21-0-56" class="i">+    ),
</a><a href="#h21-0-57" id="h21-0-57" class="i">+    order: [
</a><a href="#h21-0-58" id="h21-0-58" class="i">+        (
</a><a href="#h21-0-59" id="h21-0-59" class="i">+            Field(
</a><a href="#h21-0-60" id="h21-0-60" class="i">+                None,
</a><a href="#h21-0-61" id="h21-0-61" class="i">+                &quot;studio_id&quot;,
</a><a href="#h21-0-62" id="h21-0-62" class="i">+            ),
</a><a href="#h21-0-63" id="h21-0-63" class="i">+            Ascending,
</a><a href="#h21-0-64" id="h21-0-64" class="i">+        ),
</a><a href="#h21-0-65" id="h21-0-65" class="i">+    ],
</a><a href="#h21-0-66" id="h21-0-66" class="i">+    offset: None,
</a><a href="#h21-0-67" id="h21-0-67" class="i">+    limit: None,
</a><a href="#h21-0-68" id="h21-0-68" class="i">+}
</a><a href="#h21-0-69" id="h21-0-69" class="i">+
</a><a href="#h21-0-70" id="h21-0-70" class="i">+Plan: Plan(
</a><a href="#h21-0-71" id="h21-0-71" class="i">+    Projection {
</a><a href="#h21-0-72" id="h21-0-72" class="i">+        source: Order {
</a><a href="#h21-0-73" id="h21-0-73" class="i">+            source: Filter {
</a><a href="#h21-0-74" id="h21-0-74" class="i">+                source: Projection {
</a><a href="#h21-0-75" id="h21-0-75" class="i">+                    source: Aggregation {
</a><a href="#h21-0-76" id="h21-0-76" class="i">+                        source: Projection {
</a><a href="#h21-0-77" id="h21-0-77" class="i">+                            source: Scan {
</a><a href="#h21-0-78" id="h21-0-78" class="i">+                                table: &quot;movies&quot;,
</a><a href="#h21-0-79" id="h21-0-79" class="i">+                                alias: None,
</a><a href="#h21-0-80" id="h21-0-80" class="i">+                                filter: None,
</a><a href="#h21-0-81" id="h21-0-81" class="i">+                            },
</a><a href="#h21-0-82" id="h21-0-82" class="i">+                            expressions: [
</a><a href="#h21-0-83" id="h21-0-83" class="i">+                                (
</a><a href="#h21-0-84" id="h21-0-84" class="i">+                                    Field(
</a><a href="#h21-0-85" id="h21-0-85" class="i">+                                        5,
</a><a href="#h21-0-86" id="h21-0-86" class="i">+                                        Some(
</a><a href="#h21-0-87" id="h21-0-87" class="i">+                                            (
</a><a href="#h21-0-88" id="h21-0-88" class="i">+                                                None,
</a><a href="#h21-0-89" id="h21-0-89" class="i">+                                                &quot;rating&quot;,
</a><a href="#h21-0-90" id="h21-0-90" class="i">+                                            ),
</a><a href="#h21-0-91" id="h21-0-91" class="i">+                                        ),
</a><a href="#h21-0-92" id="h21-0-92" class="i">+                                    ),
</a><a href="#h21-0-93" id="h21-0-93" class="i">+                                    None,
</a><a href="#h21-0-94" id="h21-0-94" class="i">+                                ),
</a><a href="#h21-0-95" id="h21-0-95" class="i">+                                (
</a><a href="#h21-0-96" id="h21-0-96" class="i">+                                    Field(
</a><a href="#h21-0-97" id="h21-0-97" class="i">+                                        2,
</a><a href="#h21-0-98" id="h21-0-98" class="i">+                                        Some(
</a><a href="#h21-0-99" id="h21-0-99" class="i">+                                            (
</a><a href="#h21-0-100" id="h21-0-100" class="i">+                                                None,
</a><a href="#h21-0-101" id="h21-0-101" class="i">+                                                &quot;studio_id&quot;,
</a><a href="#h21-0-102" id="h21-0-102" class="i">+                                            ),
</a><a href="#h21-0-103" id="h21-0-103" class="i">+                                        ),
</a><a href="#h21-0-104" id="h21-0-104" class="i">+                                    ),
</a><a href="#h21-0-105" id="h21-0-105" class="i">+                                    None,
</a><a href="#h21-0-106" id="h21-0-106" class="i">+                                ),
</a><a href="#h21-0-107" id="h21-0-107" class="i">+                            ],
</a><a href="#h21-0-108" id="h21-0-108" class="i">+                        },
</a><a href="#h21-0-109" id="h21-0-109" class="i">+                        aggregates: [
</a><a href="#h21-0-110" id="h21-0-110" class="i">+                            Max,
</a><a href="#h21-0-111" id="h21-0-111" class="i">+                        ],
</a><a href="#h21-0-112" id="h21-0-112" class="i">+                    },
</a><a href="#h21-0-113" id="h21-0-113" class="i">+                    expressions: [
</a><a href="#h21-0-114" id="h21-0-114" class="i">+                        (
</a><a href="#h21-0-115" id="h21-0-115" class="i">+                            Field(
</a><a href="#h21-0-116" id="h21-0-116" class="i">+                                1,
</a><a href="#h21-0-117" id="h21-0-117" class="i">+                                None,
</a><a href="#h21-0-118" id="h21-0-118" class="i">+                            ),
</a><a href="#h21-0-119" id="h21-0-119" class="i">+                            None,
</a><a href="#h21-0-120" id="h21-0-120" class="i">+                        ),
</a><a href="#h21-0-121" id="h21-0-121" class="i">+                        (
</a><a href="#h21-0-122" id="h21-0-122" class="i">+                            Field(
</a><a href="#h21-0-123" id="h21-0-123" class="i">+                                0,
</a><a href="#h21-0-124" id="h21-0-124" class="i">+                                None,
</a><a href="#h21-0-125" id="h21-0-125" class="i">+                            ),
</a><a href="#h21-0-126" id="h21-0-126" class="i">+                            None,
</a><a href="#h21-0-127" id="h21-0-127" class="i">+                        ),
</a><a href="#h21-0-128" id="h21-0-128" class="i">+                    ],
</a><a href="#h21-0-129" id="h21-0-129" class="i">+                },
</a><a href="#h21-0-130" id="h21-0-130" class="i">+                predicate: GreaterThan(
</a><a href="#h21-0-131" id="h21-0-131" class="i">+                    Field(
</a><a href="#h21-0-132" id="h21-0-132" class="i">+                        1,
</a><a href="#h21-0-133" id="h21-0-133" class="i">+                        None,
</a><a href="#h21-0-134" id="h21-0-134" class="i">+                    ),
</a><a href="#h21-0-135" id="h21-0-135" class="i">+                    Constant(
</a><a href="#h21-0-136" id="h21-0-136" class="i">+                        Integer(
</a><a href="#h21-0-137" id="h21-0-137" class="i">+                            8,
</a><a href="#h21-0-138" id="h21-0-138" class="i">+                        ),
</a><a href="#h21-0-139" id="h21-0-139" class="i">+                    ),
</a><a href="#h21-0-140" id="h21-0-140" class="i">+                ),
</a><a href="#h21-0-141" id="h21-0-141" class="i">+            },
</a><a href="#h21-0-142" id="h21-0-142" class="i">+            orders: [
</a><a href="#h21-0-143" id="h21-0-143" class="i">+                (
</a><a href="#h21-0-144" id="h21-0-144" class="i">+                    Field(
</a><a href="#h21-0-145" id="h21-0-145" class="i">+                        0,
</a><a href="#h21-0-146" id="h21-0-146" class="i">+                        None,
</a><a href="#h21-0-147" id="h21-0-147" class="i">+                    ),
</a><a href="#h21-0-148" id="h21-0-148" class="i">+                    Ascending,
</a><a href="#h21-0-149" id="h21-0-149" class="i">+                ),
</a><a href="#h21-0-150" id="h21-0-150" class="i">+            ],
</a><a href="#h21-0-151" id="h21-0-151" class="i">+        },
</a><a href="#h21-0-152" id="h21-0-152" class="i">+        expressions: [
</a><a href="#h21-0-153" id="h21-0-153" class="i">+            (
</a><a href="#h21-0-154" id="h21-0-154" class="i">+                Field(
</a><a href="#h21-0-155" id="h21-0-155" class="i">+                    0,
</a><a href="#h21-0-156" id="h21-0-156" class="i">+                    None,
</a><a href="#h21-0-157" id="h21-0-157" class="i">+                ),
</a><a href="#h21-0-158" id="h21-0-158" class="i">+                None,
</a><a href="#h21-0-159" id="h21-0-159" class="i">+            ),
</a><a href="#h21-0-160" id="h21-0-160" class="i">+        ],
</a><a href="#h21-0-161" id="h21-0-161" class="i">+    },
</a><a href="#h21-0-162" id="h21-0-162" class="i">+)
</a><a href="#h21-0-163" id="h21-0-163" class="i">+
</a><a href="#h21-0-164" id="h21-0-164" class="i">+Optimized plan: Plan(
</a><a href="#h21-0-165" id="h21-0-165" class="i">+    Projection {
</a><a href="#h21-0-166" id="h21-0-166" class="i">+        source: Order {
</a><a href="#h21-0-167" id="h21-0-167" class="i">+            source: Filter {
</a><a href="#h21-0-168" id="h21-0-168" class="i">+                source: Projection {
</a><a href="#h21-0-169" id="h21-0-169" class="i">+                    source: Aggregation {
</a><a href="#h21-0-170" id="h21-0-170" class="i">+                        source: Projection {
</a><a href="#h21-0-171" id="h21-0-171" class="i">+                            source: Scan {
</a><a href="#h21-0-172" id="h21-0-172" class="i">+                                table: &quot;movies&quot;,
</a><a href="#h21-0-173" id="h21-0-173" class="i">+                                alias: None,
</a><a href="#h21-0-174" id="h21-0-174" class="i">+                                filter: None,
</a><a href="#h21-0-175" id="h21-0-175" class="i">+                            },
</a><a href="#h21-0-176" id="h21-0-176" class="i">+                            expressions: [
</a><a href="#h21-0-177" id="h21-0-177" class="i">+                                (
</a><a href="#h21-0-178" id="h21-0-178" class="i">+                                    Field(
</a><a href="#h21-0-179" id="h21-0-179" class="i">+                                        5,
</a><a href="#h21-0-180" id="h21-0-180" class="i">+                                        Some(
</a><a href="#h21-0-181" id="h21-0-181" class="i">+                                            (
</a><a href="#h21-0-182" id="h21-0-182" class="i">+                                                None,
</a><a href="#h21-0-183" id="h21-0-183" class="i">+                                                &quot;rating&quot;,
</a><a href="#h21-0-184" id="h21-0-184" class="i">+                                            ),
</a><a href="#h21-0-185" id="h21-0-185" class="i">+                                        ),
</a><a href="#h21-0-186" id="h21-0-186" class="i">+                                    ),
</a><a href="#h21-0-187" id="h21-0-187" class="i">+                                    None,
</a><a href="#h21-0-188" id="h21-0-188" class="i">+                                ),
</a><a href="#h21-0-189" id="h21-0-189" class="i">+                                (
</a><a href="#h21-0-190" id="h21-0-190" class="i">+                                    Field(
</a><a href="#h21-0-191" id="h21-0-191" class="i">+                                        2,
</a><a href="#h21-0-192" id="h21-0-192" class="i">+                                        Some(
</a><a href="#h21-0-193" id="h21-0-193" class="i">+                                            (
</a><a href="#h21-0-194" id="h21-0-194" class="i">+                                                None,
</a><a href="#h21-0-195" id="h21-0-195" class="i">+                                                &quot;studio_id&quot;,
</a><a href="#h21-0-196" id="h21-0-196" class="i">+                                            ),
</a><a href="#h21-0-197" id="h21-0-197" class="i">+                                        ),
</a><a href="#h21-0-198" id="h21-0-198" class="i">+                                    ),
</a><a href="#h21-0-199" id="h21-0-199" class="i">+                                    None,
</a><a href="#h21-0-200" id="h21-0-200" class="i">+                                ),
</a><a href="#h21-0-201" id="h21-0-201" class="i">+                            ],
</a><a href="#h21-0-202" id="h21-0-202" class="i">+                        },
</a><a href="#h21-0-203" id="h21-0-203" class="i">+                        aggregates: [
</a><a href="#h21-0-204" id="h21-0-204" class="i">+                            Max,
</a><a href="#h21-0-205" id="h21-0-205" class="i">+                        ],
</a><a href="#h21-0-206" id="h21-0-206" class="i">+                    },
</a><a href="#h21-0-207" id="h21-0-207" class="i">+                    expressions: [
</a><a href="#h21-0-208" id="h21-0-208" class="i">+                        (
</a><a href="#h21-0-209" id="h21-0-209" class="i">+                            Field(
</a><a href="#h21-0-210" id="h21-0-210" class="i">+                                1,
</a><a href="#h21-0-211" id="h21-0-211" class="i">+                                None,
</a><a href="#h21-0-212" id="h21-0-212" class="i">+                            ),
</a><a href="#h21-0-213" id="h21-0-213" class="i">+                            None,
</a><a href="#h21-0-214" id="h21-0-214" class="i">+                        ),
</a><a href="#h21-0-215" id="h21-0-215" class="i">+                        (
</a><a href="#h21-0-216" id="h21-0-216" class="i">+                            Field(
</a><a href="#h21-0-217" id="h21-0-217" class="i">+                                0,
</a><a href="#h21-0-218" id="h21-0-218" class="i">+                                None,
</a><a href="#h21-0-219" id="h21-0-219" class="i">+                            ),
</a><a href="#h21-0-220" id="h21-0-220" class="i">+                            None,
</a><a href="#h21-0-221" id="h21-0-221" class="i">+                        ),
</a><a href="#h21-0-222" id="h21-0-222" class="i">+                    ],
</a><a href="#h21-0-223" id="h21-0-223" class="i">+                },
</a><a href="#h21-0-224" id="h21-0-224" class="i">+                predicate: GreaterThan(
</a><a href="#h21-0-225" id="h21-0-225" class="i">+                    Field(
</a><a href="#h21-0-226" id="h21-0-226" class="i">+                        1,
</a><a href="#h21-0-227" id="h21-0-227" class="i">+                        None,
</a><a href="#h21-0-228" id="h21-0-228" class="i">+                    ),
</a><a href="#h21-0-229" id="h21-0-229" class="i">+                    Constant(
</a><a href="#h21-0-230" id="h21-0-230" class="i">+                        Integer(
</a><a href="#h21-0-231" id="h21-0-231" class="i">+                            8,
</a><a href="#h21-0-232" id="h21-0-232" class="i">+                        ),
</a><a href="#h21-0-233" id="h21-0-233" class="i">+                    ),
</a><a href="#h21-0-234" id="h21-0-234" class="i">+                ),
</a><a href="#h21-0-235" id="h21-0-235" class="i">+            },
</a><a href="#h21-0-236" id="h21-0-236" class="i">+            orders: [
</a><a href="#h21-0-237" id="h21-0-237" class="i">+                (
</a><a href="#h21-0-238" id="h21-0-238" class="i">+                    Field(
</a><a href="#h21-0-239" id="h21-0-239" class="i">+                        0,
</a><a href="#h21-0-240" id="h21-0-240" class="i">+                        None,
</a><a href="#h21-0-241" id="h21-0-241" class="i">+                    ),
</a><a href="#h21-0-242" id="h21-0-242" class="i">+                    Ascending,
</a><a href="#h21-0-243" id="h21-0-243" class="i">+                ),
</a><a href="#h21-0-244" id="h21-0-244" class="i">+            ],
</a><a href="#h21-0-245" id="h21-0-245" class="i">+        },
</a><a href="#h21-0-246" id="h21-0-246" class="i">+        expressions: [
</a><a href="#h21-0-247" id="h21-0-247" class="i">+            (
</a><a href="#h21-0-248" id="h21-0-248" class="i">+                Field(
</a><a href="#h21-0-249" id="h21-0-249" class="i">+                    0,
</a><a href="#h21-0-250" id="h21-0-250" class="i">+                    None,
</a><a href="#h21-0-251" id="h21-0-251" class="i">+                ),
</a><a href="#h21-0-252" id="h21-0-252" class="i">+                None,
</a><a href="#h21-0-253" id="h21-0-253" class="i">+            ),
</a><a href="#h21-0-254" id="h21-0-254" class="i">+        ],
</a><a href="#h21-0-255" id="h21-0-255" class="i">+    },
</a><a href="#h21-0-256" id="h21-0-256" class="i">+)
</a><a href="#h21-0-257" id="h21-0-257" class="i">+
</a><a href="#h21-0-258" id="h21-0-258" class="i">+Query: SELECT studio_id FROM movies GROUP BY studio_id HAVING MAX(rating) &gt; 8 ORDER BY studio_id
</a><a href="#h21-0-259" id="h21-0-259" class="i">+
</a><a href="#h21-0-260" id="h21-0-260" class="i">+Result: [&quot;studio_id&quot;]
</a><a href="#h21-0-261" id="h21-0-261" class="i">+[Integer(1)]
</a><a href="#h21-0-262" id="h21-0-262" class="i">+[Integer(4)]
</a><b>diff --git a/<a id="h22" href="../file/tests/sql/query/order_aggregate.html">tests/sql/query/order_aggregate</a> b/<a href="../file/tests/sql/query/order_aggregate.html">tests/sql/query/order_aggregate</a></b>
<a href="#h22-0" id="h22-0" class="h">@@ -0,0 +1,213 @@
</a><a href="#h22-0-0" id="h22-0-0" class="i">+Query: SELECT studio_id, MAX(rating) FROM movies GROUP BY studio_id ORDER BY MAX(rating)
</a><a href="#h22-0-1" id="h22-0-1" class="i">+
</a><a href="#h22-0-2" id="h22-0-2" class="i">+AST: Select {
</a><a href="#h22-0-3" id="h22-0-3" class="i">+    select: SelectClause {
</a><a href="#h22-0-4" id="h22-0-4" class="i">+        expressions: [
</a><a href="#h22-0-5" id="h22-0-5" class="i">+            (
</a><a href="#h22-0-6" id="h22-0-6" class="i">+                Field(
</a><a href="#h22-0-7" id="h22-0-7" class="i">+                    None,
</a><a href="#h22-0-8" id="h22-0-8" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h22-0-9" id="h22-0-9" class="i">+                ),
</a><a href="#h22-0-10" id="h22-0-10" class="i">+                None,
</a><a href="#h22-0-11" id="h22-0-11" class="i">+            ),
</a><a href="#h22-0-12" id="h22-0-12" class="i">+            (
</a><a href="#h22-0-13" id="h22-0-13" class="i">+                Function(
</a><a href="#h22-0-14" id="h22-0-14" class="i">+                    &quot;max&quot;,
</a><a href="#h22-0-15" id="h22-0-15" class="i">+                    [
</a><a href="#h22-0-16" id="h22-0-16" class="i">+                        Field(
</a><a href="#h22-0-17" id="h22-0-17" class="i">+                            None,
</a><a href="#h22-0-18" id="h22-0-18" class="i">+                            &quot;rating&quot;,
</a><a href="#h22-0-19" id="h22-0-19" class="i">+                        ),
</a><a href="#h22-0-20" id="h22-0-20" class="i">+                    ],
</a><a href="#h22-0-21" id="h22-0-21" class="i">+                ),
</a><a href="#h22-0-22" id="h22-0-22" class="i">+                None,
</a><a href="#h22-0-23" id="h22-0-23" class="i">+            ),
</a><a href="#h22-0-24" id="h22-0-24" class="i">+        ],
</a><a href="#h22-0-25" id="h22-0-25" class="i">+    },
</a><a href="#h22-0-26" id="h22-0-26" class="i">+    from: Some(
</a><a href="#h22-0-27" id="h22-0-27" class="i">+        FromClause {
</a><a href="#h22-0-28" id="h22-0-28" class="i">+            items: [
</a><a href="#h22-0-29" id="h22-0-29" class="i">+                Table {
</a><a href="#h22-0-30" id="h22-0-30" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h22-0-31" id="h22-0-31" class="i">+                    alias: None,
</a><a href="#h22-0-32" id="h22-0-32" class="i">+                },
</a><a href="#h22-0-33" id="h22-0-33" class="i">+            ],
</a><a href="#h22-0-34" id="h22-0-34" class="i">+        },
</a><a href="#h22-0-35" id="h22-0-35" class="i">+    ),
</a><a href="#h22-0-36" id="h22-0-36" class="i">+    where: None,
</a><a href="#h22-0-37" id="h22-0-37" class="i">+    group_by: Some(
</a><a href="#h22-0-38" id="h22-0-38" class="i">+        GroupByClause(
</a><a href="#h22-0-39" id="h22-0-39" class="i">+            [
</a><a href="#h22-0-40" id="h22-0-40" class="i">+                Field(
</a><a href="#h22-0-41" id="h22-0-41" class="i">+                    None,
</a><a href="#h22-0-42" id="h22-0-42" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h22-0-43" id="h22-0-43" class="i">+                ),
</a><a href="#h22-0-44" id="h22-0-44" class="i">+            ],
</a><a href="#h22-0-45" id="h22-0-45" class="i">+        ),
</a><a href="#h22-0-46" id="h22-0-46" class="i">+    ),
</a><a href="#h22-0-47" id="h22-0-47" class="i">+    having: None,
</a><a href="#h22-0-48" id="h22-0-48" class="i">+    order: [
</a><a href="#h22-0-49" id="h22-0-49" class="i">+        (
</a><a href="#h22-0-50" id="h22-0-50" class="i">+            Function(
</a><a href="#h22-0-51" id="h22-0-51" class="i">+                &quot;max&quot;,
</a><a href="#h22-0-52" id="h22-0-52" class="i">+                [
</a><a href="#h22-0-53" id="h22-0-53" class="i">+                    Field(
</a><a href="#h22-0-54" id="h22-0-54" class="i">+                        None,
</a><a href="#h22-0-55" id="h22-0-55" class="i">+                        &quot;rating&quot;,
</a><a href="#h22-0-56" id="h22-0-56" class="i">+                    ),
</a><a href="#h22-0-57" id="h22-0-57" class="i">+                ],
</a><a href="#h22-0-58" id="h22-0-58" class="i">+            ),
</a><a href="#h22-0-59" id="h22-0-59" class="i">+            Ascending,
</a><a href="#h22-0-60" id="h22-0-60" class="i">+        ),
</a><a href="#h22-0-61" id="h22-0-61" class="i">+    ],
</a><a href="#h22-0-62" id="h22-0-62" class="i">+    offset: None,
</a><a href="#h22-0-63" id="h22-0-63" class="i">+    limit: None,
</a><a href="#h22-0-64" id="h22-0-64" class="i">+}
</a><a href="#h22-0-65" id="h22-0-65" class="i">+
</a><a href="#h22-0-66" id="h22-0-66" class="i">+Plan: Plan(
</a><a href="#h22-0-67" id="h22-0-67" class="i">+    Order {
</a><a href="#h22-0-68" id="h22-0-68" class="i">+        source: Projection {
</a><a href="#h22-0-69" id="h22-0-69" class="i">+            source: Aggregation {
</a><a href="#h22-0-70" id="h22-0-70" class="i">+                source: Projection {
</a><a href="#h22-0-71" id="h22-0-71" class="i">+                    source: Scan {
</a><a href="#h22-0-72" id="h22-0-72" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h22-0-73" id="h22-0-73" class="i">+                        alias: None,
</a><a href="#h22-0-74" id="h22-0-74" class="i">+                        filter: None,
</a><a href="#h22-0-75" id="h22-0-75" class="i">+                    },
</a><a href="#h22-0-76" id="h22-0-76" class="i">+                    expressions: [
</a><a href="#h22-0-77" id="h22-0-77" class="i">+                        (
</a><a href="#h22-0-78" id="h22-0-78" class="i">+                            Field(
</a><a href="#h22-0-79" id="h22-0-79" class="i">+                                5,
</a><a href="#h22-0-80" id="h22-0-80" class="i">+                                Some(
</a><a href="#h22-0-81" id="h22-0-81" class="i">+                                    (
</a><a href="#h22-0-82" id="h22-0-82" class="i">+                                        None,
</a><a href="#h22-0-83" id="h22-0-83" class="i">+                                        &quot;rating&quot;,
</a><a href="#h22-0-84" id="h22-0-84" class="i">+                                    ),
</a><a href="#h22-0-85" id="h22-0-85" class="i">+                                ),
</a><a href="#h22-0-86" id="h22-0-86" class="i">+                            ),
</a><a href="#h22-0-87" id="h22-0-87" class="i">+                            None,
</a><a href="#h22-0-88" id="h22-0-88" class="i">+                        ),
</a><a href="#h22-0-89" id="h22-0-89" class="i">+                        (
</a><a href="#h22-0-90" id="h22-0-90" class="i">+                            Field(
</a><a href="#h22-0-91" id="h22-0-91" class="i">+                                2,
</a><a href="#h22-0-92" id="h22-0-92" class="i">+                                Some(
</a><a href="#h22-0-93" id="h22-0-93" class="i">+                                    (
</a><a href="#h22-0-94" id="h22-0-94" class="i">+                                        None,
</a><a href="#h22-0-95" id="h22-0-95" class="i">+                                        &quot;studio_id&quot;,
</a><a href="#h22-0-96" id="h22-0-96" class="i">+                                    ),
</a><a href="#h22-0-97" id="h22-0-97" class="i">+                                ),
</a><a href="#h22-0-98" id="h22-0-98" class="i">+                            ),
</a><a href="#h22-0-99" id="h22-0-99" class="i">+                            None,
</a><a href="#h22-0-100" id="h22-0-100" class="i">+                        ),
</a><a href="#h22-0-101" id="h22-0-101" class="i">+                    ],
</a><a href="#h22-0-102" id="h22-0-102" class="i">+                },
</a><a href="#h22-0-103" id="h22-0-103" class="i">+                aggregates: [
</a><a href="#h22-0-104" id="h22-0-104" class="i">+                    Max,
</a><a href="#h22-0-105" id="h22-0-105" class="i">+                ],
</a><a href="#h22-0-106" id="h22-0-106" class="i">+            },
</a><a href="#h22-0-107" id="h22-0-107" class="i">+            expressions: [
</a><a href="#h22-0-108" id="h22-0-108" class="i">+                (
</a><a href="#h22-0-109" id="h22-0-109" class="i">+                    Field(
</a><a href="#h22-0-110" id="h22-0-110" class="i">+                        1,
</a><a href="#h22-0-111" id="h22-0-111" class="i">+                        None,
</a><a href="#h22-0-112" id="h22-0-112" class="i">+                    ),
</a><a href="#h22-0-113" id="h22-0-113" class="i">+                    None,
</a><a href="#h22-0-114" id="h22-0-114" class="i">+                ),
</a><a href="#h22-0-115" id="h22-0-115" class="i">+                (
</a><a href="#h22-0-116" id="h22-0-116" class="i">+                    Field(
</a><a href="#h22-0-117" id="h22-0-117" class="i">+                        0,
</a><a href="#h22-0-118" id="h22-0-118" class="i">+                        None,
</a><a href="#h22-0-119" id="h22-0-119" class="i">+                    ),
</a><a href="#h22-0-120" id="h22-0-120" class="i">+                    None,
</a><a href="#h22-0-121" id="h22-0-121" class="i">+                ),
</a><a href="#h22-0-122" id="h22-0-122" class="i">+            ],
</a><a href="#h22-0-123" id="h22-0-123" class="i">+        },
</a><a href="#h22-0-124" id="h22-0-124" class="i">+        orders: [
</a><a href="#h22-0-125" id="h22-0-125" class="i">+            (
</a><a href="#h22-0-126" id="h22-0-126" class="i">+                Field(
</a><a href="#h22-0-127" id="h22-0-127" class="i">+                    1,
</a><a href="#h22-0-128" id="h22-0-128" class="i">+                    None,
</a><a href="#h22-0-129" id="h22-0-129" class="i">+                ),
</a><a href="#h22-0-130" id="h22-0-130" class="i">+                Ascending,
</a><a href="#h22-0-131" id="h22-0-131" class="i">+            ),
</a><a href="#h22-0-132" id="h22-0-132" class="i">+        ],
</a><a href="#h22-0-133" id="h22-0-133" class="i">+    },
</a><a href="#h22-0-134" id="h22-0-134" class="i">+)
</a><a href="#h22-0-135" id="h22-0-135" class="i">+
</a><a href="#h22-0-136" id="h22-0-136" class="i">+Optimized plan: Plan(
</a><a href="#h22-0-137" id="h22-0-137" class="i">+    Order {
</a><a href="#h22-0-138" id="h22-0-138" class="i">+        source: Projection {
</a><a href="#h22-0-139" id="h22-0-139" class="i">+            source: Aggregation {
</a><a href="#h22-0-140" id="h22-0-140" class="i">+                source: Projection {
</a><a href="#h22-0-141" id="h22-0-141" class="i">+                    source: Scan {
</a><a href="#h22-0-142" id="h22-0-142" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h22-0-143" id="h22-0-143" class="i">+                        alias: None,
</a><a href="#h22-0-144" id="h22-0-144" class="i">+                        filter: None,
</a><a href="#h22-0-145" id="h22-0-145" class="i">+                    },
</a><a href="#h22-0-146" id="h22-0-146" class="i">+                    expressions: [
</a><a href="#h22-0-147" id="h22-0-147" class="i">+                        (
</a><a href="#h22-0-148" id="h22-0-148" class="i">+                            Field(
</a><a href="#h22-0-149" id="h22-0-149" class="i">+                                5,
</a><a href="#h22-0-150" id="h22-0-150" class="i">+                                Some(
</a><a href="#h22-0-151" id="h22-0-151" class="i">+                                    (
</a><a href="#h22-0-152" id="h22-0-152" class="i">+                                        None,
</a><a href="#h22-0-153" id="h22-0-153" class="i">+                                        &quot;rating&quot;,
</a><a href="#h22-0-154" id="h22-0-154" class="i">+                                    ),
</a><a href="#h22-0-155" id="h22-0-155" class="i">+                                ),
</a><a href="#h22-0-156" id="h22-0-156" class="i">+                            ),
</a><a href="#h22-0-157" id="h22-0-157" class="i">+                            None,
</a><a href="#h22-0-158" id="h22-0-158" class="i">+                        ),
</a><a href="#h22-0-159" id="h22-0-159" class="i">+                        (
</a><a href="#h22-0-160" id="h22-0-160" class="i">+                            Field(
</a><a href="#h22-0-161" id="h22-0-161" class="i">+                                2,
</a><a href="#h22-0-162" id="h22-0-162" class="i">+                                Some(
</a><a href="#h22-0-163" id="h22-0-163" class="i">+                                    (
</a><a href="#h22-0-164" id="h22-0-164" class="i">+                                        None,
</a><a href="#h22-0-165" id="h22-0-165" class="i">+                                        &quot;studio_id&quot;,
</a><a href="#h22-0-166" id="h22-0-166" class="i">+                                    ),
</a><a href="#h22-0-167" id="h22-0-167" class="i">+                                ),
</a><a href="#h22-0-168" id="h22-0-168" class="i">+                            ),
</a><a href="#h22-0-169" id="h22-0-169" class="i">+                            None,
</a><a href="#h22-0-170" id="h22-0-170" class="i">+                        ),
</a><a href="#h22-0-171" id="h22-0-171" class="i">+                    ],
</a><a href="#h22-0-172" id="h22-0-172" class="i">+                },
</a><a href="#h22-0-173" id="h22-0-173" class="i">+                aggregates: [
</a><a href="#h22-0-174" id="h22-0-174" class="i">+                    Max,
</a><a href="#h22-0-175" id="h22-0-175" class="i">+                ],
</a><a href="#h22-0-176" id="h22-0-176" class="i">+            },
</a><a href="#h22-0-177" id="h22-0-177" class="i">+            expressions: [
</a><a href="#h22-0-178" id="h22-0-178" class="i">+                (
</a><a href="#h22-0-179" id="h22-0-179" class="i">+                    Field(
</a><a href="#h22-0-180" id="h22-0-180" class="i">+                        1,
</a><a href="#h22-0-181" id="h22-0-181" class="i">+                        None,
</a><a href="#h22-0-182" id="h22-0-182" class="i">+                    ),
</a><a href="#h22-0-183" id="h22-0-183" class="i">+                    None,
</a><a href="#h22-0-184" id="h22-0-184" class="i">+                ),
</a><a href="#h22-0-185" id="h22-0-185" class="i">+                (
</a><a href="#h22-0-186" id="h22-0-186" class="i">+                    Field(
</a><a href="#h22-0-187" id="h22-0-187" class="i">+                        0,
</a><a href="#h22-0-188" id="h22-0-188" class="i">+                        None,
</a><a href="#h22-0-189" id="h22-0-189" class="i">+                    ),
</a><a href="#h22-0-190" id="h22-0-190" class="i">+                    None,
</a><a href="#h22-0-191" id="h22-0-191" class="i">+                ),
</a><a href="#h22-0-192" id="h22-0-192" class="i">+            ],
</a><a href="#h22-0-193" id="h22-0-193" class="i">+        },
</a><a href="#h22-0-194" id="h22-0-194" class="i">+        orders: [
</a><a href="#h22-0-195" id="h22-0-195" class="i">+            (
</a><a href="#h22-0-196" id="h22-0-196" class="i">+                Field(
</a><a href="#h22-0-197" id="h22-0-197" class="i">+                    1,
</a><a href="#h22-0-198" id="h22-0-198" class="i">+                    None,
</a><a href="#h22-0-199" id="h22-0-199" class="i">+                ),
</a><a href="#h22-0-200" id="h22-0-200" class="i">+                Ascending,
</a><a href="#h22-0-201" id="h22-0-201" class="i">+            ),
</a><a href="#h22-0-202" id="h22-0-202" class="i">+        ],
</a><a href="#h22-0-203" id="h22-0-203" class="i">+    },
</a><a href="#h22-0-204" id="h22-0-204" class="i">+)
</a><a href="#h22-0-205" id="h22-0-205" class="i">+
</a><a href="#h22-0-206" id="h22-0-206" class="i">+Query: SELECT studio_id, MAX(rating) FROM movies GROUP BY studio_id ORDER BY MAX(rating)
</a><a href="#h22-0-207" id="h22-0-207" class="i">+
</a><a href="#h22-0-208" id="h22-0-208" class="i">+Result: [&quot;studio_id&quot;, &quot;?&quot;]
</a><a href="#h22-0-209" id="h22-0-209" class="i">+[Integer(3), Float(6.9)]
</a><a href="#h22-0-210" id="h22-0-210" class="i">+[Integer(2), Float(7.6)]
</a><a href="#h22-0-211" id="h22-0-211" class="i">+[Integer(1), Float(8.2)]
</a><a href="#h22-0-212" id="h22-0-212" class="i">+[Integer(4), Float(8.8)]
</a><b>diff --git a/<a id="h23" href="../file/tests/sql/query/order_aggregate_noselect.html">tests/sql/query/order_aggregate_noselect</a> b/<a href="../file/tests/sql/query/order_aggregate_noselect.html">tests/sql/query/order_aggregate_noselect</a></b>
<a href="#h23-0" id="h23-0" class="h">@@ -0,0 +1,289 @@
</a><a href="#h23-0-0" id="h23-0-0" class="i">+Query: SELECT studio_id, MAX(rating) FROM movies GROUP BY studio_id ORDER BY MIN(rating)
</a><a href="#h23-0-1" id="h23-0-1" class="i">+
</a><a href="#h23-0-2" id="h23-0-2" class="i">+AST: Select {
</a><a href="#h23-0-3" id="h23-0-3" class="i">+    select: SelectClause {
</a><a href="#h23-0-4" id="h23-0-4" class="i">+        expressions: [
</a><a href="#h23-0-5" id="h23-0-5" class="i">+            (
</a><a href="#h23-0-6" id="h23-0-6" class="i">+                Field(
</a><a href="#h23-0-7" id="h23-0-7" class="i">+                    None,
</a><a href="#h23-0-8" id="h23-0-8" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h23-0-9" id="h23-0-9" class="i">+                ),
</a><a href="#h23-0-10" id="h23-0-10" class="i">+                None,
</a><a href="#h23-0-11" id="h23-0-11" class="i">+            ),
</a><a href="#h23-0-12" id="h23-0-12" class="i">+            (
</a><a href="#h23-0-13" id="h23-0-13" class="i">+                Function(
</a><a href="#h23-0-14" id="h23-0-14" class="i">+                    &quot;max&quot;,
</a><a href="#h23-0-15" id="h23-0-15" class="i">+                    [
</a><a href="#h23-0-16" id="h23-0-16" class="i">+                        Field(
</a><a href="#h23-0-17" id="h23-0-17" class="i">+                            None,
</a><a href="#h23-0-18" id="h23-0-18" class="i">+                            &quot;rating&quot;,
</a><a href="#h23-0-19" id="h23-0-19" class="i">+                        ),
</a><a href="#h23-0-20" id="h23-0-20" class="i">+                    ],
</a><a href="#h23-0-21" id="h23-0-21" class="i">+                ),
</a><a href="#h23-0-22" id="h23-0-22" class="i">+                None,
</a><a href="#h23-0-23" id="h23-0-23" class="i">+            ),
</a><a href="#h23-0-24" id="h23-0-24" class="i">+        ],
</a><a href="#h23-0-25" id="h23-0-25" class="i">+    },
</a><a href="#h23-0-26" id="h23-0-26" class="i">+    from: Some(
</a><a href="#h23-0-27" id="h23-0-27" class="i">+        FromClause {
</a><a href="#h23-0-28" id="h23-0-28" class="i">+            items: [
</a><a href="#h23-0-29" id="h23-0-29" class="i">+                Table {
</a><a href="#h23-0-30" id="h23-0-30" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h23-0-31" id="h23-0-31" class="i">+                    alias: None,
</a><a href="#h23-0-32" id="h23-0-32" class="i">+                },
</a><a href="#h23-0-33" id="h23-0-33" class="i">+            ],
</a><a href="#h23-0-34" id="h23-0-34" class="i">+        },
</a><a href="#h23-0-35" id="h23-0-35" class="i">+    ),
</a><a href="#h23-0-36" id="h23-0-36" class="i">+    where: None,
</a><a href="#h23-0-37" id="h23-0-37" class="i">+    group_by: Some(
</a><a href="#h23-0-38" id="h23-0-38" class="i">+        GroupByClause(
</a><a href="#h23-0-39" id="h23-0-39" class="i">+            [
</a><a href="#h23-0-40" id="h23-0-40" class="i">+                Field(
</a><a href="#h23-0-41" id="h23-0-41" class="i">+                    None,
</a><a href="#h23-0-42" id="h23-0-42" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h23-0-43" id="h23-0-43" class="i">+                ),
</a><a href="#h23-0-44" id="h23-0-44" class="i">+            ],
</a><a href="#h23-0-45" id="h23-0-45" class="i">+        ),
</a><a href="#h23-0-46" id="h23-0-46" class="i">+    ),
</a><a href="#h23-0-47" id="h23-0-47" class="i">+    having: None,
</a><a href="#h23-0-48" id="h23-0-48" class="i">+    order: [
</a><a href="#h23-0-49" id="h23-0-49" class="i">+        (
</a><a href="#h23-0-50" id="h23-0-50" class="i">+            Function(
</a><a href="#h23-0-51" id="h23-0-51" class="i">+                &quot;min&quot;,
</a><a href="#h23-0-52" id="h23-0-52" class="i">+                [
</a><a href="#h23-0-53" id="h23-0-53" class="i">+                    Field(
</a><a href="#h23-0-54" id="h23-0-54" class="i">+                        None,
</a><a href="#h23-0-55" id="h23-0-55" class="i">+                        &quot;rating&quot;,
</a><a href="#h23-0-56" id="h23-0-56" class="i">+                    ),
</a><a href="#h23-0-57" id="h23-0-57" class="i">+                ],
</a><a href="#h23-0-58" id="h23-0-58" class="i">+            ),
</a><a href="#h23-0-59" id="h23-0-59" class="i">+            Ascending,
</a><a href="#h23-0-60" id="h23-0-60" class="i">+        ),
</a><a href="#h23-0-61" id="h23-0-61" class="i">+    ],
</a><a href="#h23-0-62" id="h23-0-62" class="i">+    offset: None,
</a><a href="#h23-0-63" id="h23-0-63" class="i">+    limit: None,
</a><a href="#h23-0-64" id="h23-0-64" class="i">+}
</a><a href="#h23-0-65" id="h23-0-65" class="i">+
</a><a href="#h23-0-66" id="h23-0-66" class="i">+Plan: Plan(
</a><a href="#h23-0-67" id="h23-0-67" class="i">+    Projection {
</a><a href="#h23-0-68" id="h23-0-68" class="i">+        source: Order {
</a><a href="#h23-0-69" id="h23-0-69" class="i">+            source: Projection {
</a><a href="#h23-0-70" id="h23-0-70" class="i">+                source: Aggregation {
</a><a href="#h23-0-71" id="h23-0-71" class="i">+                    source: Projection {
</a><a href="#h23-0-72" id="h23-0-72" class="i">+                        source: Scan {
</a><a href="#h23-0-73" id="h23-0-73" class="i">+                            table: &quot;movies&quot;,
</a><a href="#h23-0-74" id="h23-0-74" class="i">+                            alias: None,
</a><a href="#h23-0-75" id="h23-0-75" class="i">+                            filter: None,
</a><a href="#h23-0-76" id="h23-0-76" class="i">+                        },
</a><a href="#h23-0-77" id="h23-0-77" class="i">+                        expressions: [
</a><a href="#h23-0-78" id="h23-0-78" class="i">+                            (
</a><a href="#h23-0-79" id="h23-0-79" class="i">+                                Field(
</a><a href="#h23-0-80" id="h23-0-80" class="i">+                                    5,
</a><a href="#h23-0-81" id="h23-0-81" class="i">+                                    Some(
</a><a href="#h23-0-82" id="h23-0-82" class="i">+                                        (
</a><a href="#h23-0-83" id="h23-0-83" class="i">+                                            None,
</a><a href="#h23-0-84" id="h23-0-84" class="i">+                                            &quot;rating&quot;,
</a><a href="#h23-0-85" id="h23-0-85" class="i">+                                        ),
</a><a href="#h23-0-86" id="h23-0-86" class="i">+                                    ),
</a><a href="#h23-0-87" id="h23-0-87" class="i">+                                ),
</a><a href="#h23-0-88" id="h23-0-88" class="i">+                                None,
</a><a href="#h23-0-89" id="h23-0-89" class="i">+                            ),
</a><a href="#h23-0-90" id="h23-0-90" class="i">+                            (
</a><a href="#h23-0-91" id="h23-0-91" class="i">+                                Field(
</a><a href="#h23-0-92" id="h23-0-92" class="i">+                                    5,
</a><a href="#h23-0-93" id="h23-0-93" class="i">+                                    Some(
</a><a href="#h23-0-94" id="h23-0-94" class="i">+                                        (
</a><a href="#h23-0-95" id="h23-0-95" class="i">+                                            None,
</a><a href="#h23-0-96" id="h23-0-96" class="i">+                                            &quot;rating&quot;,
</a><a href="#h23-0-97" id="h23-0-97" class="i">+                                        ),
</a><a href="#h23-0-98" id="h23-0-98" class="i">+                                    ),
</a><a href="#h23-0-99" id="h23-0-99" class="i">+                                ),
</a><a href="#h23-0-100" id="h23-0-100" class="i">+                                None,
</a><a href="#h23-0-101" id="h23-0-101" class="i">+                            ),
</a><a href="#h23-0-102" id="h23-0-102" class="i">+                            (
</a><a href="#h23-0-103" id="h23-0-103" class="i">+                                Field(
</a><a href="#h23-0-104" id="h23-0-104" class="i">+                                    2,
</a><a href="#h23-0-105" id="h23-0-105" class="i">+                                    Some(
</a><a href="#h23-0-106" id="h23-0-106" class="i">+                                        (
</a><a href="#h23-0-107" id="h23-0-107" class="i">+                                            None,
</a><a href="#h23-0-108" id="h23-0-108" class="i">+                                            &quot;studio_id&quot;,
</a><a href="#h23-0-109" id="h23-0-109" class="i">+                                        ),
</a><a href="#h23-0-110" id="h23-0-110" class="i">+                                    ),
</a><a href="#h23-0-111" id="h23-0-111" class="i">+                                ),
</a><a href="#h23-0-112" id="h23-0-112" class="i">+                                None,
</a><a href="#h23-0-113" id="h23-0-113" class="i">+                            ),
</a><a href="#h23-0-114" id="h23-0-114" class="i">+                        ],
</a><a href="#h23-0-115" id="h23-0-115" class="i">+                    },
</a><a href="#h23-0-116" id="h23-0-116" class="i">+                    aggregates: [
</a><a href="#h23-0-117" id="h23-0-117" class="i">+                        Max,
</a><a href="#h23-0-118" id="h23-0-118" class="i">+                        Min,
</a><a href="#h23-0-119" id="h23-0-119" class="i">+                    ],
</a><a href="#h23-0-120" id="h23-0-120" class="i">+                },
</a><a href="#h23-0-121" id="h23-0-121" class="i">+                expressions: [
</a><a href="#h23-0-122" id="h23-0-122" class="i">+                    (
</a><a href="#h23-0-123" id="h23-0-123" class="i">+                        Field(
</a><a href="#h23-0-124" id="h23-0-124" class="i">+                            2,
</a><a href="#h23-0-125" id="h23-0-125" class="i">+                            None,
</a><a href="#h23-0-126" id="h23-0-126" class="i">+                        ),
</a><a href="#h23-0-127" id="h23-0-127" class="i">+                        None,
</a><a href="#h23-0-128" id="h23-0-128" class="i">+                    ),
</a><a href="#h23-0-129" id="h23-0-129" class="i">+                    (
</a><a href="#h23-0-130" id="h23-0-130" class="i">+                        Field(
</a><a href="#h23-0-131" id="h23-0-131" class="i">+                            0,
</a><a href="#h23-0-132" id="h23-0-132" class="i">+                            None,
</a><a href="#h23-0-133" id="h23-0-133" class="i">+                        ),
</a><a href="#h23-0-134" id="h23-0-134" class="i">+                        None,
</a><a href="#h23-0-135" id="h23-0-135" class="i">+                    ),
</a><a href="#h23-0-136" id="h23-0-136" class="i">+                    (
</a><a href="#h23-0-137" id="h23-0-137" class="i">+                        Field(
</a><a href="#h23-0-138" id="h23-0-138" class="i">+                            1,
</a><a href="#h23-0-139" id="h23-0-139" class="i">+                            None,
</a><a href="#h23-0-140" id="h23-0-140" class="i">+                        ),
</a><a href="#h23-0-141" id="h23-0-141" class="i">+                        None,
</a><a href="#h23-0-142" id="h23-0-142" class="i">+                    ),
</a><a href="#h23-0-143" id="h23-0-143" class="i">+                ],
</a><a href="#h23-0-144" id="h23-0-144" class="i">+            },
</a><a href="#h23-0-145" id="h23-0-145" class="i">+            orders: [
</a><a href="#h23-0-146" id="h23-0-146" class="i">+                (
</a><a href="#h23-0-147" id="h23-0-147" class="i">+                    Field(
</a><a href="#h23-0-148" id="h23-0-148" class="i">+                        2,
</a><a href="#h23-0-149" id="h23-0-149" class="i">+                        None,
</a><a href="#h23-0-150" id="h23-0-150" class="i">+                    ),
</a><a href="#h23-0-151" id="h23-0-151" class="i">+                    Ascending,
</a><a href="#h23-0-152" id="h23-0-152" class="i">+                ),
</a><a href="#h23-0-153" id="h23-0-153" class="i">+            ],
</a><a href="#h23-0-154" id="h23-0-154" class="i">+        },
</a><a href="#h23-0-155" id="h23-0-155" class="i">+        expressions: [
</a><a href="#h23-0-156" id="h23-0-156" class="i">+            (
</a><a href="#h23-0-157" id="h23-0-157" class="i">+                Field(
</a><a href="#h23-0-158" id="h23-0-158" class="i">+                    0,
</a><a href="#h23-0-159" id="h23-0-159" class="i">+                    None,
</a><a href="#h23-0-160" id="h23-0-160" class="i">+                ),
</a><a href="#h23-0-161" id="h23-0-161" class="i">+                None,
</a><a href="#h23-0-162" id="h23-0-162" class="i">+            ),
</a><a href="#h23-0-163" id="h23-0-163" class="i">+            (
</a><a href="#h23-0-164" id="h23-0-164" class="i">+                Field(
</a><a href="#h23-0-165" id="h23-0-165" class="i">+                    1,
</a><a href="#h23-0-166" id="h23-0-166" class="i">+                    None,
</a><a href="#h23-0-167" id="h23-0-167" class="i">+                ),
</a><a href="#h23-0-168" id="h23-0-168" class="i">+                None,
</a><a href="#h23-0-169" id="h23-0-169" class="i">+            ),
</a><a href="#h23-0-170" id="h23-0-170" class="i">+        ],
</a><a href="#h23-0-171" id="h23-0-171" class="i">+    },
</a><a href="#h23-0-172" id="h23-0-172" class="i">+)
</a><a href="#h23-0-173" id="h23-0-173" class="i">+
</a><a href="#h23-0-174" id="h23-0-174" class="i">+Optimized plan: Plan(
</a><a href="#h23-0-175" id="h23-0-175" class="i">+    Projection {
</a><a href="#h23-0-176" id="h23-0-176" class="i">+        source: Order {
</a><a href="#h23-0-177" id="h23-0-177" class="i">+            source: Projection {
</a><a href="#h23-0-178" id="h23-0-178" class="i">+                source: Aggregation {
</a><a href="#h23-0-179" id="h23-0-179" class="i">+                    source: Projection {
</a><a href="#h23-0-180" id="h23-0-180" class="i">+                        source: Scan {
</a><a href="#h23-0-181" id="h23-0-181" class="i">+                            table: &quot;movies&quot;,
</a><a href="#h23-0-182" id="h23-0-182" class="i">+                            alias: None,
</a><a href="#h23-0-183" id="h23-0-183" class="i">+                            filter: None,
</a><a href="#h23-0-184" id="h23-0-184" class="i">+                        },
</a><a href="#h23-0-185" id="h23-0-185" class="i">+                        expressions: [
</a><a href="#h23-0-186" id="h23-0-186" class="i">+                            (
</a><a href="#h23-0-187" id="h23-0-187" class="i">+                                Field(
</a><a href="#h23-0-188" id="h23-0-188" class="i">+                                    5,
</a><a href="#h23-0-189" id="h23-0-189" class="i">+                                    Some(
</a><a href="#h23-0-190" id="h23-0-190" class="i">+                                        (
</a><a href="#h23-0-191" id="h23-0-191" class="i">+                                            None,
</a><a href="#h23-0-192" id="h23-0-192" class="i">+                                            &quot;rating&quot;,
</a><a href="#h23-0-193" id="h23-0-193" class="i">+                                        ),
</a><a href="#h23-0-194" id="h23-0-194" class="i">+                                    ),
</a><a href="#h23-0-195" id="h23-0-195" class="i">+                                ),
</a><a href="#h23-0-196" id="h23-0-196" class="i">+                                None,
</a><a href="#h23-0-197" id="h23-0-197" class="i">+                            ),
</a><a href="#h23-0-198" id="h23-0-198" class="i">+                            (
</a><a href="#h23-0-199" id="h23-0-199" class="i">+                                Field(
</a><a href="#h23-0-200" id="h23-0-200" class="i">+                                    5,
</a><a href="#h23-0-201" id="h23-0-201" class="i">+                                    Some(
</a><a href="#h23-0-202" id="h23-0-202" class="i">+                                        (
</a><a href="#h23-0-203" id="h23-0-203" class="i">+                                            None,
</a><a href="#h23-0-204" id="h23-0-204" class="i">+                                            &quot;rating&quot;,
</a><a href="#h23-0-205" id="h23-0-205" class="i">+                                        ),
</a><a href="#h23-0-206" id="h23-0-206" class="i">+                                    ),
</a><a href="#h23-0-207" id="h23-0-207" class="i">+                                ),
</a><a href="#h23-0-208" id="h23-0-208" class="i">+                                None,
</a><a href="#h23-0-209" id="h23-0-209" class="i">+                            ),
</a><a href="#h23-0-210" id="h23-0-210" class="i">+                            (
</a><a href="#h23-0-211" id="h23-0-211" class="i">+                                Field(
</a><a href="#h23-0-212" id="h23-0-212" class="i">+                                    2,
</a><a href="#h23-0-213" id="h23-0-213" class="i">+                                    Some(
</a><a href="#h23-0-214" id="h23-0-214" class="i">+                                        (
</a><a href="#h23-0-215" id="h23-0-215" class="i">+                                            None,
</a><a href="#h23-0-216" id="h23-0-216" class="i">+                                            &quot;studio_id&quot;,
</a><a href="#h23-0-217" id="h23-0-217" class="i">+                                        ),
</a><a href="#h23-0-218" id="h23-0-218" class="i">+                                    ),
</a><a href="#h23-0-219" id="h23-0-219" class="i">+                                ),
</a><a href="#h23-0-220" id="h23-0-220" class="i">+                                None,
</a><a href="#h23-0-221" id="h23-0-221" class="i">+                            ),
</a><a href="#h23-0-222" id="h23-0-222" class="i">+                        ],
</a><a href="#h23-0-223" id="h23-0-223" class="i">+                    },
</a><a href="#h23-0-224" id="h23-0-224" class="i">+                    aggregates: [
</a><a href="#h23-0-225" id="h23-0-225" class="i">+                        Max,
</a><a href="#h23-0-226" id="h23-0-226" class="i">+                        Min,
</a><a href="#h23-0-227" id="h23-0-227" class="i">+                    ],
</a><a href="#h23-0-228" id="h23-0-228" class="i">+                },
</a><a href="#h23-0-229" id="h23-0-229" class="i">+                expressions: [
</a><a href="#h23-0-230" id="h23-0-230" class="i">+                    (
</a><a href="#h23-0-231" id="h23-0-231" class="i">+                        Field(
</a><a href="#h23-0-232" id="h23-0-232" class="i">+                            2,
</a><a href="#h23-0-233" id="h23-0-233" class="i">+                            None,
</a><a href="#h23-0-234" id="h23-0-234" class="i">+                        ),
</a><a href="#h23-0-235" id="h23-0-235" class="i">+                        None,
</a><a href="#h23-0-236" id="h23-0-236" class="i">+                    ),
</a><a href="#h23-0-237" id="h23-0-237" class="i">+                    (
</a><a href="#h23-0-238" id="h23-0-238" class="i">+                        Field(
</a><a href="#h23-0-239" id="h23-0-239" class="i">+                            0,
</a><a href="#h23-0-240" id="h23-0-240" class="i">+                            None,
</a><a href="#h23-0-241" id="h23-0-241" class="i">+                        ),
</a><a href="#h23-0-242" id="h23-0-242" class="i">+                        None,
</a><a href="#h23-0-243" id="h23-0-243" class="i">+                    ),
</a><a href="#h23-0-244" id="h23-0-244" class="i">+                    (
</a><a href="#h23-0-245" id="h23-0-245" class="i">+                        Field(
</a><a href="#h23-0-246" id="h23-0-246" class="i">+                            1,
</a><a href="#h23-0-247" id="h23-0-247" class="i">+                            None,
</a><a href="#h23-0-248" id="h23-0-248" class="i">+                        ),
</a><a href="#h23-0-249" id="h23-0-249" class="i">+                        None,
</a><a href="#h23-0-250" id="h23-0-250" class="i">+                    ),
</a><a href="#h23-0-251" id="h23-0-251" class="i">+                ],
</a><a href="#h23-0-252" id="h23-0-252" class="i">+            },
</a><a href="#h23-0-253" id="h23-0-253" class="i">+            orders: [
</a><a href="#h23-0-254" id="h23-0-254" class="i">+                (
</a><a href="#h23-0-255" id="h23-0-255" class="i">+                    Field(
</a><a href="#h23-0-256" id="h23-0-256" class="i">+                        2,
</a><a href="#h23-0-257" id="h23-0-257" class="i">+                        None,
</a><a href="#h23-0-258" id="h23-0-258" class="i">+                    ),
</a><a href="#h23-0-259" id="h23-0-259" class="i">+                    Ascending,
</a><a href="#h23-0-260" id="h23-0-260" class="i">+                ),
</a><a href="#h23-0-261" id="h23-0-261" class="i">+            ],
</a><a href="#h23-0-262" id="h23-0-262" class="i">+        },
</a><a href="#h23-0-263" id="h23-0-263" class="i">+        expressions: [
</a><a href="#h23-0-264" id="h23-0-264" class="i">+            (
</a><a href="#h23-0-265" id="h23-0-265" class="i">+                Field(
</a><a href="#h23-0-266" id="h23-0-266" class="i">+                    0,
</a><a href="#h23-0-267" id="h23-0-267" class="i">+                    None,
</a><a href="#h23-0-268" id="h23-0-268" class="i">+                ),
</a><a href="#h23-0-269" id="h23-0-269" class="i">+                None,
</a><a href="#h23-0-270" id="h23-0-270" class="i">+            ),
</a><a href="#h23-0-271" id="h23-0-271" class="i">+            (
</a><a href="#h23-0-272" id="h23-0-272" class="i">+                Field(
</a><a href="#h23-0-273" id="h23-0-273" class="i">+                    1,
</a><a href="#h23-0-274" id="h23-0-274" class="i">+                    None,
</a><a href="#h23-0-275" id="h23-0-275" class="i">+                ),
</a><a href="#h23-0-276" id="h23-0-276" class="i">+                None,
</a><a href="#h23-0-277" id="h23-0-277" class="i">+            ),
</a><a href="#h23-0-278" id="h23-0-278" class="i">+        ],
</a><a href="#h23-0-279" id="h23-0-279" class="i">+    },
</a><a href="#h23-0-280" id="h23-0-280" class="i">+)
</a><a href="#h23-0-281" id="h23-0-281" class="i">+
</a><a href="#h23-0-282" id="h23-0-282" class="i">+Query: SELECT studio_id, MAX(rating) FROM movies GROUP BY studio_id ORDER BY MIN(rating)
</a><a href="#h23-0-283" id="h23-0-283" class="i">+
</a><a href="#h23-0-284" id="h23-0-284" class="i">+Result: [&quot;studio_id&quot;, &quot;?&quot;]
</a><a href="#h23-0-285" id="h23-0-285" class="i">+[Integer(3), Float(6.9)]
</a><a href="#h23-0-286" id="h23-0-286" class="i">+[Integer(4), Float(8.8)]
</a><a href="#h23-0-287" id="h23-0-287" class="i">+[Integer(2), Float(7.6)]
</a><a href="#h23-0-288" id="h23-0-288" class="i">+[Integer(1), Float(8.2)]
</a><b>diff --git a/<a id="h24" href="../file/tests/sql/query/order_expr.html">tests/sql/query/order_expr</a> b/<a href="../file/tests/sql/query/order_expr.html">tests/sql/query/order_expr</a></b>
<a href="#h24-0" id="h24-0" class="h">@@ -149,21 +149,9 @@ Plan: Plan(
</a>         },
         orders: [
             (
<a href="#h24-0-3" id="h24-0-3" class="d">-                Modulo(
</a><a href="#h24-0-4" id="h24-0-4" class="d">-                    Field(
</a><a href="#h24-0-5" id="h24-0-5" class="d">-                        2,
</a><a href="#h24-0-6" id="h24-0-6" class="d">-                        Some(
</a><a href="#h24-0-7" id="h24-0-7" class="d">-                            (
</a><a href="#h24-0-8" id="h24-0-8" class="d">-                                None,
</a><a href="#h24-0-9" id="h24-0-9" class="d">-                                &quot;released&quot;,
</a><a href="#h24-0-10" id="h24-0-10" class="d">-                            ),
</a><a href="#h24-0-11" id="h24-0-11" class="d">-                        ),
</a><a href="#h24-0-12" id="h24-0-12" class="d">-                    ),
</a><a href="#h24-0-13" id="h24-0-13" class="d">-                    Constant(
</a><a href="#h24-0-14" id="h24-0-14" class="d">-                        Integer(
</a><a href="#h24-0-15" id="h24-0-15" class="d">-                            4,
</a><a href="#h24-0-16" id="h24-0-16" class="d">-                        ),
</a><a href="#h24-0-17" id="h24-0-17" class="d">-                    ),
</a><a href="#h24-0-18" id="h24-0-18" class="i">+                Field(
</a><a href="#h24-0-19" id="h24-0-19" class="i">+                    3,
</a><a href="#h24-0-20" id="h24-0-20" class="i">+                    None,
</a>                 ),
                 Ascending,
             ),
<a href="#h24-1" id="h24-1" class="h">@@ -241,21 +229,9 @@ Optimized plan: Plan(
</a>         },
         orders: [
             (
<a href="#h24-1-3" id="h24-1-3" class="d">-                Modulo(
</a><a href="#h24-1-4" id="h24-1-4" class="d">-                    Field(
</a><a href="#h24-1-5" id="h24-1-5" class="d">-                        2,
</a><a href="#h24-1-6" id="h24-1-6" class="d">-                        Some(
</a><a href="#h24-1-7" id="h24-1-7" class="d">-                            (
</a><a href="#h24-1-8" id="h24-1-8" class="d">-                                None,
</a><a href="#h24-1-9" id="h24-1-9" class="d">-                                &quot;released&quot;,
</a><a href="#h24-1-10" id="h24-1-10" class="d">-                            ),
</a><a href="#h24-1-11" id="h24-1-11" class="d">-                        ),
</a><a href="#h24-1-12" id="h24-1-12" class="d">-                    ),
</a><a href="#h24-1-13" id="h24-1-13" class="d">-                    Constant(
</a><a href="#h24-1-14" id="h24-1-14" class="d">-                        Integer(
</a><a href="#h24-1-15" id="h24-1-15" class="d">-                            4,
</a><a href="#h24-1-16" id="h24-1-16" class="d">-                        ),
</a><a href="#h24-1-17" id="h24-1-17" class="d">-                    ),
</a><a href="#h24-1-18" id="h24-1-18" class="i">+                Field(
</a><a href="#h24-1-19" id="h24-1-19" class="i">+                    3,
</a><a href="#h24-1-20" id="h24-1-20" class="i">+                    None,
</a>                 ),
                 Ascending,
             ),
<b>diff --git a/<a id="h25" href="../file/tests/sql/query/order_field_aliased.html">tests/sql/query/order_field_aliased</a> b/<a href="../file/tests/sql/query/order_field_aliased.html">tests/sql/query/order_field_aliased</a></b>
<a href="#h25-0" id="h25-0" class="h">@@ -181,24 +181,14 @@ Plan: Plan(
</a>             (
                 Field(
                     2,
<a href="#h25-0-3" id="h25-0-3" class="d">-                    Some(
</a><a href="#h25-0-4" id="h25-0-4" class="d">-                        (
</a><a href="#h25-0-5" id="h25-0-5" class="d">-                            None,
</a><a href="#h25-0-6" id="h25-0-6" class="d">-                            &quot;genre&quot;,
</a><a href="#h25-0-7" id="h25-0-7" class="d">-                        ),
</a><a href="#h25-0-8" id="h25-0-8" class="d">-                    ),
</a><a href="#h25-0-9" id="h25-0-9" class="i">+                    None,
</a>                 ),
                 Ascending,
             ),
             (
                 Field(
                     1,
<a href="#h25-0-16" id="h25-0-16" class="d">-                    Some(
</a><a href="#h25-0-17" id="h25-0-17" class="d">-                        (
</a><a href="#h25-0-18" id="h25-0-18" class="d">-                            None,
</a><a href="#h25-0-19" id="h25-0-19" class="d">-                            &quot;title&quot;,
</a><a href="#h25-0-20" id="h25-0-20" class="d">-                        ),
</a><a href="#h25-0-21" id="h25-0-21" class="d">-                    ),
</a><a href="#h25-0-22" id="h25-0-22" class="i">+                    None,
</a>                 ),
                 Ascending,
             ),
<a href="#h25-1" id="h25-1" class="h">@@ -298,24 +288,14 @@ Optimized plan: Plan(
</a>             (
                 Field(
                     2,
<a href="#h25-1-3" id="h25-1-3" class="d">-                    Some(
</a><a href="#h25-1-4" id="h25-1-4" class="d">-                        (
</a><a href="#h25-1-5" id="h25-1-5" class="d">-                            None,
</a><a href="#h25-1-6" id="h25-1-6" class="d">-                            &quot;genre&quot;,
</a><a href="#h25-1-7" id="h25-1-7" class="d">-                        ),
</a><a href="#h25-1-8" id="h25-1-8" class="d">-                    ),
</a><a href="#h25-1-9" id="h25-1-9" class="i">+                    None,
</a>                 ),
                 Ascending,
             ),
             (
                 Field(
                     1,
<a href="#h25-1-16" id="h25-1-16" class="d">-                    Some(
</a><a href="#h25-1-17" id="h25-1-17" class="d">-                        (
</a><a href="#h25-1-18" id="h25-1-18" class="d">-                            None,
</a><a href="#h25-1-19" id="h25-1-19" class="d">-                            &quot;title&quot;,
</a><a href="#h25-1-20" id="h25-1-20" class="d">-                        ),
</a><a href="#h25-1-21" id="h25-1-21" class="d">-                    ),
</a><a href="#h25-1-22" id="h25-1-22" class="i">+                    None,
</a>                 ),
                 Ascending,
             ),
<b>diff --git a/<a id="h26" href="../file/tests/sql/query/order_field_qualified.html">tests/sql/query/order_field_qualified</a> b/<a href="../file/tests/sql/query/order_field_qualified.html">tests/sql/query/order_field_qualified</a></b>
<a href="#h26-0" id="h26-0" class="h">@@ -89,235 +89,313 @@ AST: Select {
</a> }
 
 Plan: Plan(
<a href="#h26-0-3" id="h26-0-3" class="d">-    Order {
</a><a href="#h26-0-4" id="h26-0-4" class="d">-        source: Projection {
</a><a href="#h26-0-5" id="h26-0-5" class="d">-            source: Filter {
</a><a href="#h26-0-6" id="h26-0-6" class="d">-                source: NestedLoopJoin {
</a><a href="#h26-0-7" id="h26-0-7" class="d">-                    outer: Scan {
</a><a href="#h26-0-8" id="h26-0-8" class="d">-                        table: &quot;movies&quot;,
</a><a href="#h26-0-9" id="h26-0-9" class="d">-                        alias: None,
</a><a href="#h26-0-10" id="h26-0-10" class="d">-                        filter: None,
</a><a href="#h26-0-11" id="h26-0-11" class="d">-                    },
</a><a href="#h26-0-12" id="h26-0-12" class="d">-                    inner: Scan {
</a><a href="#h26-0-13" id="h26-0-13" class="d">-                        table: &quot;genres&quot;,
</a><a href="#h26-0-14" id="h26-0-14" class="d">-                        alias: None,
</a><a href="#h26-0-15" id="h26-0-15" class="d">-                        filter: None,
</a><a href="#h26-0-16" id="h26-0-16" class="i">+    Projection {
</a><a href="#h26-0-17" id="h26-0-17" class="i">+        source: Order {
</a><a href="#h26-0-18" id="h26-0-18" class="i">+            source: Projection {
</a><a href="#h26-0-19" id="h26-0-19" class="i">+                source: Filter {
</a><a href="#h26-0-20" id="h26-0-20" class="i">+                    source: NestedLoopJoin {
</a><a href="#h26-0-21" id="h26-0-21" class="i">+                        outer: Scan {
</a><a href="#h26-0-22" id="h26-0-22" class="i">+                            table: &quot;movies&quot;,
</a><a href="#h26-0-23" id="h26-0-23" class="i">+                            alias: None,
</a><a href="#h26-0-24" id="h26-0-24" class="i">+                            filter: None,
</a><a href="#h26-0-25" id="h26-0-25" class="i">+                        },
</a><a href="#h26-0-26" id="h26-0-26" class="i">+                        inner: Scan {
</a><a href="#h26-0-27" id="h26-0-27" class="i">+                            table: &quot;genres&quot;,
</a><a href="#h26-0-28" id="h26-0-28" class="i">+                            alias: None,
</a><a href="#h26-0-29" id="h26-0-29" class="i">+                            filter: None,
</a><a href="#h26-0-30" id="h26-0-30" class="i">+                        },
</a><a href="#h26-0-31" id="h26-0-31" class="i">+                        predicate: None,
</a><a href="#h26-0-32" id="h26-0-32" class="i">+                        pad: false,
</a><a href="#h26-0-33" id="h26-0-33" class="i">+                        flip: false,
</a>                     },
<a href="#h26-0-35" id="h26-0-35" class="d">-                    predicate: None,
</a><a href="#h26-0-36" id="h26-0-36" class="d">-                    pad: false,
</a><a href="#h26-0-37" id="h26-0-37" class="d">-                    flip: false,
</a><a href="#h26-0-38" id="h26-0-38" class="i">+                    predicate: Equal(
</a><a href="#h26-0-39" id="h26-0-39" class="i">+                        Field(
</a><a href="#h26-0-40" id="h26-0-40" class="i">+                            3,
</a><a href="#h26-0-41" id="h26-0-41" class="i">+                            Some(
</a><a href="#h26-0-42" id="h26-0-42" class="i">+                                (
</a><a href="#h26-0-43" id="h26-0-43" class="i">+                                    Some(
</a><a href="#h26-0-44" id="h26-0-44" class="i">+                                        &quot;movies&quot;,
</a><a href="#h26-0-45" id="h26-0-45" class="i">+                                    ),
</a><a href="#h26-0-46" id="h26-0-46" class="i">+                                    &quot;genre_id&quot;,
</a><a href="#h26-0-47" id="h26-0-47" class="i">+                                ),
</a><a href="#h26-0-48" id="h26-0-48" class="i">+                            ),
</a><a href="#h26-0-49" id="h26-0-49" class="i">+                        ),
</a><a href="#h26-0-50" id="h26-0-50" class="i">+                        Field(
</a><a href="#h26-0-51" id="h26-0-51" class="i">+                            7,
</a><a href="#h26-0-52" id="h26-0-52" class="i">+                            Some(
</a><a href="#h26-0-53" id="h26-0-53" class="i">+                                (
</a><a href="#h26-0-54" id="h26-0-54" class="i">+                                    Some(
</a><a href="#h26-0-55" id="h26-0-55" class="i">+                                        &quot;genres&quot;,
</a><a href="#h26-0-56" id="h26-0-56" class="i">+                                    ),
</a><a href="#h26-0-57" id="h26-0-57" class="i">+                                    &quot;id&quot;,
</a><a href="#h26-0-58" id="h26-0-58" class="i">+                                ),
</a><a href="#h26-0-59" id="h26-0-59" class="i">+                            ),
</a><a href="#h26-0-60" id="h26-0-60" class="i">+                        ),
</a><a href="#h26-0-61" id="h26-0-61" class="i">+                    ),
</a>                 },
<a href="#h26-0-63" id="h26-0-63" class="d">-                predicate: Equal(
</a><a href="#h26-0-64" id="h26-0-64" class="d">-                    Field(
</a><a href="#h26-0-65" id="h26-0-65" class="d">-                        3,
</a><a href="#h26-0-66" id="h26-0-66" class="d">-                        Some(
</a><a href="#h26-0-67" id="h26-0-67" class="d">-                            (
</a><a href="#h26-0-68" id="h26-0-68" class="d">-                                Some(
</a><a href="#h26-0-69" id="h26-0-69" class="d">-                                    &quot;movies&quot;,
</a><a href="#h26-0-70" id="h26-0-70" class="i">+                expressions: [
</a><a href="#h26-0-71" id="h26-0-71" class="i">+                    (
</a><a href="#h26-0-72" id="h26-0-72" class="i">+                        Field(
</a><a href="#h26-0-73" id="h26-0-73" class="i">+                            0,
</a><a href="#h26-0-74" id="h26-0-74" class="i">+                            Some(
</a><a href="#h26-0-75" id="h26-0-75" class="i">+                                (
</a><a href="#h26-0-76" id="h26-0-76" class="i">+                                    Some(
</a><a href="#h26-0-77" id="h26-0-77" class="i">+                                        &quot;movies&quot;,
</a><a href="#h26-0-78" id="h26-0-78" class="i">+                                    ),
</a><a href="#h26-0-79" id="h26-0-79" class="i">+                                    &quot;id&quot;,
</a>                                 ),
<a href="#h26-0-81" id="h26-0-81" class="d">-                                &quot;genre_id&quot;,
</a>                             ),
                         ),
<a href="#h26-0-84" id="h26-0-84" class="i">+                        None,
</a>                     ),
<a href="#h26-0-86" id="h26-0-86" class="d">-                    Field(
</a><a href="#h26-0-87" id="h26-0-87" class="d">-                        7,
</a><a href="#h26-0-88" id="h26-0-88" class="d">-                        Some(
</a><a href="#h26-0-89" id="h26-0-89" class="d">-                            (
</a><a href="#h26-0-90" id="h26-0-90" class="d">-                                Some(
</a><a href="#h26-0-91" id="h26-0-91" class="d">-                                    &quot;genres&quot;,
</a><a href="#h26-0-92" id="h26-0-92" class="i">+                    (
</a><a href="#h26-0-93" id="h26-0-93" class="i">+                        Field(
</a><a href="#h26-0-94" id="h26-0-94" class="i">+                            1,
</a><a href="#h26-0-95" id="h26-0-95" class="i">+                            Some(
</a><a href="#h26-0-96" id="h26-0-96" class="i">+                                (
</a><a href="#h26-0-97" id="h26-0-97" class="i">+                                    None,
</a><a href="#h26-0-98" id="h26-0-98" class="i">+                                    &quot;title&quot;,
</a>                                 ),
<a href="#h26-0-100" id="h26-0-100" class="d">-                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h26-0-103" id="h26-0-103" class="i">+                        None,
</a>                     ),
<a href="#h26-0-105" id="h26-0-105" class="d">-                ),
</a><a href="#h26-0-106" id="h26-0-106" class="d">-            },
</a><a href="#h26-0-107" id="h26-0-107" class="d">-            expressions: [
</a><a href="#h26-0-108" id="h26-0-108" class="d">-                (
</a><a href="#h26-0-109" id="h26-0-109" class="d">-                    Field(
</a><a href="#h26-0-110" id="h26-0-110" class="d">-                        0,
</a><a href="#h26-0-111" id="h26-0-111" class="d">-                        Some(
</a><a href="#h26-0-112" id="h26-0-112" class="d">-                            (
</a><a href="#h26-0-113" id="h26-0-113" class="d">-                                Some(
</a><a href="#h26-0-114" id="h26-0-114" class="d">-                                    &quot;movies&quot;,
</a><a href="#h26-0-115" id="h26-0-115" class="i">+                    (
</a><a href="#h26-0-116" id="h26-0-116" class="i">+                        Field(
</a><a href="#h26-0-117" id="h26-0-117" class="i">+                            8,
</a><a href="#h26-0-118" id="h26-0-118" class="i">+                            Some(
</a><a href="#h26-0-119" id="h26-0-119" class="i">+                                (
</a><a href="#h26-0-120" id="h26-0-120" class="i">+                                    None,
</a><a href="#h26-0-121" id="h26-0-121" class="i">+                                    &quot;name&quot;,
</a>                                 ),
<a href="#h26-0-123" id="h26-0-123" class="d">-                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h26-0-126" id="h26-0-126" class="i">+                        None,
</a>                     ),
<a href="#h26-0-128" id="h26-0-128" class="d">-                    None,
</a><a href="#h26-0-129" id="h26-0-129" class="d">-                ),
</a><a href="#h26-0-130" id="h26-0-130" class="d">-                (
</a><a href="#h26-0-131" id="h26-0-131" class="d">-                    Field(
</a><a href="#h26-0-132" id="h26-0-132" class="d">-                        1,
</a><a href="#h26-0-133" id="h26-0-133" class="d">-                        Some(
</a><a href="#h26-0-134" id="h26-0-134" class="d">-                            (
</a><a href="#h26-0-135" id="h26-0-135" class="d">-                                None,
</a><a href="#h26-0-136" id="h26-0-136" class="d">-                                &quot;title&quot;,
</a><a href="#h26-0-137" id="h26-0-137" class="i">+                    (
</a><a href="#h26-0-138" id="h26-0-138" class="i">+                        Field(
</a><a href="#h26-0-139" id="h26-0-139" class="i">+                            8,
</a><a href="#h26-0-140" id="h26-0-140" class="i">+                            Some(
</a><a href="#h26-0-141" id="h26-0-141" class="i">+                                (
</a><a href="#h26-0-142" id="h26-0-142" class="i">+                                    Some(
</a><a href="#h26-0-143" id="h26-0-143" class="i">+                                        &quot;genres&quot;,
</a><a href="#h26-0-144" id="h26-0-144" class="i">+                                    ),
</a><a href="#h26-0-145" id="h26-0-145" class="i">+                                    &quot;name&quot;,
</a><a href="#h26-0-146" id="h26-0-146" class="i">+                                ),
</a>                             ),
                         ),
<a href="#h26-0-149" id="h26-0-149" class="i">+                        None,
</a>                     ),
<a href="#h26-0-151" id="h26-0-151" class="d">-                    None,
</a><a href="#h26-0-152" id="h26-0-152" class="i">+                    (
</a><a href="#h26-0-153" id="h26-0-153" class="i">+                        Field(
</a><a href="#h26-0-154" id="h26-0-154" class="i">+                            1,
</a><a href="#h26-0-155" id="h26-0-155" class="i">+                            Some(
</a><a href="#h26-0-156" id="h26-0-156" class="i">+                                (
</a><a href="#h26-0-157" id="h26-0-157" class="i">+                                    Some(
</a><a href="#h26-0-158" id="h26-0-158" class="i">+                                        &quot;movies&quot;,
</a><a href="#h26-0-159" id="h26-0-159" class="i">+                                    ),
</a><a href="#h26-0-160" id="h26-0-160" class="i">+                                    &quot;title&quot;,
</a><a href="#h26-0-161" id="h26-0-161" class="i">+                                ),
</a><a href="#h26-0-162" id="h26-0-162" class="i">+                            ),
</a><a href="#h26-0-163" id="h26-0-163" class="i">+                        ),
</a><a href="#h26-0-164" id="h26-0-164" class="i">+                        None,
</a><a href="#h26-0-165" id="h26-0-165" class="i">+                    ),
</a><a href="#h26-0-166" id="h26-0-166" class="i">+                ],
</a><a href="#h26-0-167" id="h26-0-167" class="i">+            },
</a><a href="#h26-0-168" id="h26-0-168" class="i">+            orders: [
</a><a href="#h26-0-169" id="h26-0-169" class="i">+                (
</a><a href="#h26-0-170" id="h26-0-170" class="i">+                    Field(
</a><a href="#h26-0-171" id="h26-0-171" class="i">+                        3,
</a><a href="#h26-0-172" id="h26-0-172" class="i">+                        None,
</a><a href="#h26-0-173" id="h26-0-173" class="i">+                    ),
</a><a href="#h26-0-174" id="h26-0-174" class="i">+                    Ascending,
</a>                 ),
                 (
                     Field(
<a href="#h26-0-178" id="h26-0-178" class="d">-                        8,
</a><a href="#h26-0-179" id="h26-0-179" class="d">-                        Some(
</a><a href="#h26-0-180" id="h26-0-180" class="d">-                            (
</a><a href="#h26-0-181" id="h26-0-181" class="d">-                                None,
</a><a href="#h26-0-182" id="h26-0-182" class="d">-                                &quot;name&quot;,
</a><a href="#h26-0-183" id="h26-0-183" class="d">-                            ),
</a><a href="#h26-0-184" id="h26-0-184" class="d">-                        ),
</a><a href="#h26-0-185" id="h26-0-185" class="i">+                        4,
</a><a href="#h26-0-186" id="h26-0-186" class="i">+                        None,
</a>                     ),
<a href="#h26-0-188" id="h26-0-188" class="d">-                    None,
</a><a href="#h26-0-189" id="h26-0-189" class="i">+                    Ascending,
</a>                 ),
             ],
         },
<a href="#h26-0-193" id="h26-0-193" class="d">-        orders: [
</a><a href="#h26-0-194" id="h26-0-194" class="i">+        expressions: [
</a>             (
                 Field(
<a href="#h26-0-197" id="h26-0-197" class="d">-                    2,
</a><a href="#h26-0-198" id="h26-0-198" class="d">-                    Some(
</a><a href="#h26-0-199" id="h26-0-199" class="d">-                        (
</a><a href="#h26-0-200" id="h26-0-200" class="d">-                            Some(
</a><a href="#h26-0-201" id="h26-0-201" class="d">-                                &quot;genres&quot;,
</a><a href="#h26-0-202" id="h26-0-202" class="d">-                            ),
</a><a href="#h26-0-203" id="h26-0-203" class="d">-                            &quot;name&quot;,
</a><a href="#h26-0-204" id="h26-0-204" class="d">-                        ),
</a><a href="#h26-0-205" id="h26-0-205" class="d">-                    ),
</a><a href="#h26-0-206" id="h26-0-206" class="i">+                    0,
</a><a href="#h26-0-207" id="h26-0-207" class="i">+                    None,
</a>                 ),
<a href="#h26-0-209" id="h26-0-209" class="d">-                Ascending,
</a><a href="#h26-0-210" id="h26-0-210" class="i">+                None,
</a>             ),
             (
                 Field(
                     1,
<a href="#h26-0-215" id="h26-0-215" class="d">-                    Some(
</a><a href="#h26-0-216" id="h26-0-216" class="d">-                        (
</a><a href="#h26-0-217" id="h26-0-217" class="d">-                            Some(
</a><a href="#h26-0-218" id="h26-0-218" class="d">-                                &quot;movies&quot;,
</a><a href="#h26-0-219" id="h26-0-219" class="d">-                            ),
</a><a href="#h26-0-220" id="h26-0-220" class="d">-                            &quot;title&quot;,
</a><a href="#h26-0-221" id="h26-0-221" class="d">-                        ),
</a><a href="#h26-0-222" id="h26-0-222" class="d">-                    ),
</a><a href="#h26-0-223" id="h26-0-223" class="i">+                    None,
</a>                 ),
<a href="#h26-0-225" id="h26-0-225" class="d">-                Ascending,
</a><a href="#h26-0-226" id="h26-0-226" class="i">+                None,
</a><a href="#h26-0-227" id="h26-0-227" class="i">+            ),
</a><a href="#h26-0-228" id="h26-0-228" class="i">+            (
</a><a href="#h26-0-229" id="h26-0-229" class="i">+                Field(
</a><a href="#h26-0-230" id="h26-0-230" class="i">+                    2,
</a><a href="#h26-0-231" id="h26-0-231" class="i">+                    None,
</a><a href="#h26-0-232" id="h26-0-232" class="i">+                ),
</a><a href="#h26-0-233" id="h26-0-233" class="i">+                None,
</a>             ),
         ],
     },
 )
 
 Optimized plan: Plan(
<a href="#h26-0-240" id="h26-0-240" class="d">-    Order {
</a><a href="#h26-0-241" id="h26-0-241" class="d">-        source: Projection {
</a><a href="#h26-0-242" id="h26-0-242" class="d">-            source: NestedLoopJoin {
</a><a href="#h26-0-243" id="h26-0-243" class="d">-                outer: Scan {
</a><a href="#h26-0-244" id="h26-0-244" class="d">-                    table: &quot;movies&quot;,
</a><a href="#h26-0-245" id="h26-0-245" class="d">-                    alias: None,
</a><a href="#h26-0-246" id="h26-0-246" class="d">-                    filter: None,
</a><a href="#h26-0-247" id="h26-0-247" class="d">-                },
</a><a href="#h26-0-248" id="h26-0-248" class="d">-                inner: Scan {
</a><a href="#h26-0-249" id="h26-0-249" class="d">-                    table: &quot;genres&quot;,
</a><a href="#h26-0-250" id="h26-0-250" class="d">-                    alias: None,
</a><a href="#h26-0-251" id="h26-0-251" class="d">-                    filter: None,
</a><a href="#h26-0-252" id="h26-0-252" class="i">+    Projection {
</a><a href="#h26-0-253" id="h26-0-253" class="i">+        source: Order {
</a><a href="#h26-0-254" id="h26-0-254" class="i">+            source: Projection {
</a><a href="#h26-0-255" id="h26-0-255" class="i">+                source: NestedLoopJoin {
</a><a href="#h26-0-256" id="h26-0-256" class="i">+                    outer: Scan {
</a><a href="#h26-0-257" id="h26-0-257" class="i">+                        table: &quot;movies&quot;,
</a><a href="#h26-0-258" id="h26-0-258" class="i">+                        alias: None,
</a><a href="#h26-0-259" id="h26-0-259" class="i">+                        filter: None,
</a><a href="#h26-0-260" id="h26-0-260" class="i">+                    },
</a><a href="#h26-0-261" id="h26-0-261" class="i">+                    inner: Scan {
</a><a href="#h26-0-262" id="h26-0-262" class="i">+                        table: &quot;genres&quot;,
</a><a href="#h26-0-263" id="h26-0-263" class="i">+                        alias: None,
</a><a href="#h26-0-264" id="h26-0-264" class="i">+                        filter: None,
</a><a href="#h26-0-265" id="h26-0-265" class="i">+                    },
</a><a href="#h26-0-266" id="h26-0-266" class="i">+                    predicate: Some(
</a><a href="#h26-0-267" id="h26-0-267" class="i">+                        Equal(
</a><a href="#h26-0-268" id="h26-0-268" class="i">+                            Field(
</a><a href="#h26-0-269" id="h26-0-269" class="i">+                                3,
</a><a href="#h26-0-270" id="h26-0-270" class="i">+                                Some(
</a><a href="#h26-0-271" id="h26-0-271" class="i">+                                    (
</a><a href="#h26-0-272" id="h26-0-272" class="i">+                                        Some(
</a><a href="#h26-0-273" id="h26-0-273" class="i">+                                            &quot;movies&quot;,
</a><a href="#h26-0-274" id="h26-0-274" class="i">+                                        ),
</a><a href="#h26-0-275" id="h26-0-275" class="i">+                                        &quot;genre_id&quot;,
</a><a href="#h26-0-276" id="h26-0-276" class="i">+                                    ),
</a><a href="#h26-0-277" id="h26-0-277" class="i">+                                ),
</a><a href="#h26-0-278" id="h26-0-278" class="i">+                            ),
</a><a href="#h26-0-279" id="h26-0-279" class="i">+                            Field(
</a><a href="#h26-0-280" id="h26-0-280" class="i">+                                7,
</a><a href="#h26-0-281" id="h26-0-281" class="i">+                                Some(
</a><a href="#h26-0-282" id="h26-0-282" class="i">+                                    (
</a><a href="#h26-0-283" id="h26-0-283" class="i">+                                        Some(
</a><a href="#h26-0-284" id="h26-0-284" class="i">+                                            &quot;genres&quot;,
</a><a href="#h26-0-285" id="h26-0-285" class="i">+                                        ),
</a><a href="#h26-0-286" id="h26-0-286" class="i">+                                        &quot;id&quot;,
</a><a href="#h26-0-287" id="h26-0-287" class="i">+                                    ),
</a><a href="#h26-0-288" id="h26-0-288" class="i">+                                ),
</a><a href="#h26-0-289" id="h26-0-289" class="i">+                            ),
</a><a href="#h26-0-290" id="h26-0-290" class="i">+                        ),
</a><a href="#h26-0-291" id="h26-0-291" class="i">+                    ),
</a><a href="#h26-0-292" id="h26-0-292" class="i">+                    pad: false,
</a><a href="#h26-0-293" id="h26-0-293" class="i">+                    flip: false,
</a>                 },
<a href="#h26-0-295" id="h26-0-295" class="d">-                predicate: Some(
</a><a href="#h26-0-296" id="h26-0-296" class="d">-                    Equal(
</a><a href="#h26-0-297" id="h26-0-297" class="i">+                expressions: [
</a><a href="#h26-0-298" id="h26-0-298" class="i">+                    (
</a>                         Field(
<a href="#h26-0-300" id="h26-0-300" class="d">-                            3,
</a><a href="#h26-0-301" id="h26-0-301" class="i">+                            0,
</a>                             Some(
                                 (
                                     Some(
                                         &quot;movies&quot;,
                                     ),
<a href="#h26-0-307" id="h26-0-307" class="d">-                                    &quot;genre_id&quot;,
</a><a href="#h26-0-308" id="h26-0-308" class="i">+                                    &quot;id&quot;,
</a>                                 ),
                             ),
                         ),
<a href="#h26-0-312" id="h26-0-312" class="i">+                        None,
</a><a href="#h26-0-313" id="h26-0-313" class="i">+                    ),
</a><a href="#h26-0-314" id="h26-0-314" class="i">+                    (
</a>                         Field(
<a href="#h26-0-316" id="h26-0-316" class="d">-                            7,
</a><a href="#h26-0-317" id="h26-0-317" class="i">+                            1,
</a><a href="#h26-0-318" id="h26-0-318" class="i">+                            Some(
</a><a href="#h26-0-319" id="h26-0-319" class="i">+                                (
</a><a href="#h26-0-320" id="h26-0-320" class="i">+                                    None,
</a><a href="#h26-0-321" id="h26-0-321" class="i">+                                    &quot;title&quot;,
</a><a href="#h26-0-322" id="h26-0-322" class="i">+                                ),
</a><a href="#h26-0-323" id="h26-0-323" class="i">+                            ),
</a><a href="#h26-0-324" id="h26-0-324" class="i">+                        ),
</a><a href="#h26-0-325" id="h26-0-325" class="i">+                        None,
</a><a href="#h26-0-326" id="h26-0-326" class="i">+                    ),
</a><a href="#h26-0-327" id="h26-0-327" class="i">+                    (
</a><a href="#h26-0-328" id="h26-0-328" class="i">+                        Field(
</a><a href="#h26-0-329" id="h26-0-329" class="i">+                            8,
</a><a href="#h26-0-330" id="h26-0-330" class="i">+                            Some(
</a><a href="#h26-0-331" id="h26-0-331" class="i">+                                (
</a><a href="#h26-0-332" id="h26-0-332" class="i">+                                    None,
</a><a href="#h26-0-333" id="h26-0-333" class="i">+                                    &quot;name&quot;,
</a><a href="#h26-0-334" id="h26-0-334" class="i">+                                ),
</a><a href="#h26-0-335" id="h26-0-335" class="i">+                            ),
</a><a href="#h26-0-336" id="h26-0-336" class="i">+                        ),
</a><a href="#h26-0-337" id="h26-0-337" class="i">+                        None,
</a><a href="#h26-0-338" id="h26-0-338" class="i">+                    ),
</a><a href="#h26-0-339" id="h26-0-339" class="i">+                    (
</a><a href="#h26-0-340" id="h26-0-340" class="i">+                        Field(
</a><a href="#h26-0-341" id="h26-0-341" class="i">+                            8,
</a>                             Some(
                                 (
                                     Some(
                                         &quot;genres&quot;,
                                     ),
<a href="#h26-0-347" id="h26-0-347" class="d">-                                    &quot;id&quot;,
</a><a href="#h26-0-348" id="h26-0-348" class="i">+                                    &quot;name&quot;,
</a>                                 ),
                             ),
                         ),
<a href="#h26-0-352" id="h26-0-352" class="i">+                        None,
</a>                     ),
<a href="#h26-0-354" id="h26-0-354" class="d">-                ),
</a><a href="#h26-0-355" id="h26-0-355" class="d">-                pad: false,
</a><a href="#h26-0-356" id="h26-0-356" class="d">-                flip: false,
</a><a href="#h26-0-357" id="h26-0-357" class="d">-            },
</a><a href="#h26-0-358" id="h26-0-358" class="d">-            expressions: [
</a><a href="#h26-0-359" id="h26-0-359" class="d">-                (
</a><a href="#h26-0-360" id="h26-0-360" class="d">-                    Field(
</a><a href="#h26-0-361" id="h26-0-361" class="d">-                        0,
</a><a href="#h26-0-362" id="h26-0-362" class="d">-                        Some(
</a><a href="#h26-0-363" id="h26-0-363" class="d">-                            (
</a><a href="#h26-0-364" id="h26-0-364" class="d">-                                Some(
</a><a href="#h26-0-365" id="h26-0-365" class="d">-                                    &quot;movies&quot;,
</a><a href="#h26-0-366" id="h26-0-366" class="i">+                    (
</a><a href="#h26-0-367" id="h26-0-367" class="i">+                        Field(
</a><a href="#h26-0-368" id="h26-0-368" class="i">+                            1,
</a><a href="#h26-0-369" id="h26-0-369" class="i">+                            Some(
</a><a href="#h26-0-370" id="h26-0-370" class="i">+                                (
</a><a href="#h26-0-371" id="h26-0-371" class="i">+                                    Some(
</a><a href="#h26-0-372" id="h26-0-372" class="i">+                                        &quot;movies&quot;,
</a><a href="#h26-0-373" id="h26-0-373" class="i">+                                    ),
</a><a href="#h26-0-374" id="h26-0-374" class="i">+                                    &quot;title&quot;,
</a>                                 ),
<a href="#h26-0-376" id="h26-0-376" class="d">-                                &quot;id&quot;,
</a>                             ),
                         ),
<a href="#h26-0-379" id="h26-0-379" class="i">+                        None,
</a>                     ),
<a href="#h26-0-381" id="h26-0-381" class="d">-                    None,
</a><a href="#h26-0-382" id="h26-0-382" class="d">-                ),
</a><a href="#h26-0-383" id="h26-0-383" class="i">+                ],
</a><a href="#h26-0-384" id="h26-0-384" class="i">+            },
</a><a href="#h26-0-385" id="h26-0-385" class="i">+            orders: [
</a>                 (
                     Field(
<a href="#h26-0-388" id="h26-0-388" class="d">-                        1,
</a><a href="#h26-0-389" id="h26-0-389" class="d">-                        Some(
</a><a href="#h26-0-390" id="h26-0-390" class="d">-                            (
</a><a href="#h26-0-391" id="h26-0-391" class="d">-                                None,
</a><a href="#h26-0-392" id="h26-0-392" class="d">-                                &quot;title&quot;,
</a><a href="#h26-0-393" id="h26-0-393" class="d">-                            ),
</a><a href="#h26-0-394" id="h26-0-394" class="d">-                        ),
</a><a href="#h26-0-395" id="h26-0-395" class="i">+                        3,
</a><a href="#h26-0-396" id="h26-0-396" class="i">+                        None,
</a>                     ),
<a href="#h26-0-398" id="h26-0-398" class="d">-                    None,
</a><a href="#h26-0-399" id="h26-0-399" class="i">+                    Ascending,
</a>                 ),
                 (
                     Field(
<a href="#h26-0-403" id="h26-0-403" class="d">-                        8,
</a><a href="#h26-0-404" id="h26-0-404" class="d">-                        Some(
</a><a href="#h26-0-405" id="h26-0-405" class="d">-                            (
</a><a href="#h26-0-406" id="h26-0-406" class="d">-                                None,
</a><a href="#h26-0-407" id="h26-0-407" class="d">-                                &quot;name&quot;,
</a><a href="#h26-0-408" id="h26-0-408" class="d">-                            ),
</a><a href="#h26-0-409" id="h26-0-409" class="d">-                        ),
</a><a href="#h26-0-410" id="h26-0-410" class="i">+                        4,
</a><a href="#h26-0-411" id="h26-0-411" class="i">+                        None,
</a>                     ),
<a href="#h26-0-413" id="h26-0-413" class="d">-                    None,
</a><a href="#h26-0-414" id="h26-0-414" class="i">+                    Ascending,
</a>                 ),
             ],
         },
<a href="#h26-0-418" id="h26-0-418" class="d">-        orders: [
</a><a href="#h26-0-419" id="h26-0-419" class="i">+        expressions: [
</a>             (
                 Field(
<a href="#h26-0-422" id="h26-0-422" class="d">-                    2,
</a><a href="#h26-0-423" id="h26-0-423" class="d">-                    Some(
</a><a href="#h26-0-424" id="h26-0-424" class="d">-                        (
</a><a href="#h26-0-425" id="h26-0-425" class="d">-                            Some(
</a><a href="#h26-0-426" id="h26-0-426" class="d">-                                &quot;genres&quot;,
</a><a href="#h26-0-427" id="h26-0-427" class="d">-                            ),
</a><a href="#h26-0-428" id="h26-0-428" class="d">-                            &quot;name&quot;,
</a><a href="#h26-0-429" id="h26-0-429" class="d">-                        ),
</a><a href="#h26-0-430" id="h26-0-430" class="d">-                    ),
</a><a href="#h26-0-431" id="h26-0-431" class="i">+                    0,
</a><a href="#h26-0-432" id="h26-0-432" class="i">+                    None,
</a>                 ),
<a href="#h26-0-434" id="h26-0-434" class="d">-                Ascending,
</a><a href="#h26-0-435" id="h26-0-435" class="i">+                None,
</a>             ),
             (
                 Field(
                     1,
<a href="#h26-0-440" id="h26-0-440" class="d">-                    Some(
</a><a href="#h26-0-441" id="h26-0-441" class="d">-                        (
</a><a href="#h26-0-442" id="h26-0-442" class="d">-                            Some(
</a><a href="#h26-0-443" id="h26-0-443" class="d">-                                &quot;movies&quot;,
</a><a href="#h26-0-444" id="h26-0-444" class="d">-                            ),
</a><a href="#h26-0-445" id="h26-0-445" class="d">-                            &quot;title&quot;,
</a><a href="#h26-0-446" id="h26-0-446" class="d">-                        ),
</a><a href="#h26-0-447" id="h26-0-447" class="d">-                    ),
</a><a href="#h26-0-448" id="h26-0-448" class="i">+                    None,
</a>                 ),
<a href="#h26-0-450" id="h26-0-450" class="d">-                Ascending,
</a><a href="#h26-0-451" id="h26-0-451" class="i">+                None,
</a><a href="#h26-0-452" id="h26-0-452" class="i">+            ),
</a><a href="#h26-0-453" id="h26-0-453" class="i">+            (
</a><a href="#h26-0-454" id="h26-0-454" class="i">+                Field(
</a><a href="#h26-0-455" id="h26-0-455" class="i">+                    2,
</a><a href="#h26-0-456" id="h26-0-456" class="i">+                    None,
</a><a href="#h26-0-457" id="h26-0-457" class="i">+                ),
</a><a href="#h26-0-458" id="h26-0-458" class="i">+                None,
</a>             ),
         ],
     },
<b>diff --git a/<a id="h27" href="../file/tests/sql/query/order_group_by_noselect.html">tests/sql/query/order_group_by_noselect</a> b/<a href="../file/tests/sql/query/order_group_by_noselect.html">tests/sql/query/order_group_by_noselect</a></b>
<a href="#h27-0" id="h27-0" class="h">@@ -0,0 +1,223 @@
</a><a href="#h27-0-0" id="h27-0-0" class="i">+Query: SELECT MAX(rating) FROM movies GROUP BY studio_id ORDER BY studio_id
</a><a href="#h27-0-1" id="h27-0-1" class="i">+
</a><a href="#h27-0-2" id="h27-0-2" class="i">+AST: Select {
</a><a href="#h27-0-3" id="h27-0-3" class="i">+    select: SelectClause {
</a><a href="#h27-0-4" id="h27-0-4" class="i">+        expressions: [
</a><a href="#h27-0-5" id="h27-0-5" class="i">+            (
</a><a href="#h27-0-6" id="h27-0-6" class="i">+                Function(
</a><a href="#h27-0-7" id="h27-0-7" class="i">+                    &quot;max&quot;,
</a><a href="#h27-0-8" id="h27-0-8" class="i">+                    [
</a><a href="#h27-0-9" id="h27-0-9" class="i">+                        Field(
</a><a href="#h27-0-10" id="h27-0-10" class="i">+                            None,
</a><a href="#h27-0-11" id="h27-0-11" class="i">+                            &quot;rating&quot;,
</a><a href="#h27-0-12" id="h27-0-12" class="i">+                        ),
</a><a href="#h27-0-13" id="h27-0-13" class="i">+                    ],
</a><a href="#h27-0-14" id="h27-0-14" class="i">+                ),
</a><a href="#h27-0-15" id="h27-0-15" class="i">+                None,
</a><a href="#h27-0-16" id="h27-0-16" class="i">+            ),
</a><a href="#h27-0-17" id="h27-0-17" class="i">+        ],
</a><a href="#h27-0-18" id="h27-0-18" class="i">+    },
</a><a href="#h27-0-19" id="h27-0-19" class="i">+    from: Some(
</a><a href="#h27-0-20" id="h27-0-20" class="i">+        FromClause {
</a><a href="#h27-0-21" id="h27-0-21" class="i">+            items: [
</a><a href="#h27-0-22" id="h27-0-22" class="i">+                Table {
</a><a href="#h27-0-23" id="h27-0-23" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h27-0-24" id="h27-0-24" class="i">+                    alias: None,
</a><a href="#h27-0-25" id="h27-0-25" class="i">+                },
</a><a href="#h27-0-26" id="h27-0-26" class="i">+            ],
</a><a href="#h27-0-27" id="h27-0-27" class="i">+        },
</a><a href="#h27-0-28" id="h27-0-28" class="i">+    ),
</a><a href="#h27-0-29" id="h27-0-29" class="i">+    where: None,
</a><a href="#h27-0-30" id="h27-0-30" class="i">+    group_by: Some(
</a><a href="#h27-0-31" id="h27-0-31" class="i">+        GroupByClause(
</a><a href="#h27-0-32" id="h27-0-32" class="i">+            [
</a><a href="#h27-0-33" id="h27-0-33" class="i">+                Field(
</a><a href="#h27-0-34" id="h27-0-34" class="i">+                    None,
</a><a href="#h27-0-35" id="h27-0-35" class="i">+                    &quot;studio_id&quot;,
</a><a href="#h27-0-36" id="h27-0-36" class="i">+                ),
</a><a href="#h27-0-37" id="h27-0-37" class="i">+            ],
</a><a href="#h27-0-38" id="h27-0-38" class="i">+        ),
</a><a href="#h27-0-39" id="h27-0-39" class="i">+    ),
</a><a href="#h27-0-40" id="h27-0-40" class="i">+    having: None,
</a><a href="#h27-0-41" id="h27-0-41" class="i">+    order: [
</a><a href="#h27-0-42" id="h27-0-42" class="i">+        (
</a><a href="#h27-0-43" id="h27-0-43" class="i">+            Field(
</a><a href="#h27-0-44" id="h27-0-44" class="i">+                None,
</a><a href="#h27-0-45" id="h27-0-45" class="i">+                &quot;studio_id&quot;,
</a><a href="#h27-0-46" id="h27-0-46" class="i">+            ),
</a><a href="#h27-0-47" id="h27-0-47" class="i">+            Ascending,
</a><a href="#h27-0-48" id="h27-0-48" class="i">+        ),
</a><a href="#h27-0-49" id="h27-0-49" class="i">+    ],
</a><a href="#h27-0-50" id="h27-0-50" class="i">+    offset: None,
</a><a href="#h27-0-51" id="h27-0-51" class="i">+    limit: None,
</a><a href="#h27-0-52" id="h27-0-52" class="i">+}
</a><a href="#h27-0-53" id="h27-0-53" class="i">+
</a><a href="#h27-0-54" id="h27-0-54" class="i">+Plan: Plan(
</a><a href="#h27-0-55" id="h27-0-55" class="i">+    Projection {
</a><a href="#h27-0-56" id="h27-0-56" class="i">+        source: Order {
</a><a href="#h27-0-57" id="h27-0-57" class="i">+            source: Projection {
</a><a href="#h27-0-58" id="h27-0-58" class="i">+                source: Aggregation {
</a><a href="#h27-0-59" id="h27-0-59" class="i">+                    source: Projection {
</a><a href="#h27-0-60" id="h27-0-60" class="i">+                        source: Scan {
</a><a href="#h27-0-61" id="h27-0-61" class="i">+                            table: &quot;movies&quot;,
</a><a href="#h27-0-62" id="h27-0-62" class="i">+                            alias: None,
</a><a href="#h27-0-63" id="h27-0-63" class="i">+                            filter: None,
</a><a href="#h27-0-64" id="h27-0-64" class="i">+                        },
</a><a href="#h27-0-65" id="h27-0-65" class="i">+                        expressions: [
</a><a href="#h27-0-66" id="h27-0-66" class="i">+                            (
</a><a href="#h27-0-67" id="h27-0-67" class="i">+                                Field(
</a><a href="#h27-0-68" id="h27-0-68" class="i">+                                    5,
</a><a href="#h27-0-69" id="h27-0-69" class="i">+                                    Some(
</a><a href="#h27-0-70" id="h27-0-70" class="i">+                                        (
</a><a href="#h27-0-71" id="h27-0-71" class="i">+                                            None,
</a><a href="#h27-0-72" id="h27-0-72" class="i">+                                            &quot;rating&quot;,
</a><a href="#h27-0-73" id="h27-0-73" class="i">+                                        ),
</a><a href="#h27-0-74" id="h27-0-74" class="i">+                                    ),
</a><a href="#h27-0-75" id="h27-0-75" class="i">+                                ),
</a><a href="#h27-0-76" id="h27-0-76" class="i">+                                None,
</a><a href="#h27-0-77" id="h27-0-77" class="i">+                            ),
</a><a href="#h27-0-78" id="h27-0-78" class="i">+                            (
</a><a href="#h27-0-79" id="h27-0-79" class="i">+                                Field(
</a><a href="#h27-0-80" id="h27-0-80" class="i">+                                    2,
</a><a href="#h27-0-81" id="h27-0-81" class="i">+                                    Some(
</a><a href="#h27-0-82" id="h27-0-82" class="i">+                                        (
</a><a href="#h27-0-83" id="h27-0-83" class="i">+                                            None,
</a><a href="#h27-0-84" id="h27-0-84" class="i">+                                            &quot;studio_id&quot;,
</a><a href="#h27-0-85" id="h27-0-85" class="i">+                                        ),
</a><a href="#h27-0-86" id="h27-0-86" class="i">+                                    ),
</a><a href="#h27-0-87" id="h27-0-87" class="i">+                                ),
</a><a href="#h27-0-88" id="h27-0-88" class="i">+                                None,
</a><a href="#h27-0-89" id="h27-0-89" class="i">+                            ),
</a><a href="#h27-0-90" id="h27-0-90" class="i">+                        ],
</a><a href="#h27-0-91" id="h27-0-91" class="i">+                    },
</a><a href="#h27-0-92" id="h27-0-92" class="i">+                    aggregates: [
</a><a href="#h27-0-93" id="h27-0-93" class="i">+                        Max,
</a><a href="#h27-0-94" id="h27-0-94" class="i">+                    ],
</a><a href="#h27-0-95" id="h27-0-95" class="i">+                },
</a><a href="#h27-0-96" id="h27-0-96" class="i">+                expressions: [
</a><a href="#h27-0-97" id="h27-0-97" class="i">+                    (
</a><a href="#h27-0-98" id="h27-0-98" class="i">+                        Field(
</a><a href="#h27-0-99" id="h27-0-99" class="i">+                            0,
</a><a href="#h27-0-100" id="h27-0-100" class="i">+                            None,
</a><a href="#h27-0-101" id="h27-0-101" class="i">+                        ),
</a><a href="#h27-0-102" id="h27-0-102" class="i">+                        None,
</a><a href="#h27-0-103" id="h27-0-103" class="i">+                    ),
</a><a href="#h27-0-104" id="h27-0-104" class="i">+                    (
</a><a href="#h27-0-105" id="h27-0-105" class="i">+                        Field(
</a><a href="#h27-0-106" id="h27-0-106" class="i">+                            1,
</a><a href="#h27-0-107" id="h27-0-107" class="i">+                            None,
</a><a href="#h27-0-108" id="h27-0-108" class="i">+                        ),
</a><a href="#h27-0-109" id="h27-0-109" class="i">+                        None,
</a><a href="#h27-0-110" id="h27-0-110" class="i">+                    ),
</a><a href="#h27-0-111" id="h27-0-111" class="i">+                ],
</a><a href="#h27-0-112" id="h27-0-112" class="i">+            },
</a><a href="#h27-0-113" id="h27-0-113" class="i">+            orders: [
</a><a href="#h27-0-114" id="h27-0-114" class="i">+                (
</a><a href="#h27-0-115" id="h27-0-115" class="i">+                    Field(
</a><a href="#h27-0-116" id="h27-0-116" class="i">+                        1,
</a><a href="#h27-0-117" id="h27-0-117" class="i">+                        None,
</a><a href="#h27-0-118" id="h27-0-118" class="i">+                    ),
</a><a href="#h27-0-119" id="h27-0-119" class="i">+                    Ascending,
</a><a href="#h27-0-120" id="h27-0-120" class="i">+                ),
</a><a href="#h27-0-121" id="h27-0-121" class="i">+            ],
</a><a href="#h27-0-122" id="h27-0-122" class="i">+        },
</a><a href="#h27-0-123" id="h27-0-123" class="i">+        expressions: [
</a><a href="#h27-0-124" id="h27-0-124" class="i">+            (
</a><a href="#h27-0-125" id="h27-0-125" class="i">+                Field(
</a><a href="#h27-0-126" id="h27-0-126" class="i">+                    0,
</a><a href="#h27-0-127" id="h27-0-127" class="i">+                    None,
</a><a href="#h27-0-128" id="h27-0-128" class="i">+                ),
</a><a href="#h27-0-129" id="h27-0-129" class="i">+                None,
</a><a href="#h27-0-130" id="h27-0-130" class="i">+            ),
</a><a href="#h27-0-131" id="h27-0-131" class="i">+        ],
</a><a href="#h27-0-132" id="h27-0-132" class="i">+    },
</a><a href="#h27-0-133" id="h27-0-133" class="i">+)
</a><a href="#h27-0-134" id="h27-0-134" class="i">+
</a><a href="#h27-0-135" id="h27-0-135" class="i">+Optimized plan: Plan(
</a><a href="#h27-0-136" id="h27-0-136" class="i">+    Projection {
</a><a href="#h27-0-137" id="h27-0-137" class="i">+        source: Order {
</a><a href="#h27-0-138" id="h27-0-138" class="i">+            source: Projection {
</a><a href="#h27-0-139" id="h27-0-139" class="i">+                source: Aggregation {
</a><a href="#h27-0-140" id="h27-0-140" class="i">+                    source: Projection {
</a><a href="#h27-0-141" id="h27-0-141" class="i">+                        source: Scan {
</a><a href="#h27-0-142" id="h27-0-142" class="i">+                            table: &quot;movies&quot;,
</a><a href="#h27-0-143" id="h27-0-143" class="i">+                            alias: None,
</a><a href="#h27-0-144" id="h27-0-144" class="i">+                            filter: None,
</a><a href="#h27-0-145" id="h27-0-145" class="i">+                        },
</a><a href="#h27-0-146" id="h27-0-146" class="i">+                        expressions: [
</a><a href="#h27-0-147" id="h27-0-147" class="i">+                            (
</a><a href="#h27-0-148" id="h27-0-148" class="i">+                                Field(
</a><a href="#h27-0-149" id="h27-0-149" class="i">+                                    5,
</a><a href="#h27-0-150" id="h27-0-150" class="i">+                                    Some(
</a><a href="#h27-0-151" id="h27-0-151" class="i">+                                        (
</a><a href="#h27-0-152" id="h27-0-152" class="i">+                                            None,
</a><a href="#h27-0-153" id="h27-0-153" class="i">+                                            &quot;rating&quot;,
</a><a href="#h27-0-154" id="h27-0-154" class="i">+                                        ),
</a><a href="#h27-0-155" id="h27-0-155" class="i">+                                    ),
</a><a href="#h27-0-156" id="h27-0-156" class="i">+                                ),
</a><a href="#h27-0-157" id="h27-0-157" class="i">+                                None,
</a><a href="#h27-0-158" id="h27-0-158" class="i">+                            ),
</a><a href="#h27-0-159" id="h27-0-159" class="i">+                            (
</a><a href="#h27-0-160" id="h27-0-160" class="i">+                                Field(
</a><a href="#h27-0-161" id="h27-0-161" class="i">+                                    2,
</a><a href="#h27-0-162" id="h27-0-162" class="i">+                                    Some(
</a><a href="#h27-0-163" id="h27-0-163" class="i">+                                        (
</a><a href="#h27-0-164" id="h27-0-164" class="i">+                                            None,
</a><a href="#h27-0-165" id="h27-0-165" class="i">+                                            &quot;studio_id&quot;,
</a><a href="#h27-0-166" id="h27-0-166" class="i">+                                        ),
</a><a href="#h27-0-167" id="h27-0-167" class="i">+                                    ),
</a><a href="#h27-0-168" id="h27-0-168" class="i">+                                ),
</a><a href="#h27-0-169" id="h27-0-169" class="i">+                                None,
</a><a href="#h27-0-170" id="h27-0-170" class="i">+                            ),
</a><a href="#h27-0-171" id="h27-0-171" class="i">+                        ],
</a><a href="#h27-0-172" id="h27-0-172" class="i">+                    },
</a><a href="#h27-0-173" id="h27-0-173" class="i">+                    aggregates: [
</a><a href="#h27-0-174" id="h27-0-174" class="i">+                        Max,
</a><a href="#h27-0-175" id="h27-0-175" class="i">+                    ],
</a><a href="#h27-0-176" id="h27-0-176" class="i">+                },
</a><a href="#h27-0-177" id="h27-0-177" class="i">+                expressions: [
</a><a href="#h27-0-178" id="h27-0-178" class="i">+                    (
</a><a href="#h27-0-179" id="h27-0-179" class="i">+                        Field(
</a><a href="#h27-0-180" id="h27-0-180" class="i">+                            0,
</a><a href="#h27-0-181" id="h27-0-181" class="i">+                            None,
</a><a href="#h27-0-182" id="h27-0-182" class="i">+                        ),
</a><a href="#h27-0-183" id="h27-0-183" class="i">+                        None,
</a><a href="#h27-0-184" id="h27-0-184" class="i">+                    ),
</a><a href="#h27-0-185" id="h27-0-185" class="i">+                    (
</a><a href="#h27-0-186" id="h27-0-186" class="i">+                        Field(
</a><a href="#h27-0-187" id="h27-0-187" class="i">+                            1,
</a><a href="#h27-0-188" id="h27-0-188" class="i">+                            None,
</a><a href="#h27-0-189" id="h27-0-189" class="i">+                        ),
</a><a href="#h27-0-190" id="h27-0-190" class="i">+                        None,
</a><a href="#h27-0-191" id="h27-0-191" class="i">+                    ),
</a><a href="#h27-0-192" id="h27-0-192" class="i">+                ],
</a><a href="#h27-0-193" id="h27-0-193" class="i">+            },
</a><a href="#h27-0-194" id="h27-0-194" class="i">+            orders: [
</a><a href="#h27-0-195" id="h27-0-195" class="i">+                (
</a><a href="#h27-0-196" id="h27-0-196" class="i">+                    Field(
</a><a href="#h27-0-197" id="h27-0-197" class="i">+                        1,
</a><a href="#h27-0-198" id="h27-0-198" class="i">+                        None,
</a><a href="#h27-0-199" id="h27-0-199" class="i">+                    ),
</a><a href="#h27-0-200" id="h27-0-200" class="i">+                    Ascending,
</a><a href="#h27-0-201" id="h27-0-201" class="i">+                ),
</a><a href="#h27-0-202" id="h27-0-202" class="i">+            ],
</a><a href="#h27-0-203" id="h27-0-203" class="i">+        },
</a><a href="#h27-0-204" id="h27-0-204" class="i">+        expressions: [
</a><a href="#h27-0-205" id="h27-0-205" class="i">+            (
</a><a href="#h27-0-206" id="h27-0-206" class="i">+                Field(
</a><a href="#h27-0-207" id="h27-0-207" class="i">+                    0,
</a><a href="#h27-0-208" id="h27-0-208" class="i">+                    None,
</a><a href="#h27-0-209" id="h27-0-209" class="i">+                ),
</a><a href="#h27-0-210" id="h27-0-210" class="i">+                None,
</a><a href="#h27-0-211" id="h27-0-211" class="i">+            ),
</a><a href="#h27-0-212" id="h27-0-212" class="i">+        ],
</a><a href="#h27-0-213" id="h27-0-213" class="i">+    },
</a><a href="#h27-0-214" id="h27-0-214" class="i">+)
</a><a href="#h27-0-215" id="h27-0-215" class="i">+
</a><a href="#h27-0-216" id="h27-0-216" class="i">+Query: SELECT MAX(rating) FROM movies GROUP BY studio_id ORDER BY studio_id
</a><a href="#h27-0-217" id="h27-0-217" class="i">+
</a><a href="#h27-0-218" id="h27-0-218" class="i">+Result: [&quot;?&quot;]
</a><a href="#h27-0-219" id="h27-0-219" class="i">+[Float(8.2)]
</a><a href="#h27-0-220" id="h27-0-220" class="i">+[Float(7.6)]
</a><a href="#h27-0-221" id="h27-0-221" class="i">+[Float(6.9)]
</a><a href="#h27-0-222" id="h27-0-222" class="i">+[Float(8.8)]
</a><b>diff --git a/<a id="h28" href="../file/tests/sql/query/order_noselect.html">tests/sql/query/order_noselect</a> b/<a href="../file/tests/sql/query/order_noselect.html">tests/sql/query/order_noselect</a></b>
<a href="#h28-0" id="h28-0" class="h">@@ -0,0 +1,214 @@
</a><a href="#h28-0-0" id="h28-0-0" class="i">+Query: SELECT id, title FROM movies ORDER BY released
</a><a href="#h28-0-1" id="h28-0-1" class="i">+
</a><a href="#h28-0-2" id="h28-0-2" class="i">+AST: Select {
</a><a href="#h28-0-3" id="h28-0-3" class="i">+    select: SelectClause {
</a><a href="#h28-0-4" id="h28-0-4" class="i">+        expressions: [
</a><a href="#h28-0-5" id="h28-0-5" class="i">+            (
</a><a href="#h28-0-6" id="h28-0-6" class="i">+                Field(
</a><a href="#h28-0-7" id="h28-0-7" class="i">+                    None,
</a><a href="#h28-0-8" id="h28-0-8" class="i">+                    &quot;id&quot;,
</a><a href="#h28-0-9" id="h28-0-9" class="i">+                ),
</a><a href="#h28-0-10" id="h28-0-10" class="i">+                None,
</a><a href="#h28-0-11" id="h28-0-11" class="i">+            ),
</a><a href="#h28-0-12" id="h28-0-12" class="i">+            (
</a><a href="#h28-0-13" id="h28-0-13" class="i">+                Field(
</a><a href="#h28-0-14" id="h28-0-14" class="i">+                    None,
</a><a href="#h28-0-15" id="h28-0-15" class="i">+                    &quot;title&quot;,
</a><a href="#h28-0-16" id="h28-0-16" class="i">+                ),
</a><a href="#h28-0-17" id="h28-0-17" class="i">+                None,
</a><a href="#h28-0-18" id="h28-0-18" class="i">+            ),
</a><a href="#h28-0-19" id="h28-0-19" class="i">+        ],
</a><a href="#h28-0-20" id="h28-0-20" class="i">+    },
</a><a href="#h28-0-21" id="h28-0-21" class="i">+    from: Some(
</a><a href="#h28-0-22" id="h28-0-22" class="i">+        FromClause {
</a><a href="#h28-0-23" id="h28-0-23" class="i">+            items: [
</a><a href="#h28-0-24" id="h28-0-24" class="i">+                Table {
</a><a href="#h28-0-25" id="h28-0-25" class="i">+                    name: &quot;movies&quot;,
</a><a href="#h28-0-26" id="h28-0-26" class="i">+                    alias: None,
</a><a href="#h28-0-27" id="h28-0-27" class="i">+                },
</a><a href="#h28-0-28" id="h28-0-28" class="i">+            ],
</a><a href="#h28-0-29" id="h28-0-29" class="i">+        },
</a><a href="#h28-0-30" id="h28-0-30" class="i">+    ),
</a><a href="#h28-0-31" id="h28-0-31" class="i">+    where: None,
</a><a href="#h28-0-32" id="h28-0-32" class="i">+    group_by: None,
</a><a href="#h28-0-33" id="h28-0-33" class="i">+    having: None,
</a><a href="#h28-0-34" id="h28-0-34" class="i">+    order: [
</a><a href="#h28-0-35" id="h28-0-35" class="i">+        (
</a><a href="#h28-0-36" id="h28-0-36" class="i">+            Field(
</a><a href="#h28-0-37" id="h28-0-37" class="i">+                None,
</a><a href="#h28-0-38" id="h28-0-38" class="i">+                &quot;released&quot;,
</a><a href="#h28-0-39" id="h28-0-39" class="i">+            ),
</a><a href="#h28-0-40" id="h28-0-40" class="i">+            Ascending,
</a><a href="#h28-0-41" id="h28-0-41" class="i">+        ),
</a><a href="#h28-0-42" id="h28-0-42" class="i">+    ],
</a><a href="#h28-0-43" id="h28-0-43" class="i">+    offset: None,
</a><a href="#h28-0-44" id="h28-0-44" class="i">+    limit: None,
</a><a href="#h28-0-45" id="h28-0-45" class="i">+}
</a><a href="#h28-0-46" id="h28-0-46" class="i">+
</a><a href="#h28-0-47" id="h28-0-47" class="i">+Plan: Plan(
</a><a href="#h28-0-48" id="h28-0-48" class="i">+    Projection {
</a><a href="#h28-0-49" id="h28-0-49" class="i">+        source: Order {
</a><a href="#h28-0-50" id="h28-0-50" class="i">+            source: Projection {
</a><a href="#h28-0-51" id="h28-0-51" class="i">+                source: Scan {
</a><a href="#h28-0-52" id="h28-0-52" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h28-0-53" id="h28-0-53" class="i">+                    alias: None,
</a><a href="#h28-0-54" id="h28-0-54" class="i">+                    filter: None,
</a><a href="#h28-0-55" id="h28-0-55" class="i">+                },
</a><a href="#h28-0-56" id="h28-0-56" class="i">+                expressions: [
</a><a href="#h28-0-57" id="h28-0-57" class="i">+                    (
</a><a href="#h28-0-58" id="h28-0-58" class="i">+                        Field(
</a><a href="#h28-0-59" id="h28-0-59" class="i">+                            0,
</a><a href="#h28-0-60" id="h28-0-60" class="i">+                            Some(
</a><a href="#h28-0-61" id="h28-0-61" class="i">+                                (
</a><a href="#h28-0-62" id="h28-0-62" class="i">+                                    None,
</a><a href="#h28-0-63" id="h28-0-63" class="i">+                                    &quot;id&quot;,
</a><a href="#h28-0-64" id="h28-0-64" class="i">+                                ),
</a><a href="#h28-0-65" id="h28-0-65" class="i">+                            ),
</a><a href="#h28-0-66" id="h28-0-66" class="i">+                        ),
</a><a href="#h28-0-67" id="h28-0-67" class="i">+                        None,
</a><a href="#h28-0-68" id="h28-0-68" class="i">+                    ),
</a><a href="#h28-0-69" id="h28-0-69" class="i">+                    (
</a><a href="#h28-0-70" id="h28-0-70" class="i">+                        Field(
</a><a href="#h28-0-71" id="h28-0-71" class="i">+                            1,
</a><a href="#h28-0-72" id="h28-0-72" class="i">+                            Some(
</a><a href="#h28-0-73" id="h28-0-73" class="i">+                                (
</a><a href="#h28-0-74" id="h28-0-74" class="i">+                                    None,
</a><a href="#h28-0-75" id="h28-0-75" class="i">+                                    &quot;title&quot;,
</a><a href="#h28-0-76" id="h28-0-76" class="i">+                                ),
</a><a href="#h28-0-77" id="h28-0-77" class="i">+                            ),
</a><a href="#h28-0-78" id="h28-0-78" class="i">+                        ),
</a><a href="#h28-0-79" id="h28-0-79" class="i">+                        None,
</a><a href="#h28-0-80" id="h28-0-80" class="i">+                    ),
</a><a href="#h28-0-81" id="h28-0-81" class="i">+                    (
</a><a href="#h28-0-82" id="h28-0-82" class="i">+                        Field(
</a><a href="#h28-0-83" id="h28-0-83" class="i">+                            4,
</a><a href="#h28-0-84" id="h28-0-84" class="i">+                            Some(
</a><a href="#h28-0-85" id="h28-0-85" class="i">+                                (
</a><a href="#h28-0-86" id="h28-0-86" class="i">+                                    None,
</a><a href="#h28-0-87" id="h28-0-87" class="i">+                                    &quot;released&quot;,
</a><a href="#h28-0-88" id="h28-0-88" class="i">+                                ),
</a><a href="#h28-0-89" id="h28-0-89" class="i">+                            ),
</a><a href="#h28-0-90" id="h28-0-90" class="i">+                        ),
</a><a href="#h28-0-91" id="h28-0-91" class="i">+                        None,
</a><a href="#h28-0-92" id="h28-0-92" class="i">+                    ),
</a><a href="#h28-0-93" id="h28-0-93" class="i">+                ],
</a><a href="#h28-0-94" id="h28-0-94" class="i">+            },
</a><a href="#h28-0-95" id="h28-0-95" class="i">+            orders: [
</a><a href="#h28-0-96" id="h28-0-96" class="i">+                (
</a><a href="#h28-0-97" id="h28-0-97" class="i">+                    Field(
</a><a href="#h28-0-98" id="h28-0-98" class="i">+                        2,
</a><a href="#h28-0-99" id="h28-0-99" class="i">+                        None,
</a><a href="#h28-0-100" id="h28-0-100" class="i">+                    ),
</a><a href="#h28-0-101" id="h28-0-101" class="i">+                    Ascending,
</a><a href="#h28-0-102" id="h28-0-102" class="i">+                ),
</a><a href="#h28-0-103" id="h28-0-103" class="i">+            ],
</a><a href="#h28-0-104" id="h28-0-104" class="i">+        },
</a><a href="#h28-0-105" id="h28-0-105" class="i">+        expressions: [
</a><a href="#h28-0-106" id="h28-0-106" class="i">+            (
</a><a href="#h28-0-107" id="h28-0-107" class="i">+                Field(
</a><a href="#h28-0-108" id="h28-0-108" class="i">+                    0,
</a><a href="#h28-0-109" id="h28-0-109" class="i">+                    None,
</a><a href="#h28-0-110" id="h28-0-110" class="i">+                ),
</a><a href="#h28-0-111" id="h28-0-111" class="i">+                None,
</a><a href="#h28-0-112" id="h28-0-112" class="i">+            ),
</a><a href="#h28-0-113" id="h28-0-113" class="i">+            (
</a><a href="#h28-0-114" id="h28-0-114" class="i">+                Field(
</a><a href="#h28-0-115" id="h28-0-115" class="i">+                    1,
</a><a href="#h28-0-116" id="h28-0-116" class="i">+                    None,
</a><a href="#h28-0-117" id="h28-0-117" class="i">+                ),
</a><a href="#h28-0-118" id="h28-0-118" class="i">+                None,
</a><a href="#h28-0-119" id="h28-0-119" class="i">+            ),
</a><a href="#h28-0-120" id="h28-0-120" class="i">+        ],
</a><a href="#h28-0-121" id="h28-0-121" class="i">+    },
</a><a href="#h28-0-122" id="h28-0-122" class="i">+)
</a><a href="#h28-0-123" id="h28-0-123" class="i">+
</a><a href="#h28-0-124" id="h28-0-124" class="i">+Optimized plan: Plan(
</a><a href="#h28-0-125" id="h28-0-125" class="i">+    Projection {
</a><a href="#h28-0-126" id="h28-0-126" class="i">+        source: Order {
</a><a href="#h28-0-127" id="h28-0-127" class="i">+            source: Projection {
</a><a href="#h28-0-128" id="h28-0-128" class="i">+                source: Scan {
</a><a href="#h28-0-129" id="h28-0-129" class="i">+                    table: &quot;movies&quot;,
</a><a href="#h28-0-130" id="h28-0-130" class="i">+                    alias: None,
</a><a href="#h28-0-131" id="h28-0-131" class="i">+                    filter: None,
</a><a href="#h28-0-132" id="h28-0-132" class="i">+                },
</a><a href="#h28-0-133" id="h28-0-133" class="i">+                expressions: [
</a><a href="#h28-0-134" id="h28-0-134" class="i">+                    (
</a><a href="#h28-0-135" id="h28-0-135" class="i">+                        Field(
</a><a href="#h28-0-136" id="h28-0-136" class="i">+                            0,
</a><a href="#h28-0-137" id="h28-0-137" class="i">+                            Some(
</a><a href="#h28-0-138" id="h28-0-138" class="i">+                                (
</a><a href="#h28-0-139" id="h28-0-139" class="i">+                                    None,
</a><a href="#h28-0-140" id="h28-0-140" class="i">+                                    &quot;id&quot;,
</a><a href="#h28-0-141" id="h28-0-141" class="i">+                                ),
</a><a href="#h28-0-142" id="h28-0-142" class="i">+                            ),
</a><a href="#h28-0-143" id="h28-0-143" class="i">+                        ),
</a><a href="#h28-0-144" id="h28-0-144" class="i">+                        None,
</a><a href="#h28-0-145" id="h28-0-145" class="i">+                    ),
</a><a href="#h28-0-146" id="h28-0-146" class="i">+                    (
</a><a href="#h28-0-147" id="h28-0-147" class="i">+                        Field(
</a><a href="#h28-0-148" id="h28-0-148" class="i">+                            1,
</a><a href="#h28-0-149" id="h28-0-149" class="i">+                            Some(
</a><a href="#h28-0-150" id="h28-0-150" class="i">+                                (
</a><a href="#h28-0-151" id="h28-0-151" class="i">+                                    None,
</a><a href="#h28-0-152" id="h28-0-152" class="i">+                                    &quot;title&quot;,
</a><a href="#h28-0-153" id="h28-0-153" class="i">+                                ),
</a><a href="#h28-0-154" id="h28-0-154" class="i">+                            ),
</a><a href="#h28-0-155" id="h28-0-155" class="i">+                        ),
</a><a href="#h28-0-156" id="h28-0-156" class="i">+                        None,
</a><a href="#h28-0-157" id="h28-0-157" class="i">+                    ),
</a><a href="#h28-0-158" id="h28-0-158" class="i">+                    (
</a><a href="#h28-0-159" id="h28-0-159" class="i">+                        Field(
</a><a href="#h28-0-160" id="h28-0-160" class="i">+                            4,
</a><a href="#h28-0-161" id="h28-0-161" class="i">+                            Some(
</a><a href="#h28-0-162" id="h28-0-162" class="i">+                                (
</a><a href="#h28-0-163" id="h28-0-163" class="i">+                                    None,
</a><a href="#h28-0-164" id="h28-0-164" class="i">+                                    &quot;released&quot;,
</a><a href="#h28-0-165" id="h28-0-165" class="i">+                                ),
</a><a href="#h28-0-166" id="h28-0-166" class="i">+                            ),
</a><a href="#h28-0-167" id="h28-0-167" class="i">+                        ),
</a><a href="#h28-0-168" id="h28-0-168" class="i">+                        None,
</a><a href="#h28-0-169" id="h28-0-169" class="i">+                    ),
</a><a href="#h28-0-170" id="h28-0-170" class="i">+                ],
</a><a href="#h28-0-171" id="h28-0-171" class="i">+            },
</a><a href="#h28-0-172" id="h28-0-172" class="i">+            orders: [
</a><a href="#h28-0-173" id="h28-0-173" class="i">+                (
</a><a href="#h28-0-174" id="h28-0-174" class="i">+                    Field(
</a><a href="#h28-0-175" id="h28-0-175" class="i">+                        2,
</a><a href="#h28-0-176" id="h28-0-176" class="i">+                        None,
</a><a href="#h28-0-177" id="h28-0-177" class="i">+                    ),
</a><a href="#h28-0-178" id="h28-0-178" class="i">+                    Ascending,
</a><a href="#h28-0-179" id="h28-0-179" class="i">+                ),
</a><a href="#h28-0-180" id="h28-0-180" class="i">+            ],
</a><a href="#h28-0-181" id="h28-0-181" class="i">+        },
</a><a href="#h28-0-182" id="h28-0-182" class="i">+        expressions: [
</a><a href="#h28-0-183" id="h28-0-183" class="i">+            (
</a><a href="#h28-0-184" id="h28-0-184" class="i">+                Field(
</a><a href="#h28-0-185" id="h28-0-185" class="i">+                    0,
</a><a href="#h28-0-186" id="h28-0-186" class="i">+                    None,
</a><a href="#h28-0-187" id="h28-0-187" class="i">+                ),
</a><a href="#h28-0-188" id="h28-0-188" class="i">+                None,
</a><a href="#h28-0-189" id="h28-0-189" class="i">+            ),
</a><a href="#h28-0-190" id="h28-0-190" class="i">+            (
</a><a href="#h28-0-191" id="h28-0-191" class="i">+                Field(
</a><a href="#h28-0-192" id="h28-0-192" class="i">+                    1,
</a><a href="#h28-0-193" id="h28-0-193" class="i">+                    None,
</a><a href="#h28-0-194" id="h28-0-194" class="i">+                ),
</a><a href="#h28-0-195" id="h28-0-195" class="i">+                None,
</a><a href="#h28-0-196" id="h28-0-196" class="i">+            ),
</a><a href="#h28-0-197" id="h28-0-197" class="i">+        ],
</a><a href="#h28-0-198" id="h28-0-198" class="i">+    },
</a><a href="#h28-0-199" id="h28-0-199" class="i">+)
</a><a href="#h28-0-200" id="h28-0-200" class="i">+
</a><a href="#h28-0-201" id="h28-0-201" class="i">+Query: SELECT id, title FROM movies ORDER BY released
</a><a href="#h28-0-202" id="h28-0-202" class="i">+
</a><a href="#h28-0-203" id="h28-0-203" class="i">+Result: [&quot;id&quot;, &quot;title&quot;]
</a><a href="#h28-0-204" id="h28-0-204" class="i">+[Integer(6), String(&quot;Solaris&quot;)]
</a><a href="#h28-0-205" id="h28-0-205" class="i">+[Integer(1), String(&quot;Stalker&quot;)]
</a><a href="#h28-0-206" id="h28-0-206" class="i">+[Integer(4), String(&quot;Heat&quot;)]
</a><a href="#h28-0-207" id="h28-0-207" class="i">+[Integer(3), String(&quot;Primer&quot;)]
</a><a href="#h28-0-208" id="h28-0-208" class="i">+[Integer(5), String(&quot;The Fountain&quot;)]
</a><a href="#h28-0-209" id="h28-0-209" class="i">+[Integer(10), String(&quot;Inception&quot;)]
</a><a href="#h28-0-210" id="h28-0-210" class="i">+[Integer(7), String(&quot;Gravity&quot;)]
</a><a href="#h28-0-211" id="h28-0-211" class="i">+[Integer(9), String(&quot;Birdman&quot;)]
</a><a href="#h28-0-212" id="h28-0-212" class="i">+[Integer(2), String(&quot;Sicario&quot;)]
</a><a href="#h28-0-213" id="h28-0-213" class="i">+[Integer(8), String(&quot;Blindspotting&quot;)]
</a></pre>
</div>
</body>
</html>
